import{d as b,b as R,Q as $,R as T,k as _,I as B,j as t,m as d,C as x,G as w,r as y,S as F,F as L,T as Y,U as z}from"./index-33f863e7.js";import{E as X}from"./ErrorMsg-fd0eaff2.js";import{X as A,Y as E,R as G,C as j}from"./YAxis-5e5a4ba8.js";import{z as W,M as N,J as K,E as O,t as q}from"./generateCategoricalChart-6b4ba263.js";import{c as H}from"./index-1a433d07.js";import{B as S}from"./Button-2694552d.js";var P=W({chartName:"BarChart",GraphicalChild:N,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:A},{axisType:"yAxis",AxisComp:E}],formatAxisMap:K});function Q(e){const{loggedInUser:n}=b(),{data:r,error:s,isLoading:a,isSuccess:o,isError:c}=R({queryKey:["calenderData",e],queryFn:()=>{const m=e.getMonth()+1,p=e.getFullYear();return B.getCalenderData(m,p)}}),l=!!r&&r.length===0;return{days:U({date:e,data:r,loggedInUser:n}),error:s,isLoading:a,isSuccess:o,isError:c,isEmpty:l}}function U({date:e,data:n,loggedInUser:r}){return J(e).map(s=>V({date:s,data:n,loggedInUser:r}))}function J(e){const n=$(e.getMonth()+1,e.getFullYear()),r=Array.from({length:n-1},(l,h)=>new Date(e.getFullYear(),e.getMonth(),h+1)),s=r[0].getDay(),a=r[r.length-1].getDay(),o=Array.from({length:s},(l,h)=>new Date(e.getFullYear(),e.getMonth(),h-s+1)),c=Array.from({length:6-a},(l,h)=>new Date(e.getFullYear(),e.getMonth()+1,h+1));return[...o,...r,...c]}function V({date:e,data:n,loggedInUser:r}){const s=Z(e);if(!n)return s;const a=n.find(l=>T(new Date(l.date),e));if(!a)return s;const o=_.getTotalCalories(a),c=ee(a,r,o);return{...s,id:a.id,data:a,backgroundColor:c}}function Z(e){return{id:null,data:null,backgroundColor:"",date:e,day:e.getDate(),consumedCalories:0}}function ee(e,n,r){return e&&n?_.getBcgByCosumedCalories({consumedCalories:r,targetCalorie:n.targetCaloricIntakePerDay}):""}const te=({intakes:e})=>{const r=e.sort((s,a)=>{const o=new Date(s.recordedAt).getTime(),c=new Date(a.recordedAt).getTime();return o-c}).map(s=>({name:s.items.reduce((a,o,c,l)=>l.length===1?o.name:c===0?a+`${o.name}, `:c===l.length-1?a+`and ${o.name}`:a+` ${o.name}, `,""),calories:s.items.reduce((a,o)=>a+o.calories,0)}));return t("div",{style:{width:"100%",maxWidth:1200,height:300},children:t(G,{children:d(P,{data:r,children:[t(j,{strokeDasharray:"3 3"}),t(A,{dataKey:"name"}),t(E,{}),t(O,{}),t(N,{dataKey:"calories",barSize:25,children:r.map((s,a)=>t(q,{fill:x[a%x.length]},`cell-${a}`))})]})})})},ae=({day:e})=>{const{data:n}=e;if(!n)return t("p",{children:"No data for this day"});const r=_.getTotalCalories(n);return d("section",{className:"day-info",children:[t("h2",{children:`Consumed Calories: ${r}`}),t("h3",{children:`Weight: ${n.weight}`}),t("h3",{children:`Waist: ${n.waist}`}),t("h3",{children:`Target Caloric Intake: ${n.targetCaloricIntake}`}),d("div",{children:[t("h4",{children:"Workouts:"}),t("ul",{children:n.workouts.map((s,a)=>t("li",{children:`${s.type} - ${s.description}`},a))})]}),d("div",{children:[t("h4",{children:"Intakes:"}),t("ul",{children:n.intakes.map((s,a)=>t("li",{children:`${s.isRecorded?"Recorded":"Not Recorded"} - ${s.items.map(o=>o.name).join(", ")}`},a))})]}),t(te,{intakes:n.intakes})]})};function ne(e){return w({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.13 48 48 141.13 48 256s93.13 208 208 208 208-93.13 208-208S370.87 48 256 48zm62.63 304L296 374.63 177.37 256 296 137.37 318.63 160l-96 96z"}}]})(e)}function re(e){return w({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.13 48 48 141.13 48 256s93.13 208 208 208 208-93.13 208-208S370.87 48 256 48zm-40 326.63L193.37 352l96-96-96-96L216 137.37 334.63 256z"}}]})(e)}const ue=()=>{const[e,n]=y.useState(new Date),[r,s]=y.useState(null),{days:a,isLoading:o,isSuccess:c,isError:l}=Q(e),h=y.useRef(null),m=y.useRef(0);function p(i){s(i)}function D(i){const g=new Date(e);g.setMonth(e.getMonth()+i),n(g)}return y.useEffect(()=>{const i=f=>{const C=f.touches[0];m.current=C.clientX},g=f=>{const C=I=>{const k=new Date(e);k.setMonth(e.getMonth()+I),n(k)},v=f.changedTouches[0].clientX,M=50;v-m.current>M&&C(-1),m.current-v>M&&C(1)},u=h.current;if(u)return u.addEventListener("touchstart",i,!1),u.addEventListener("touchend",g,!1),()=>{u&&(u.removeEventListener("touchstart",i),u.removeEventListener("touchend",g))}},[e,c]),d("main",{className:"page schedule-page",children:[o&&t(F,{}),l&&t(X,{}),c&&d(L,{children:[d(Y,{className:"schedule-page__header",children:[d("h2",{className:"schedule-page__header__title",children:[e.toLocaleString("default",{month:"long"})," ",e.getFullYear()]}),d("div",{className:"schedule-page__header__btns-container",children:[t(S,{onClickFn:()=>D(-1),children:t(ne,{className:"schedule-page__header__btns-container__btn__icon"})}),t(S,{onClickFn:()=>D(1),children:t(re,{className:"schedule-page__header__btns-container__btn__icon"})})]})]}),d("ul",{className:"schedule-grid",ref:h,children:[z.map(i=>t("li",{className:"schedule-grid__item",children:t("h3",{className:"schedule-grid__item__title",children:i.short})},i.short)),a.map(i=>{const{backgroundColor:g,date:u}=i,f=i.backgroundColor?"white":"";return t("li",{className:H("schedule-grid__item",{active:r&&T(i.date,r.date)}),onClick:()=>p(i),style:{backgroundColor:g,color:f},children:t("h3",{className:"schedule-grid__item__title",children:i.day})},u.toISOString())})]}),r&&t(ae,{day:r})]})]})};export{ue as default};
