import{r as P,u as cn,s as ln,c as Ee,g as Fe,h as ee,a as le,b as un,d as at,e as Mt,f as dn,i as fn,k as we,j as o,l as it,n as ft,m,B as L,G as Bt,S as te,o as je,p as $e,q as hn,t as st,F as be,_ as Xe,$ as N,C as ht,v as pn,w as mn,x as vn,y as gn,z as yn,A as bn,D as kn,E as _n}from"./index-6361fabc.js";import{c as me,f as $,_ as Ut,a as Wt,b as wn,d as In,e as se,T as ot,p as Z,L as V,g as ct,h as qt,D as An,i as Pn,j as Sn,k as Cn,G as On,u as Nn,C as xn,S as pt,l as pe,m as ue,A as En,n as Rn,o as mt,q as Dn,r as fe,s as Tn,t as Ln,v as Qt,w as Fn,x as Ce,y as vt,z as Ne,B as jn,E as $n,F as Mn}from"./generateCategoricalChart-1acbe943.js";import{L as Me}from"./List-da389e03.js";import{E as lt}from"./ErrorMsg-756bffa0.js";import{u as Gt,C as Ie}from"./index.esm-df864496.js";import{R as Bn,a as Un,W as Wn}from"./index.esm-3b1dee0e.js";import{D as qn,S as Qn,P as Gn,E as Kn}from"./Empty-84c08648.js";function zn(e){P.useEffect(()=>{const t=document.title;return document.title=e||"Kceli",()=>{document.title=t}},[e])}function Vn({title:e}){const t=cn();zn(e),P.useEffect(()=>{t(ln(!1))},[t])}var Be=(e=>(e.UNIT="unit",e.GRAM="g",e.CUP="cup",e.TABLE_SPOON="tbsp",e.TEA_SPOON="tsp",e.MILLILITER="ml",e))(Be||{});const Hn=Object.values(Be);function Yn(){return{id:Ee(),name:"",items:[Kt()],isRecorded:!0,recordedAt:null,type:"food"}}function Kt(){return{id:Ee(),unit:Be.UNIT,quantity:1,name:""}}function Xn(e){switch(e){case"g":return 100;case"ml":return 100;case"unit":return 1;case"cup":return 1;case"tbsp":return 1;case"tsp":return 1;default:return 1}}function Zn(e){switch(e){case"g":return 25;case"ml":return 25;case"unit":return 1;case"cup":return 1;case"tbsp":return 1;case"tsp":return 1;default:return 1}}const Q={getDefaultIntake:Yn,getDefaultIntakeItem:Kt,getUnitDefaultQuantity:Xn,getQuantityStepPerUnit:Zn,units:Hn};/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Jn=function(t){return t!=null&&t.constructor!=null&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)},zt=tr,er=[];function tr(e,t){var n=0,r;if(!t)return er;if(e.FLAG==="long"){for(r=new Array(Math.ceil(t.length/2));n<t.length;)r[n/2]=t.slice(n,n+2),n+=2;return r}return t.split(e.FLAG==="num"?",":"")}var nr=zt,rr=sr,ar=[].push,Oe="etaoinshrdlcumwfgypbvkjxqz".split(""),_e=/\s+/,ir=["qwertzuop","yxcvbnm","qaw","say","wse","dsx","sy","edr","fdc","dx","rft","gfv","fc","tgz","hgb","gv","zhu","jhn","hb","uji","kjm","jn","iko","lkm"];function sr(e){var t=Object.create(null),n=Object.create(null),r=Object.create(null),a=[],i={in:[],out:[]},s=[],c=e.toString("utf8"),u=[],d=0,l=c.indexOf(`
`),f,v,h,p,y,g,w,I,C,k,_,b,x;for(r.KEY=[];l>-1;)O(c.slice(d,l)),d=l+1,l=c.indexOf(`
`,d);for(O(c.slice(d)),l=-1;++l<u.length;)if(v=u[l],f=v.split(_e),h=f[0],h==="REP"){for(p=l+parseInt(f[1],10);++l<=p;)f=u[l].split(_e),a.push([f[1],f[2]]);l--}else if(h==="ICONV"||h==="OCONV"){for(p=l+parseInt(f[1],10),I=i[h==="ICONV"?"in":"out"];++l<=p;)f=u[l].split(_e),I.push([new RegExp(f[1],"g"),f[2]]);l--}else if(h==="COMPOUNDRULE"){for(p=l+parseInt(f[1],10);++l<=p;)for(k=u[l].split(_e)[1],C=-1,s.push(k);++C<k.length;)n[k.charAt(C)]=[];l--}else if(h==="PFX"||h==="SFX"){for(p=l+parseInt(f[3],10),k={type:h,combineable:f[2]==="Y",entries:[]},t[f[1]]=k;++l<=p;){f=u[l].split(_e),y=f[2],g=f[3].split("/"),w=f[4],I={add:"",remove:"",match:"",continuation:nr(r,g[1])},g&&g[0]!=="0"&&(I.add=g[0]);try{y!=="0"&&(I.remove=h==="SFX"?gt(y):y),w&&w!=="."&&(I.match=h==="SFX"?gt(w):or(w))}catch{I=null}I&&k.entries.push(I)}l--}else if(h==="TRY"){for(w=f[1],b=-1,_=[];++b<w.length;)x=w.charAt(b),x.toLowerCase()===x&&_.push(x);for(b=-1;++b<Oe.length;)w.indexOf(Oe[b])<0&&_.push(Oe[b]);r[h]=_}else h==="KEY"?ar.apply(r[h],f[1].split("|")):h==="COMPOUNDMIN"?r[h]=Number(f[1]):h==="ONLYINCOMPOUND"?(r[h]=f[1],n[f[1]]=[]):r[h]=f[1];return isNaN(r.COMPOUNDMIN)&&(r.COMPOUNDMIN=3),r.KEY.length||(r.KEY=ir),r.TRY||(r.TRY=Oe.concat()),r.KEEPCASE||(r.KEEPCASE=!1),{compoundRuleCodes:n,replacementTable:a,conversion:i,compoundRules:s,rules:t,flags:r};function O(S){S=S.trim(),S&&S.charCodeAt(0)!==35&&u.push(S)}}function gt(e){return new RegExp(e+"$")}function or(e){return new RegExp("^"+e)}var Vt=cr;function cr(e,t){for(var n=-1;++n<t.length;)e=e.replace(t[n][0],t[n][1]);return e}var Ue=lr;function lr(e,t,n){return n&&t in e&&n.indexOf(e[t])>-1}var ur=Ue,dr=fr;function fr(e,t){var n=-1;if(e.data[t])return!ur(e.flags,"ONLYINCOMPOUND",e.data[t]);if(t.length>=e.flags.COMPOUNDMIN){for(;++n<e.compoundRules.length;)if(e.compoundRules[n].test(t))return!0}return!1}var hr=Vt,ze=dr,Ze=Ue,ut=pr;function pr(e,t,n){var r=t.trim(),a;if(!r)return null;if(r=hr(r,e.conversion.in),ze(e,r))return!n&&Ze(e.flags,"FORBIDDENWORD",e.data[r])?null:r;if(r.toUpperCase()===r){if(a=r.charAt(0)+r.slice(1).toLowerCase(),yt(e.flags,e.data[a],n))return null;if(ze(e,a))return a}if(a=r.toLowerCase(),a!==r){if(yt(e.flags,e.data[a],n))return null;if(ze(e,a))return a}return null}function yt(e,t,n){return Ze(e,"KEEPCASE",t)||n||Ze(e,"FORBIDDENWORD",t)}var mr=ut,vr=gr;function gr(e){return!!mr(this,e)}var yr=br;function br(e){var t=bt(e.charAt(0)),n=e.slice(1);return!n||(n=bt(n),t===n)?t:t==="u"&&n==="l"?"s":null}function bt(e){return e===e.toLowerCase()?"l":e===e.toUpperCase()?"u":null}var xe=yr,kt=Vt,kr=Ue,_r=ut,wr=Ar,Ir=[].push;function Ar(e){var t=this,n={},r=[],a={},i,s,c=[],u,d,l,f,v,h,p,y,g,w,I,C,k,_,b,x,O,S,D,U,K,M,W;if(e=kt(e.trim(),t.conversion.in),!e||t.correct(e))return[];for(W=xe(e),d=-1;++d<t.replacementTable.length;)for(s=t.replacementTable[d],l=e.indexOf(s[0]);l>-1;)c.push(e.replace(s[0],s[1])),l=e.indexOf(s[0],l+1);for(d=-1;++d<e.length;)for(y=e.charAt(d),w=e.slice(0,d),I=e.slice(d+1),k=y.toLowerCase(),C=k!==y,n={},l=-1;++l<t.flags.KEY.length;)if(g=t.flags.KEY[l],f=g.indexOf(k),!(f<0)){for(h=-1;++h<g.length;)if(h!==f){if(p=g.charAt(h),n[p])continue;n[p]=!0,C&&(p=p.toUpperCase()),c.push(w+p+I)}}for(d=-1,O=e.charAt(0),u=[""],S=1,D=0;++d<e.length;){for(y=O,O=e.charAt(d+1),w=e.slice(0,d),s=y===O?"":y+y,l=-1,v=u.length;++l<v;)l<=S&&u.push(u[l]+s),u[l]+=y;++D<3&&(S=u.length)}for(Ir.apply(c,u),u=[e],s=e.toLowerCase(),(e===s||W===null)&&u.push(e.charAt(0).toUpperCase()+s.slice(1)),s=e.toUpperCase(),e!==s&&u.push(s),i={state:{},weighted:a,suggestions:r},_=_t(t,i,u,c),b=0,S=Math.min(_.length,Math.pow(Math.max(15-e.length,3),3)),U=Math.max(Math.pow(10-e.length,3),1);!r.length&&b<S;)x=b+U,_t(t,i,_.slice(b,x)),b=x;for(r.sort(Y),u=[],K=[],d=-1;++d<r.length;)M=kt(r[d],t.conversion.out),s=M.toLowerCase(),K.indexOf(s)<0&&(u.push(M),K.push(s));return u;function Y(R,F){return J(R,F)||A(R,F)||E(R,F)}function J(R,F){return a[R]===a[F]?0:a[R]>a[F]?-1:1}function A(R,F){var B=xe(R),re=xe(F);return B===re?0:B===W?-1:re===W?1:void 0}function E(R,F){return R.localeCompare(F)}}function _t(e,t,n,r){var a=e.flags.TRY,i=e.data,s=e.flags,c=[],u=-1,d,l,f,v,h,p,y,g,w,I,C,k,_;if(r)for(;++u<r.length;)b(r[u],!0);for(u=-1;++u<n.length;)for(d=n[u],l="",f="",v=d.charAt(0),h=d,p=d.slice(1),y=v.toLowerCase()!==v,g=xe(d),w=-1;++w<=d.length;)for(l+=f,I=h,h=p,p=h.slice(1),f=v,v=d.charAt(w+1),C=y,v&&(y=v.toLowerCase()!==v),h&&C!==y&&(b(l+x(h)),b(l+x(v)+x(f)+p)),b(l+h),h&&b(l+v+f+p),_=-1;++_<a.length;)k=a[_],C&&k!==k.toUpperCase()?(g!=="s"&&(b(l+k+I),b(l+k+h)),k=k.toUpperCase(),b(l+k+I),b(l+k+h)):(b(l+k+I),b(l+k+h));return c;function b(O,S){var D=t.state[O],U;D!==!!D&&(c.push(O),U=_r(e,O),D=U&&!kr(s,"NOSUGGEST",i[U]),t.state[O]=D,D&&(t.weighted[O]=S?10:0,t.suggestions.push(O))),D&&t.weighted[O]++}function x(O){var S=O.charAt(0);return(S.toLowerCase()===S?S.toUpperCase():S.toLowerCase())+O.slice(1)}}var Pr=ut,wt=Ue,Sr=Cr;function Cr(e){var t=this,n=Pr(t,e,!0);return{correct:t.correct(e),forbidden:!!(n&&wt(t.flags,"FORBIDDENWORD",t.data[n])),warn:!!(n&&wt(t.flags,"WARN",t.data[n]))}}var Or=Ht;function Ht(e,t,n,r){for(var a=-1,i,s,c,u,d;++a<t.entries.length;)if(i=t.entries[a],u=i.continuation,d=-1,(!i.match||i.match.test(e))&&(s=i.remove?e.replace(i.remove,""):e,s=t.type==="SFX"?s+i.add:i.add+s,r.push(s),u&&u.length))for(;++d<u.length;)c=n[u[d]],c&&Ht(s,c,n,r);return r}var It=Or,Yt=Er,Nr=[].push,Je=[];function xr(e,t,n){var r=e[t];t in e?r===Je?e[t]=n.concat():Nr.apply(r,n):e[t]=n.concat()}function Er(e,t,n,r){var a=-1,i,s,c,u,d,l,f;for((!("NEEDAFFIX"in r.flags)||n.indexOf(r.flags.NEEDAFFIX)<0)&&xr(e,t,n);++a<n.length;)if(i=r.rules[n[a]],n[a]in r.compoundRuleCodes&&r.compoundRuleCodes[n[a]].push(t),i){for(l=It(t,i,r.rules,[]),s=-1;++s<l.length;)if(l[s]in e||(e[l[s]]=Je),i.combineable){for(c=a;++c<n.length;)if(d=r.rules[n[c]],d&&d.combineable&&i.type!==d.type)for(f=It(l[s],d,r.rules,[]),u=-1;++u<f.length;)f[u]in e||(e[f[u]]=Je)}}}var Rr=Yt,Dr=Lr,Tr=[];function Lr(e,t){var n=this;return Rr(n.data,e,n.data[t]||Tr,n),n}var Fr=jr;function jr(e){var t=this;return delete t.data[e],t}var $r=Mr;function Mr(){return this.flags.WORDCHARS||null}var Br=zt,Ur=Yt,Wr=qr,At=/\s/g;function qr(e,t,n){for(var r=e.toString("utf8"),a=r.indexOf(`
`)+1,i=r.indexOf(`
`,a);i>-1;)r.charCodeAt(a)!==9&&Pt(r.slice(a,i),t,n),a=i+1,i=r.indexOf(`
`,a);Pt(r.slice(a),t,n)}function Pt(e,t,n){for(var r=e.indexOf("/"),a=e.indexOf("#"),i="",s,c;r>-1&&e.charCodeAt(r-1)===92;)e=e.slice(0,r-1)+e.slice(r),r=e.indexOf("/",r);a>-1?r>-1&&r<a?(s=e.slice(0,r),At.lastIndex=r+1,c=At.exec(e),i=e.slice(r+1,c?c.index:void 0)):s=e.slice(0,a):r>-1?(s=e.slice(0,r),i=e.slice(r+1)):s=e,s=s.trim(),s&&Ur(n,s,Br(t.flags,i.trim()),t)}var Qr=Wr,Gr=Kr;function Kr(e){var t=this,n=-1,r,a,i,s;for(Qr(e,t,t.data);++n<t.compoundRules.length;){for(r=t.compoundRules[n],a="",s=-1;++s<r.length;)i=r.charAt(s),a+=t.compoundRuleCodes[i].length?"(?:"+t.compoundRuleCodes[i].join("|")+")":i;t.compoundRules[n]=new RegExp(a,"i")}return t}var zr=Vr;function Vr(e){var t=this,n=e.toString("utf8").split(`
`),r=-1,a,i,s,c;for(t.flags.FORBIDDENWORD===void 0&&(t.flags.FORBIDDENWORD=!1),c=t.flags.FORBIDDENWORD;++r<n.length;)a=n[r].trim(),a&&(a=a.split("/"),s=a[0],i=s.charAt(0)==="*",i&&(s=s.slice(1)),t.add(s,a[1]),i&&t.data[s].push(c));return t}var St=Jn,Hr=rr,Yr=Re,ne=Re.prototype;ne.correct=vr;ne.suggest=wr;ne.spell=Sr;ne.add=Dr;ne.remove=Fr;ne.wordCharacters=$r;ne.dictionary=Gr;ne.personal=zr;function Re(e,t){var n=-1,r;if(!(this instanceof Re))return new Re(e,t);if(typeof e=="string"||St(e)?(typeof t=="string"||St(t))&&(r=[{dic:t}]):e&&("length"in e?(r=e,e=e[0]&&e[0].aff):(e.dic&&(r=[e]),e=e.aff)),!e)throw new Error("Missing `aff` in dictionary");if(e=Hr(e),this.data=Object.create(null),this.compoundRuleCodes=e.compoundRuleCodes,this.replacementTable=e.replacementTable,this.conversion=e.conversion,this.compoundRules=e.compoundRules,this.rules=e.rules,this.flags=e.flags,r)for(;++n<r.length;)r[n].dic&&this.dictionary(r[n].dic)}const Xr=Fe(Yr);function Zr(e,t){if(!e||!t)return 0;const n=t.weight||e.weight,r=Number((n*33).toFixed(2)),a=t.intakes.filter(i=>i.isRecorded).reduce((i,s)=>s.items.reduce((c,u)=>{if(u.name.toLocaleLowerCase()==="water")switch(u.unit){case"ml":return c+u.quantity;case"cup":return c+u.quantity*250;default:return c}return c},i),0)||0;return Number(((r-a)/1e3).toFixed(2))}const Jr={calcRecommendedWaterIntake:Zr};function ea(e){return{type:e,response:null,status:"idle",error:null}}const Ve={getDefaultNutritionQuery:ea};async function ta(){const e=await ee.get("intake/favorite");return le(e)}async function na(e){const t=await ee.post("intake/favorite",e);return le(t)}async function ra(e){const t=await ee.patch(`intake/favorite/${e.id}`,e);return le(t)}async function aa(e){await ee.delete(`intake/favorite/${e}`)}const We={getUserFavoriteIntakes:ta,addUserFavoriteIntake:na,updateUserFavoriteIntake:ra,removeUserFavoriteIntake:aa};function ia(){const{data:e,error:t,isLoading:n,isSuccess:r,isError:a}=un({queryKey:["favoriteIntakes"],queryFn:We.getUserFavoriteIntakes}),i=!!e&&e.length===0;return{favoriteIntakes:e,error:t,isLoading:n,isSuccess:r,isError:a,isEmpty:i}}var j=(e=>(e.IntakeEdit="IntakeEdit",e.IntakeList="IntakeList",e.UnRecordedIntakeList="UnRecordedIntakeList",e.FavoriteIntake="FavoriteIntake",e.Water="Water",e.WeightWaistInput="WeightWaistInput",e.Workouts="Workouts",e.Query="Query",e))(j||{});const Xt=P.createContext(void 0);function sa({children:e}){const{loggedInUser:t}=at(),{dailyData:n,isLoading:r,isSuccess:a,isError:i}=Mt(),{updateDailyData:s,isLoading:c}=dn(),{favoriteIntakes:u,isLoading:d,isSuccess:l,isError:f,isEmpty:v}=ia(),[h,p]=fn(),[y,g]=P.useState(h.get("tab")||"IntakeEdit"),[w,I]=P.useState(Q.getDefaultIntake()),[C,k]=P.useState(w.items[0].id),[_,b]=P.useState(Ve.getDefaultNutritionQuery("chatGPT")),[x,O]=P.useState(Ve.getDefaultNutritionQuery("ninjaAPI")),[S,D]=P.useState(Ve.getDefaultNutritionQuery("usdaAPI")),U=(n==null?void 0:n.intakes.filter(B=>B.isRecorded))||[],K=(n==null?void 0:n.intakes.filter(B=>!B.isRecorded))||[],M=we.getTotalCalories(n),W=we.calcRemainingCalories(t,n),Y=(n==null?void 0:n.targetCaloricIntake)??(t==null?void 0:t.targetCaloricIntakePerDay)??0,J=we.calcEstimatedBodyFatStatusPerDay(t,n),A=Math.round(M/Y*100),E=Math.round(W/Y*100),R=Jr.calcRecommendedWaterIntake(t,n);P.useEffect(()=>{if(!a||!n||n!=null&&n.weight||n!=null&&n.isWeightWaistIgnored)return;g("WeightWaistInput");const B=new URLSearchParams({tab:"WeightWaistInput"});p(B)},[n,a]);const F={dailyData:n,isLoading:r,isSuccess:a,isError:i,updateDailyData:s,isLoadingUpdate:c,recordedIntakes:U,unrecordedIntakes:K,remainingCalories:W,consumedCalories:M,targetCaloricIntakePerDay:Y,estimatedKGChange:J,openedTab:y,setOpenedTab:g,recommendedWaterIntake:R,intake:w,setIntake:I,calConsumedPct:A,calRemainingPct:E,chatGPTQuery:_,setChatGPTQuery:b,ninjaAPIQuery:x,setNinjaAPIQuery:O,USDAAPIQuery:S,setUSDAAPIQuery:D,currIntakeItemId:C,setCurrIntakeItemId:k,favoriteIntakes:u,isLoadingFavoriteIntakes:d,isSuccessFavoriteIntakes:l,isErrorFavoriteIntakes:f,isEmptyFavoriteIntakes:v,setSearchParams:p};return o(Xt.Provider,{value:F,children:e})}function G(){const e=P.useContext(Xt);if(e===void 0)throw new Error("useDayEdit must be used within a DayEditProvider");return e}const oa="calorie";async function ca(e){const t=await ee.post(`${oa}/item`,e);return le(t)}const la={getCaloriesForItem:ca},Zt=P.createContext(void 0);function ua({intakeItem:e,children:t}){const{intake:n,setIntake:r,currIntakeItemId:a,setCurrIntakeItemId:i}=G(),s=n.items.length===1,c=e.id===a,[u,d]=P.useState(!1),[l,f]=P.useState(""),[v,h]=P.useState(!1),[p,y]=P.useState([]),[g,w]=P.useState(null),I=P.useRef(null),C=p.length>0&&p[0].suggestions.length>0&&!!e.name.length&&!!g;function k(A){A!==a&&i(A)}function _(A){A.preventDefault();const{value:E,name:R}=A.target;switch(R){case"name":if(b({...e,name:E}),E.length||y([]),!I.current)return;I.current(E);break;case"quantity":b({...e,quantity:Number(E)});break;case"calories":{const F={...e,calories:Number(E)};delete F.caloriesPer100g,b(F),f("caloriesPer100g");break}case"caloriesPer100g":{const B=Number(E)*(e.quantity/100);b({...e,caloriesPer100g:Number(E),calories:B}),f("calories");break}}}function b(A){r(E=>({...E,items:E.items.map(R=>R.id===A.id?A:R)}))}function x(){const A=Q.getQuantityStepPerUnit(e.unit);e.quantity-A<1||b({...e,quantity:e.quantity-A})}function O(){const A=Q.getQuantityStepPerUnit(e.unit);b({...e,quantity:e.quantity+A})}function S(){const A=Q.units.indexOf(e.unit),E=A===Q.units.length-1?Q.units[0]:Q.units[A+1],R=Q.getUnitDefaultQuantity(E);b({...e,unit:E,quantity:R})}function D(){const A={...e};u&&(delete A.calories,delete A.caloriesPer100g,f("")),d(E=>!E),b(A)}async function U(){if(!e.name.length)return ft.error("Please enter a food name!");try{h(!0);const A=await la.getCaloriesForItem(e);b({...e,calories:A}),d(!0)}catch(A){console.error(A),ft.error("Failed to calculate calories!")}finally{h(!1)}}function K(A,E){const R=e.name.replace(A,E),F=p.filter(B=>B.original!==A);y(F),b({...e,name:R})}function M(A){const E=p.filter(R=>R.original!==A);y(E)}function W(){const A=Q.getDefaultIntakeItem();r(E=>({...E,items:[...E.items,A]})),i(A.id)}function Y(){var B,re;if(n.items.length===1)return;const A=n.items.findIndex(X=>X.id===e.id),E=(B=n.items[A-1])==null?void 0:B.id,R=(re=n.items[A+1])==null?void 0:re.id,F=[...n.items];F.splice(A,1),r(X=>({...X,items:F})),i(R||E)}P.useEffect(()=>{Promise.all([fetch("/assets/dictionaries/en_US.aff").then(A=>A.text()),fetch("/assets/dictionaries/en_US.dic").then(A=>A.text())]).then(([A,E])=>{const R=new Xr(A,E);w(R)}).catch(A=>{console.error("Failed to load dictionaries:",A)})},[]),P.useEffect(()=>{function A(E){if(!g)return;const R=new Set(["nes","ness"]),re=E.split(" ").filter(X=>!R.has(X)&&X.length>3).map(X=>({original:X,suggestions:g.suggest(X)}));y(re)}I.current=it(A,1e3).debouncedFunc},[g]);const J={intakeItem:e,isOneItem:s,isCurrIntakeItem:c,isManual:u,inputFaded:l,setInputFaded:f,isLoadingCal:v,suggestions:p,setSuggestions:y,isSuggestionListShown:C,handleNameInputClick:k,handleInputChange:_,decreaseQuantity:x,increaseQuantity:O,handleUnitBtnClick:S,handleToggleManual:D,handleCalcBtnClick:U,handleSuggestionClick:K,handleIgnoreSuggestionClick:M,handleAddButtonClick:W,handleRemoveButtonClick:Y};return o(Zt.Provider,{value:J,children:t})}function ke(){const e=P.useContext(Zt);if(!e)throw new Error("useIntakeItemEdit must be used within an IntakeItemEditProvider");return e}const da=()=>{const{suggestions:e,handleSuggestionClick:t,handleIgnoreSuggestionClick:n}=ke();return o("ul",{className:"spelling-suggestion-list","data-testid":"spelling-suggestion-list",children:e.map((r,a)=>m("li",{className:"spelling-suggestion-list__item",children:[r.suggestions.map(i=>o(L,{className:"intake-item-edit__btn spelling-suggestion-list__btn",onClickFn:()=>t(r.original,i),dataTestId:"spelling-suggestion-list-btn",children:o("span",{children:i})},i)),o(L,{className:"intake-item-edit__btn spelling-suggestion-list__btn",dataTestId:"ignore-suggestion-btn",onClickFn:()=>n(r.original),children:o("span",{children:"ignore"})})]},a))})};const fa=()=>{const{intakeItem:e,inputFaded:t,setInputFaded:n,handleInputChange:r}=ke(),a=e.calories?Math.round(e.calories):"";function i(s){t===s&&n("")}return m("div",{className:"intake-item-edit__manuall-calorie-edit","data-testid":"intake-item-edit-manuall-calorie-edit",children:[o("input",{type:"number",name:"calories",className:me("intake-item-input",{faded:t==="calories"}),value:a,placeholder:"Calories",onChange:r,onClick:()=>i("calories")}),o("input",{type:"number",name:"caloriesPer100g",className:me("intake-item-input",{faded:t==="caloriesPer100g"}),value:e.caloriesPer100g||"",placeholder:"Calories per 100g",onChange:r,onClick:()=>i("caloriesPer100g")})]})};function ha(e){return Bt({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h368c4.4 0 8 3.6 8 8v48z"}}]})(e)}function pa(e){return Bt({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H544v152c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V544H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h152V328c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v152h152c4.4 0 8 3.6 8 8v48z"}}]})(e)}const ma=()=>{const{intakeItem:e,isManual:t,isLoadingCal:n,handleInputChange:r,decreaseQuantity:a,increaseQuantity:i,handleUnitBtnClick:s,handleToggleManual:c,handleCalcBtnClick:u}=ke();return m("section",{className:"intake-item-edit__inputs-btns","data-testid":"intake-item-edit-inputs-btns",children:[m("div",{className:"quantity-input-container",children:[o(L,{onClickFn:a,children:o(ha,{})}),o("input",{type:"number",name:"quantity",className:"intake-item-input quantity-input",value:e.quantity,onChange:r}),o(L,{onClickFn:i,children:o(pa,{})})]}),o(L,{onClickFn:s,className:"intake-item-edit__btn",children:o("span",{children:e.unit})}),o(L,{onClickFn:c,className:"intake-item-edit__btn",children:o("span",{children:t?"Manual":"Auto"})}),o(L,{onClickFn:u,className:"intake-item-edit__btn calc-calories-btn",children:n?o(te,{withContainer:!0,containerSize:{width:"100%"}}):o("span",{children:"calc"})})]})},va=()=>{const{isOneItem:e,handleAddButtonClick:t,handleRemoveButtonClick:n}=ke();return m("section",{className:"intake-edit-item__btns-container","data-testid":"intake-item-edit-btns",children:[!e&&o(L,{onClickFn:n,children:"remove item"}),o(L,{onClickFn:t,children:"add item"})]})},ga=()=>{const{intakeItem:e,handleNameInputClick:t,handleInputChange:n}=ke();return o("input",{type:"text",name:"name",className:"intake-item-input",value:e.name,onChange:n,spellCheck:!0,autoComplete:"off",placeholder:"Enter food name",onClick:()=>t(e.id)})},ya=()=>{const{isCurrIntakeItem:e,isManual:t,isSuggestionListShown:n}=ke();return m("section",{className:"intake-item-edit","data-testid":"intake-item-edit",children:[o(ga,{}),n&&o(da,{}),o(ma,{}),t&&o(fa,{}),e&&o(va,{})]})};function Jt(){const e=je(),{mutate:t,isLoading:n}=$e({mutationFn:We.addUserFavoriteIntake,onSuccess:()=>{e.invalidateQueries(["favoriteIntakes"])}});return{addFavoriteIntake:t,isLoading:n}}function en(){const e=je(),{mutate:t,isLoading:n}=$e({mutationFn:r=>We.updateUserFavoriteIntake(r),onSuccess:()=>{e.invalidateQueries(["favoriteIntakes"])}});return{updateFavoriteIntake:t,isLoading:n}}const ba=()=>{const{dailyData:e}=G();if(!e)return null;const t=e.intakes.findLast(r=>r.isRecorded&&r.type==="food");if(!t)return null;const n=hn(t.recordedAt);return m("h5",{className:"last-time-you-ate-title",children:["Last time you ate: ",n]})};const ka=()=>{const{intake:e,consumedCalories:t,remainingCalories:n}=G();if(!e||!e.isRecorded)return null;const r=e.items.reduce((s,c)=>c.calories===void 0?s:s+c.calories,0);if(r<=0)return null;const a=t+r,i=n-r;return m("section",{className:"pre-save-calorie-count",children:[m("p",{children:[o("strong",{children:"Total:"})," ",o("span",{children:r})]}),m("p",{children:[o("strong",{children:"Consumed:"})," ",o("span",{children:a})]}),m("p",{children:[o("strong",{children:"Remaining:"})," ",o("span",{children:i})]})]})};const _a=()=>{const{dailyData:e,isLoading:t,isLoadingUpdate:n,intake:r,updateDailyData:a,setIntake:i}=G(),{addFavoriteIntake:s,isLoading:c}=Jt(),{updateFavoriteIntake:u,isLoading:d}=en(),{backgroundColor:l}=st(),f=t||n||c||d,v=r.recordedAt&&r.isRecorded;function h(_){_.preventDefault();const{value:b}=_.target;i(x=>({...x,name:b}))}function p(){const _=r.type==="food"?"drink":"food";i(b=>({...b,type:_}))}function y(_){_.preventDefault();const{value:b}=_.target,[x,O]=b.split(":"),S=new Date(r.recordedAt);S.setHours(+x),S.setMinutes(+O),i(D=>({...D,recordedAt:S}))}function g(){i(Q.getDefaultIntake())}function w(_){if(_.preventDefault(),!r.items.every(x=>x.name.length&&x.quantity>0))return Xe.error("Please fill all intake items");r.recordedAt=null,r.isRecorded=!1,"userId"in r?u(r):s(r),i(Q.getDefaultIntake())}function I(){i(_=>({..._,recordedAt:_.isRecorded?null:new Date,isRecorded:!_.isRecorded}))}function C(_){if(_.preventDefault(),!e)return;if(!r.items.every(S=>S.name.length&&S.quantity>0))return Xe.error("Please fill all intake items");r.isRecorded&&!r.recordedAt&&(r.recordedAt=new Date);const O=!e.intakes.some(S=>S.id===r.id)?[...e.intakes,r]:e.intakes.map(S=>S.id===r.id?r:S);a({...e,intakes:O}),i(Q.getDefaultIntake())}function k(_){const b=new Date(_),x=b.getTimezoneOffset();return b.setMinutes(b.getMinutes()-x),b.toISOString().slice(11,16)}return m("form",{className:"intake-edit",onSubmit:C,"data-testid":"intake-edit",children:[f&&o(te,{withContainer:!0,containerSize:{height:"75px",width:"100%"}}),!f&&m(be,{children:[m("header",{className:"intake-edit__header","data-testid":"intake-edit-header",children:[m("div",{className:"intake-edit__header__input-name-btn-type",children:[o("input",{type:"text",placeholder:"Name your intake",autoComplete:"off",value:r.name||"",onChange:h,className:"intake-edit__header__name-input","data-testid":"intake-edit-name-input"}),o(L,{onClickFn:p,className:"intake-edit-btn",children:o("span",{children:r.type})})]}),v&&o("input",{className:"intake-edit__header__time-input",type:"time",value:k(r.recordedAt),onChange:y,"data-testid":"intake-edit-time-input"})]}),o(Me,{items:r.items,render:_=>o(ua,{intakeItem:_,children:o(ya,{})},_.id),className:"intake-edit-item-list",dataTestId:"intake-edit-item-list"})]}),m("div",{className:"intake-edit__info-container","data-testid":"intake-edit-info-container",children:[o(ba,{}),o(ka,{})]}),m("div",{className:"intake-edit-btns-container","data-testid":"intake-edit-btns-container",style:{backgroundColor:l},children:[o(L,{onClickFn:g,className:"intake-edit-btn",children:"clear"}),o(L,{onClickFn:w,className:"intake-edit-btn",type:"submit",children:"Save To Fav"}),o(L,{onClickFn:I,className:"intake-edit-btn btn-toggle-save-later "+me({clicked:!r.isRecorded}),children:"Save Later"}),o(L,{onClickFn:_=>C(_),className:"intake-edit-btn",type:"submit",children:"Save Intake"})]})]})};const wa=()=>{const{dailyData:e,setOpenedTab:t,setSearchParams:n}=G();if(!e)return null;function r(i){t(i);const s=new URLSearchParams({tab:i});n(s)}const a=[{name:"add",value:j.IntakeEdit},{name:"intakes",value:j.IntakeList,isShown:e==null?void 0:e.intakes.some(i=>i.isRecorded===!0)},{name:"unrecorded",value:j.UnRecordedIntakeList,isShown:e==null?void 0:e.intakes.some(i=>i.isRecorded===!1)},{name:"favorites",value:j.FavoriteIntake},{name:"water",value:j.Water},{name:"weight",value:j.WeightWaistInput},{name:"workouts",value:j.Workouts},{name:"query",value:j.Query}];return o("ul",{className:"day-edit__filter","data-testid":"day-edit-filter",children:a.map(i=>i.isShown===!1?null:o("li",{className:"filter__item",children:o(L,{className:"btn",onClickFn:()=>r(i.value),children:i.name})},i.value))})};var Ia=["points","className","baseLinePoints","connectNulls"];function he(){return he=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},he.apply(this,arguments)}function Aa(e,t){if(e==null)return{};var n=Pa(e,t),r,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Pa(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,i;for(i=0;i<r.length;i++)a=r[i],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function Ct(e){return Na(e)||Oa(e)||Ca(e)||Sa()}function Sa(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ca(e,t){if(e){if(typeof e=="string")return et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return et(e,t)}}function Oa(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Na(e){if(Array.isArray(e))return et(e)}function et(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ot=function(t){return t&&t.x===+t.x&&t.y===+t.y},xa=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return t.forEach(function(r){Ot(r)?n[n.length-1].push(r):n[n.length-1].length>0&&n.push([])}),Ot(t[0])&&n[n.length-1].push(t[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},Ae=function(t,n){var r=xa(t);n&&(r=[r.reduce(function(i,s){return[].concat(Ct(i),Ct(s))},[])]);var a=r.map(function(i){return i.reduce(function(s,c,u){return"".concat(s).concat(u===0?"M":"L").concat(c.x,",").concat(c.y)},"")}).join("");return r.length===1?"".concat(a,"Z"):a},Ea=function(t,n,r){var a=Ae(t,r);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(Ae(n.reverse(),r).slice(1))},Ra=function(t){var n=t.points,r=t.className,a=t.baseLinePoints,i=t.connectNulls,s=Aa(t,Ia);if(!n||!n.length)return null;var c=me("recharts-polygon",r);if(a&&a.length){var u=s.stroke&&s.stroke!=="none",d=Ea(n,a,i);return N.createElement("g",{className:c},N.createElement("path",he({},$(s,!0),{fill:d.slice(-1)==="Z"?s.fill:"none",stroke:"none",d})),u?N.createElement("path",he({},$(s,!0),{fill:"none",d:Ae(n,i)})):null,u?N.createElement("path",he({},$(s,!0),{fill:"none",d:Ae(a,i)})):null)}var l=Ae(n,i);return N.createElement("path",he({},$(s,!0),{fill:l.slice(-1)==="Z"?s.fill:"none",className:c,d:l}))},Da=Ut,Ta=Wt,La=wn;function Fa(e,t){return e&&e.length?Da(e,Ta(t),La):void 0}var ja=Fa;const $a=Fe(ja);var Ma=Ut,Ba=In,Ua=Wt;function Wa(e,t){return e&&e.length?Ma(e,Ua(t),Ba):void 0}var qa=Wa;const Qa=Fe(qa);var Ga=["cx","cy","angle","ticks","axisLine"],Ka=["ticks","tick","angle","tickFormatter","stroke"];function ve(e){"@babel/helpers - typeof";return ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ve(e)}function Pe(){return Pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pe.apply(this,arguments)}function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Nt(Object(n),!0).forEach(function(r){qe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xt(e,t){if(e==null)return{};var n=za(e,t),r,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function za(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,i;for(i=0;i<r.length;i++)a=r[i],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function Va(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,tn(r.key),r)}}function Ha(e,t,n){return t&&Et(e.prototype,t),n&&Et(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ya(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&tt(e,t)}function tt(e,t){return tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},tt(e,t)}function Xa(e){var t=ei();return function(){var r=De(e),a;if(t){var i=De(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return Za(this,a)}}function Za(e,t){if(t&&(ve(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ja(e)}function Ja(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ei(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function De(e){return De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},De(e)}function qe(e,t,n){return t=tn(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tn(e){var t=ti(e,"string");return ve(t)==="symbol"?t:String(t)}function ti(e,t){if(ve(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ve(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Qe=function(e){Ya(n,e);var t=Xa(n);function n(){return Va(this,n),t.apply(this,arguments)}return Ha(n,[{key:"getTickValueCoord",value:function(a){var i=a.coordinate,s=this.props,c=s.angle,u=s.cx,d=s.cy;return Z(u,d,i,c)}},{key:"getTickTextAnchor",value:function(){var a=this.props.orientation,i;switch(a){case"left":i="end";break;case"right":i="start";break;default:i="middle";break}return i}},{key:"getViewBox",value:function(){var a=this.props,i=a.cx,s=a.cy,c=a.angle,u=a.ticks,d=Qa(u,function(f){return f.coordinate||0}),l=$a(u,function(f){return f.coordinate||0});return{cx:i,cy:s,startAngle:c,endAngle:c,innerRadius:l.coordinate||0,outerRadius:d.coordinate||0}}},{key:"renderAxisLine",value:function(){var a=this.props,i=a.cx,s=a.cy,c=a.angle,u=a.ticks,d=a.axisLine,l=xt(a,Ga),f=u.reduce(function(y,g){return[Math.min(y[0],g.coordinate),Math.max(y[1],g.coordinate)]},[1/0,-1/0]),v=Z(i,s,f[0],c),h=Z(i,s,f[1],c),p=ae(ae(ae({},$(l)),{},{fill:"none"},$(d)),{},{x1:v.x,y1:v.y,x2:h.x,y2:h.y});return N.createElement("line",Pe({className:"recharts-polar-radius-axis-line"},p))}},{key:"renderTicks",value:function(){var a=this,i=this.props,s=i.ticks,c=i.tick,u=i.angle,d=i.tickFormatter,l=i.stroke,f=xt(i,Ka),v=this.getTickTextAnchor(),h=$(f),p=$(c),y=s.map(function(g,w){var I=a.getTickValueCoord(g),C=ae(ae(ae(ae({textAnchor:v,transform:"rotate(".concat(90-u,", ").concat(I.x,", ").concat(I.y,")")},h),{},{stroke:"none",fill:l},p),{},{index:w},I),{},{payload:g});return N.createElement(V,Pe({className:"recharts-polar-radius-axis-tick",key:"tick-".concat(w)},ct(a.props,g,w)),n.renderTickItem(c,C,d?d(g.value,w):g.value))});return N.createElement(V,{className:"recharts-polar-radius-axis-ticks"},y)}},{key:"render",value:function(){var a=this.props,i=a.ticks,s=a.axisLine,c=a.tick;return!i||!i.length?null:N.createElement(V,{className:"recharts-polar-radius-axis"},s&&this.renderAxisLine(),c&&this.renderTicks(),qt.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(a,i,s){var c;return N.isValidElement(a)?c=N.cloneElement(a,i):se(a)?c=a(i):c=N.createElement(ot,Pe({},i,{className:"recharts-polar-radius-axis-tick-value"}),s),c}}]),n}(P.PureComponent);qe(Qe,"displayName","PolarRadiusAxis");qe(Qe,"axisType","radiusAxis");qe(Qe,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function ge(e){"@babel/helpers - typeof";return ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(e)}function oe(){return oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oe.apply(this,arguments)}function Rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Rt(Object(n),!0).forEach(function(r){Ge(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ni(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,nn(r.key),r)}}function ri(e,t,n){return t&&Dt(e.prototype,t),n&&Dt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ai(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nt(e,t)}function nt(e,t){return nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},nt(e,t)}function ii(e){var t=ci();return function(){var r=Te(e),a;if(t){var i=Te(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return si(this,a)}}function si(e,t){if(t&&(ge(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oi(e)}function oi(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ci(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Te(e){return Te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Te(e)}function Ge(e,t,n){return t=nn(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nn(e){var t=li(e,"string");return ge(t)==="symbol"?t:String(t)}function li(e,t){if(ge(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ge(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ui=Math.PI/180,Tt=1e-5,Ke=function(e){ai(n,e);var t=ii(n);function n(){return ni(this,n),t.apply(this,arguments)}return ri(n,[{key:"getTickLineCoord",value:function(a){var i=this.props,s=i.cx,c=i.cy,u=i.radius,d=i.orientation,l=i.tickSize,f=l||8,v=Z(s,c,u,a.coordinate),h=Z(s,c,u+(d==="inner"?-1:1)*f,a.coordinate);return{x1:v.x,y1:v.y,x2:h.x,y2:h.y}}},{key:"getTickTextAnchor",value:function(a){var i=this.props.orientation,s=Math.cos(-a.coordinate*ui),c;return s>Tt?c=i==="outer"?"start":"end":s<-Tt?c=i==="outer"?"end":"start":c="middle",c}},{key:"renderAxisLine",value:function(){var a=this.props,i=a.cx,s=a.cy,c=a.radius,u=a.axisLine,d=a.axisLineType,l=ie(ie({},$(this.props)),{},{fill:"none"},$(u));if(d==="circle")return N.createElement(An,oe({className:"recharts-polar-angle-axis-line"},l,{cx:i,cy:s,r:c}));var f=this.props.ticks,v=f.map(function(h){return Z(i,s,c,h.coordinate)});return N.createElement(Ra,oe({className:"recharts-polar-angle-axis-line"},l,{points:v}))}},{key:"renderTicks",value:function(){var a=this,i=this.props,s=i.ticks,c=i.tick,u=i.tickLine,d=i.tickFormatter,l=i.stroke,f=$(this.props),v=$(c),h=ie(ie({},f),{},{fill:"none"},$(u)),p=s.map(function(y,g){var w=a.getTickLineCoord(y),I=a.getTickTextAnchor(y),C=ie(ie(ie({textAnchor:I},f),{},{stroke:"none",fill:l},v),{},{index:g,payload:y,x:w.x2,y:w.y2});return N.createElement(V,oe({className:"recharts-polar-angle-axis-tick",key:"tick-".concat(g)},ct(a.props,y,g)),u&&N.createElement("line",oe({className:"recharts-polar-angle-axis-tick-line"},h,w)),c&&n.renderTickItem(c,C,d?d(y.value,g):y.value))});return N.createElement(V,{className:"recharts-polar-angle-axis-ticks"},p)}},{key:"render",value:function(){var a=this.props,i=a.ticks,s=a.radius,c=a.axisLine;return s<=0||!i||!i.length?null:N.createElement(V,{className:"recharts-polar-angle-axis"},c&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(a,i,s){var c;return N.isValidElement(a)?c=N.cloneElement(a,i):se(a)?c=a(i):c=N.createElement(ot,oe({},i,{className:"recharts-polar-angle-axis-tick-value"}),s),c}}]),n}(P.PureComponent);Ge(Ke,"displayName","PolarAngleAxis");Ge(Ke,"axisType","angleAxis");Ge(Ke,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var di=Pn,fi=di(Object.getPrototypeOf,Object),hi=fi,pi=Sn,mi=hi,vi=Cn,gi="[object Object]",yi=Function.prototype,bi=Object.prototype,rn=yi.toString,ki=bi.hasOwnProperty,_i=rn.call(Object);function wi(e){if(!vi(e)||pi(e)!=gi)return!1;var t=mi(e);if(t===null)return!0;var n=ki.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&rn.call(n)==_i}var Ii=wi;const Ai=Fe(Ii);function ye(e){"@babel/helpers - typeof";return ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(e)}function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ce.apply(this,arguments)}function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function T(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Lt(Object(n),!0).forEach(function(r){z(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Pi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,an(r.key),r)}}function Si(e,t,n){return t&&Ft(e.prototype,t),n&&Ft(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ci(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rt(e,t)}function rt(e,t){return rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},rt(e,t)}function Oi(e){var t=xi();return function(){var r=Le(e),a;if(t){var i=Le(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return Ni(this,a)}}function Ni(e,t){if(t&&(ye(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return de(e)}function de(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function xi(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Le(e){return Le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Le(e)}function z(e,t,n){return t=an(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function an(e){var t=Ei(e,"string");return ye(t)==="symbol"?t:String(t)}function Ei(e,t){if(ye(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ye(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H=function(e){Ci(n,e);var t=Oi(n);function n(r){var a;return Pi(this,n),a=t.call(this,r),z(de(a),"pieRef",null),z(de(a),"sectorRefs",[]),z(de(a),"id",Nn("recharts-pie-")),z(de(a),"handleAnimationEnd",function(){var i=a.props.onAnimationEnd;a.setState({isAnimationFinished:!0}),se(i)&&i()}),z(de(a),"handleAnimationStart",function(){var i=a.props.onAnimationStart;a.setState({isAnimationFinished:!1}),se(i)&&i()}),a.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},a}return Si(n,[{key:"isActiveIndex",value:function(a){var i=this.props.activeIndex;return Array.isArray(i)?i.indexOf(a)!==-1:a===i}},{key:"hasActiveIndex",value:function(){var a=this.props.activeIndex;return Array.isArray(a)?a.length!==0:a||a===0}},{key:"renderLabels",value:function(a){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var s=this.props,c=s.label,u=s.labelLine,d=s.dataKey,l=s.valueKey,f=$(this.props),v=$(c),h=$(u),p=c&&c.offsetRadius||20,y=a.map(function(g,w){var I=(g.startAngle+g.endAngle)/2,C=Z(g.cx,g.cy,g.outerRadius+p,I),k=T(T(T(T({},f),g),{},{stroke:"none"},v),{},{index:w,textAnchor:n.getTextAnchor(C.x,g.cx)},C),_=T(T(T(T({},f),g),{},{fill:"none",stroke:g.fill},h),{},{index:w,points:[Z(g.cx,g.cy,g.outerRadius,I),C],key:"line"}),b=d;return pe(d)&&pe(l)?b="value":pe(d)&&(b=l),N.createElement(V,{key:"label-".concat(w)},u&&n.renderLabelLineItem(u,_),n.renderLabelItem(c,k,ue(g,b)))});return N.createElement(V,{className:"recharts-pie-labels"},y)}},{key:"renderSectorsStatically",value:function(a){var i=this,s=this.props,c=s.activeShape,u=s.blendStroke,d=s.inactiveShape;return a.map(function(l,f){var v=d&&i.hasActiveIndex()?d:null,h=i.isActiveIndex(f)?c:v,p=T(T({},l),{},{stroke:u?l.fill:l.stroke});return N.createElement(V,ce({ref:function(g){g&&!i.sectorRefs.includes(g)&&i.sectorRefs.push(g)},tabIndex:-1,className:"recharts-pie-sector"},ct(i.props,l,f),{key:"sector-".concat(f)}),n.renderSectorItem(h,p))})}},{key:"renderSectorsWithAnimation",value:function(){var a=this,i=this.props,s=i.sectors,c=i.isAnimationActive,u=i.animationBegin,d=i.animationDuration,l=i.animationEasing,f=i.animationId,v=this.state,h=v.prevSectors,p=v.prevIsAnimationActive;return N.createElement(En,{begin:u,duration:d,isActive:c,easing:l,from:{t:0},to:{t:1},key:"pie-".concat(f,"-").concat(p),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(y){var g=y.t,w=[],I=s&&s[0],C=I.startAngle;return s.forEach(function(k,_){var b=h&&h[_],x=_>0?Rn(k,"paddingAngle",0):0;if(b){var O=mt(b.endAngle-b.startAngle,k.endAngle-k.startAngle),S=T(T({},k),{},{startAngle:C+x,endAngle:C+O(g)+x});w.push(S),C=S.endAngle}else{var D=k.endAngle,U=k.startAngle,K=mt(0,D-U),M=K(g),W=T(T({},k),{},{startAngle:C+x,endAngle:C+M+x});w.push(W),C=W.endAngle}}),N.createElement(V,null,a.renderSectorsStatically(w))})}},{key:"attachKeyboardHandlers",value:function(a){var i=this;a.onkeydown=function(s){if(!s.altKey)switch(s.key){case"ArrowLeft":{var c=++i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[c].focus(),i.setState({sectorToFocus:c});break}case"ArrowRight":{var u=--i.state.sectorToFocus<0?i.sectorRefs.length-1:i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[u].focus(),i.setState({sectorToFocus:u});break}case"Escape":{i.sectorRefs[i.state.sectorToFocus].blur(),i.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var a=this.props,i=a.sectors,s=a.isAnimationActive,c=this.state.prevSectors;return s&&i&&i.length&&(!c||!Dn(c,i))?this.renderSectorsWithAnimation():this.renderSectorsStatically(i)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var a=this,i=this.props,s=i.hide,c=i.sectors,u=i.className,d=i.label,l=i.cx,f=i.cy,v=i.innerRadius,h=i.outerRadius,p=i.isAnimationActive,y=this.state.isAnimationFinished;if(s||!c||!c.length||!fe(l)||!fe(f)||!fe(v)||!fe(h))return null;var g=me("recharts-pie",u);return N.createElement(V,{tabIndex:this.props.rootTabIndex,className:g,ref:function(I){a.pieRef=I}},this.renderSectors(),d&&this.renderLabels(c),qt.renderCallByParent(this.props,null,!1),(!p||y)&&Tn.renderCallByParent(this.props,c,!1))}}],[{key:"getDerivedStateFromProps",value:function(a,i){return i.prevIsAnimationActive!==a.isAnimationActive?{prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:[],isAnimationFinished:!0}:a.isAnimationActive&&a.animationId!==i.prevAnimationId?{prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:i.curSectors,isAnimationFinished:!0}:a.sectors!==i.curSectors?{curSectors:a.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(a,i){return a>i?"start":a<i?"end":"middle"}},{key:"renderLabelLineItem",value:function(a,i){return N.isValidElement(a)?N.cloneElement(a,i):se(a)?a(i):N.createElement(xn,ce({},i,{type:"linear",className:"recharts-pie-label-line"}))}},{key:"renderLabelItem",value:function(a,i,s){if(N.isValidElement(a))return N.cloneElement(a,i);var c=s;return se(a)&&(c=a(i),N.isValidElement(c))?c:N.createElement(ot,ce({},i,{alignmentBaseline:"middle",className:"recharts-pie-label-text"}),c)}},{key:"renderSectorItem",value:function(a,i){return N.isValidElement(a)?N.cloneElement(a,i):se(a)?a(i):Ai(a)?N.createElement(pt,ce({tabIndex:-1},i,a)):N.createElement(pt,ce({tabIndex:-1},i))}}]),n}(P.PureComponent);z(H,"displayName","Pie");z(H,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!On.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});z(H,"parseDeltaAngle",function(e,t){var n=Ne(t-e),r=Math.min(Math.abs(t-e),360);return n*r});z(H,"getRealPieData",function(e){var t=e.props,n=t.data,r=t.children,a=$(e.props),i=Ln(r,Qt);return n&&n.length?n.map(function(s,c){return T(T(T({payload:s},a),s),i&&i[c]&&i[c].props)}):i&&i.length?i.map(function(s){return T(T({},a),s.props)}):[]});z(H,"parseCoordinateOfPie",function(e,t){var n=t.top,r=t.left,a=t.width,i=t.height,s=Fn(a,i),c=r+Ce(e.props.cx,a,a/2),u=n+Ce(e.props.cy,i,i/2),d=Ce(e.props.innerRadius,s,0),l=Ce(e.props.outerRadius,s,s*.8),f=e.props.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:c,cy:u,innerRadius:d,outerRadius:l,maxRadius:f}});z(H,"getComposedData",function(e){var t=e.item,n=e.offset,r=H.getRealPieData(t);if(!r||!r.length)return null;var a=t.props,i=a.cornerRadius,s=a.startAngle,c=a.endAngle,u=a.paddingAngle,d=a.dataKey,l=a.nameKey,f=a.valueKey,v=a.tooltipType,h=Math.abs(t.props.minAngle),p=H.parseCoordinateOfPie(t,n),y=H.parseDeltaAngle(s,c),g=Math.abs(y),w=d;pe(d)&&pe(f)?(vt(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),w="value"):pe(d)&&(vt(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),w=f);var I=r.filter(function(O){return ue(O,w,0)!==0}).length,C=(g>=360?I:I-1)*u,k=g-I*h-C,_=r.reduce(function(O,S){var D=ue(S,w,0);return O+(fe(D)?D:0)},0),b;if(_>0){var x;b=r.map(function(O,S){var D=ue(O,w,0),U=ue(O,l,S),K=(fe(D)?D:0)/_,M;S?M=x.endAngle+Ne(y)*u*(D!==0?1:0):M=s;var W=M+Ne(y)*((D!==0?h:0)+K*k),Y=(M+W)/2,J=(p.innerRadius+p.outerRadius)/2,A=[{name:U,value:D,payload:O,dataKey:w,type:v}],E=Z(p.cx,p.cy,J,Y);return x=T(T(T({percent:K,cornerRadius:i,name:U,tooltipPayload:A,midAngle:Y,middleRadius:J,tooltipPosition:E},O),p),{},{value:ue(O,w),startAngle:M,endAngle:W,payload:O,paddingAngle:Ne(y)*u}),x})}return T(T({},p),{},{sectors:b,data:r})});var Ri=jn({chartName:"PieChart",GraphicalChild:H,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:Ke},{axisType:"radiusAxis",AxisComp:Qe}],formatAxisMap:$n,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const Di=({intakes:e,remainingCalories:t})=>{const n=[...e.map(r=>({name:r.items.reduce((a,i,s,c)=>c.length===1?i.name:s===0?a+`${i.name}, `:s===c.length-1?a+`and ${i.name}`:a+` ${i.name}, `,""),value:r.items.reduce((a,i)=>a+i.calories,0)})),{name:"remaining",value:t}];return t<=0&&n.pop(),m(Ri,{width:250,height:250,children:[o(H,{dataKey:"value",isAnimationActive:!1,data:n,cx:125,cy:125,innerRadius:80,outerRadius:110,children:n.map((r,a)=>{const i=r.name==="remaining"?"#a7a7a7":ht[a%ht.length];return o(Qt,{fill:i},`cell-${a}`)})}),o(Mn,{})]})},Ti=()=>{const{dailyData:e,recordedIntakes:t,calConsumedPct:n,calRemainingPct:r,remainingCalories:a,consumedCalories:i,estimatedKGChange:s}=G();if(!e)return null;const{date:c}=e,u=new Intl.DateTimeFormat("en-GB",{weekday:"long",month:"numeric",day:"numeric",year:"numeric"}).format(new Date(c)),d=a>0?"remaining":"over your limit";return m("header",{className:"day-edit__header","data-testid":"day-edit-header",children:[o("div",{className:"day-edit__header__date-container",children:o("h2",{className:"day-edit__header__date","data-testid":"day-edit-header-date",children:u})}),o(Di,{intakes:t,remainingCalories:a}),m("div",{className:"day-edit__header__titles",children:[m("p",{className:"day-edit__header__titles__title","data-testid":"day-edit-header-remaining-calories",children:[m("strong",{children:[Math.abs(a)," "]}),"calories ",d]}),o("hr",{}),i>0&&m(be,{children:[m("p",{className:"day-edit__header__titles__title","data-testid":"day-edit-header-consumed-calories",children:[o("strong",{children:Math.round(i)})," calories consumed"]}),o("hr",{})]}),m("div",{className:"day-edit__header__percentages-container",children:[m("div",{className:"day-edit__header__percentage","data-testid":"day-edit-header-consumed-percentage",children:[o("p",{className:"day-edit__header__percentage__title",children:"consumed:"}),m("p",{className:"day-edit__header__percentage__value",children:[n,"%"]})]}),m("div",{className:"day-edit__header__percentage","data-testid":"day-edit-header-remaining-percentage",children:[o("p",{className:"day-edit__header__percentage__title",children:"remaining:"}),m("p",{className:"day-edit__header__percentage__value",children:[r,"%"]})]})]}),o("hr",{}),m("p",{className:"day-edit__header__titles__title","data-testid":"day-edit-header-estimated-kg-change",children:["estimated to ",s>0?"gain":"lose",m("strong",{children:[" ",Math.abs(s)]})," kg"]}),o("hr",{})]})]})};const Li=({mode:e,zIndex:t})=>o("div",{className:`main-screen ${e||""}`,style:{zIndex:t},"data-testid":"main-screen"});function Fi(e,t=!0){const n=P.useRef(null);return P.useEffect(()=>{function r(a){n.current&&!n.current.contains(a.target)&&e()}return document.addEventListener("click",r,t),()=>document.removeEventListener("click",r,t)},[e,t]),{outsideClickRef:n}}const ji=({isModalAbove:e,isFullScreen:t=!1})=>{const n="tippy"+(e?" down":" up")+(t?" full-screen":"");return o("div",{className:n,"data-testid":"tippy"})};function sn(e,t){var c;const n=(c=e.current)==null?void 0:c.getBoundingClientRect();if(!n)return;const a=window.innerHeight-n.top<t,i={top:n.bottom+n.height/2+window.scrollY},s={bottom:window.innerHeight-n.top+n.height/2};return{isModalAbove:a,position:{...a?s:i,left:n.left+n.width/2+window.scrollX},rect:n}}const Se=P.createContext(void 0),q=({children:e,externalStateControl:t,onClose:n,onOpen:r,onAfterClose:a})=>{const[i,s]=P.useState(""),[c,u]=P.useState(null),[d,l]=P.useState(null),[f,v]=P.useState(!1),h=()=>{if(n==null||n(),t){t.setOpenedModalName(""),a==null||a();return}s(""),a==null||a()},p=I=>{if(r==null||r(),t){t.setOpenedModalName(I);return}s(I)},{debouncedFunc:y,cancel:g}=it(()=>{h()},500),w={openedModalName:(t==null?void 0:t.openedModalName)||i,close:h,open:p,position:c,setPosition:u,isModalAbove:f,setIsModalAbove:v,modalHoverGuardZone:d,setModalHoverGuardZone:l,debouncedClose:y,cancelDebouncedClose:g};return o(Se.Provider,{value:w,children:e})},$i=({children:e,modalName:t,setPositionByRef:n=!1,modalHeight:r=0,externalControlFunc:a})=>{const{open:i,setPosition:s,setIsModalAbove:c}=P.useContext(Se),u=P.useRef(null),d=P.useCallback(()=>{const f=sn(u,r),{isModalAbove:v,position:h}=f;c(v),s(h)},[r,c,s]),l=()=>{if(n&&d(),a)return a();i(t)};return P.useEffect(()=>{if(!n)return;const f=["wheel","scroll","resize"];return f.forEach(v=>{window.addEventListener(v,d)}),()=>{f.forEach(v=>{window.removeEventListener(v,d)})}},[n,d]),P.cloneElement(e,{onClick:l,ref:u})},Mi=({children:e,onClickFn:t})=>{const{close:n}=P.useContext(Se);return P.cloneElement(e,{onClick:()=>{t==null||t(),n()}})},Bi=({children:e,modalName:t,modalHeight:n=0})=>{const{open:r,setPosition:a,setIsModalAbove:i,setModalHoverGuardZone:s,debouncedClose:c,cancelDebouncedClose:u}=P.useContext(Se),d=P.useRef(null),{debouncedFunc:l,cancel:f}=it(v,500);function v(){const y=sn(d,n);y&&(a(y.position),i(y.isModalAbove),s({height:y.rect.height,width:y.rect.width}),r(t))}function h(){u(),l()}function p(){f(),c()}return o("div",{className:"modal-hover-open",ref:d,onMouseEnter:h,onMouseLeave:p,children:e})},Ui=({children:e,name:t,className:n,mainScreenMode:r="transparent",mainScreenZIndex:a=1e3,elementId:i="app",includeTippy:s=!1,style:c={},hoverControl:u=!1})=>{const{openedModalName:d,open:l,close:f,position:v,isModalAbove:h,modalHoverGuardZone:p,debouncedClose:y,cancelDebouncedClose:g}=P.useContext(Se),{outsideClickRef:w}=Fi(f);function I(){g(),l(t)}function C(){y()}return t!==d?null:pn.createPortal(m(be,{children:[!u&&o(Li,{mode:r,zIndex:a}),m("section",{className:`modal ${n||t}`,style:{...c,zIndex:a+1,...v},ref:u?void 0:w,onMouseEnter:()=>u&&I(),onMouseLeave:()=>u&&C(),"data-testid":"modal-window",children:[s&&o(ji,{isModalAbove:!!h}),e,u&&p&&o("div",{className:"modal-hover-guard-zone",style:{top:h?"100%":`-${p.height/2}px`,height:`${p.height/2}px`||"10%",width:`${p.width}px`||"10%"}})]})]}),document.getElementById(i))};q.OpenBtn=$i;q.Window=Ui;q.CloseBtn=Mi;q.ModalHoverOpen=Bi;function Wi(){const e=je(),{mutate:t,isLoading:n}=$e({mutationFn:async r=>We.removeUserFavoriteIntake(r),onSuccess:()=>{e.invalidateQueries(["favoriteIntakes"])}});return{removeFavoriteIntake:t,isLoading:n}}const on=({intake:e})=>{const{dailyData:t,openedTab:n,setOpenedTab:r,setIntake:a,updateDailyData:i,setCurrIntakeItemId:s}=G(),{addFavoriteIntake:c,isLoading:u}=Jt(),{removeFavoriteIntake:d}=Wi(),l=n===j.IntakeList,f=n===j.FavoriteIntake,v=!l||f,h=we.getTotalCalories(e),p=f?e.name||e.items.map(k=>k.name).join(", "):null;function y(k){if(f)return d(k);if(!t)return;const _={...t};_.intakes=t.intakes.filter(b=>b.id!==k),i(_)}function g(k){if(!t)return;const _={...k};a(_),r(j.IntakeEdit),s(k.items[0].id)}function w(k){if(!t)return;const _={...k};_.id=Ee(),_.recordedAt=new Date,i({...t,intakes:[...t.intakes,_]})}function I(k){if(!t)return;const _={...t};f?_.intakes=[...t.intakes,{...e,id:Ee(),isRecorded:!0,recordedAt:new Date}]:_.intakes=t.intakes.map(b=>(b.id!==k||(b.isRecorded=!0,b.recordedAt=new Date),b)),i(_)}function C(k){c(k)}return u?o(te,{withContainer:!0,containerSize:{height:"50px"}}):m("section",{className:"intake-preview","data-testid":"intake-preview",children:[p&&o("h2",{className:"intake-preview__title","data-testid":"intake-title",children:p}),o(Me,{items:e.items,className:"intake-preview__item-list",render:k=>o("li",{className:"intake-preview__item-list__item","data-testid":"intake-preview-item",children:`${k.name} - ${k.quantity} ${k.unit} - calories: ${Math.round(k.calories)}`},k.id)}),m("p",{className:"intake-preview__total-calories",children:["total calories: ",h]}),m("div",{id:"intake-preview-btns-container",className:"intake-preview__btns-container",children:[m(q,{children:[o(q.OpenBtn,{modalName:"delete-intake",children:o("button",{className:"btn",children:"Delete"})}),m(q.Window,{name:"delete-intake",elementId:"intake-preview-btns-container",className:"delete-intake-modal",children:[o("h2",{children:"Are you sure you want to delete this intake?"}),o(q.CloseBtn,{onClickFn:()=>y(e.id),children:o("button",{className:"btn delete-btn",children:"Delete"})}),o(q.CloseBtn,{children:o("button",{className:"btn",children:"Cancel"})})]})]}),(f||l)&&o(L,{className:"btn",onClickFn:()=>g(e),children:"Edit"}),l&&o(L,{className:"btn",onClickFn:()=>w(e),children:"duplicate"}),v&&o(L,{className:"btn",onClickFn:()=>I(e.id),children:"Save"}),!f&&o(L,{className:"btn",onClickFn:()=>C(e),children:"add to fav"})]})]})};const qi=()=>{const{dailyData:e,unrecordedIntakes:t,recordedIntakes:n,openedTab:r,isLoadingUpdate:a}=G();if(!e)return null;const i=r===j.IntakeList,c=(i?n:t).sort((d,l)=>!d.recordedAt||!l.recordedAt?0:new Date(d.recordedAt).getTime()-new Date(l.recordedAt).getTime()),u=we.getTotalCaloriesFromDailyData({dailyData:e,isRecorded:i});return m(be,{children:[m("header",{className:"intake-list__header","data-testid":"intake-list-header",children:[m("h3",{className:"intake-list__header__title",children:[i?"Recorded":"Unrecorded"," Intakes"]}),m("h4",{className:"intake-list__header__total-calories",children:["total calories: ",u]})]}),a&&o(te,{}),!a&&o(Me,{className:"intake-list",items:c,render:(d,l)=>{const f=d.recordedAt?`- ${mn(d.recordedAt)}`:"";return m("li",{className:"intake-list-item",children:[m("h5",{className:"intake-list-item__title",children:["Intake ",l+1,"# ",f]}),o(on,{intake:d})]},d.id)}})]})};const Qi=()=>{const{dailyData:e,isLoading:t,updateDailyData:n,setOpenedTab:r}=G(),{loggedInUser:a}=at(),{userDailyStats:i}=vn(),{control:s,handleSubmit:c}=Gt({defaultValues:{weight:"",waist:""}}),[u,d]=P.useState(!1);function l(){e&&(n({...e,isWeightWaistIgnored:!0}),r(j.IntakeEdit))}function f(h){if(!e||!a)return;const{weightGoal:p}=a.weightLossGoal;if(Number(h.weight)<=p)return alert("Weight can't be greater than your goal");n({...e,weight:Number(h.weight),waist:Number(h.waist)})}if(P.useEffect(()=>{!a||!i||d(gn.isReachedGoalWeight({loggedInUser:a,userDailyStats:i}))},[a,i]),!e)return null;const v=!e.weight&&!e.waist&&!t;return t?o(te,{withContainer:!0,containerSize:{height:"75px"}}):v?m("form",{className:"weight-waist-form","data-testid":"weight-waist-form",onSubmit:c(f),children:[o(Ie,{control:s,name:"weight",render:({field:h})=>o("input",{...h,type:"number",className:"weight-waist-form__input",placeholder:"Enter your weight",required:!0})}),o(Ie,{control:s,name:"waist",render:({field:h})=>o("input",{...h,type:"number",className:"weight-waist-form__input",placeholder:"Enter your waist size",required:!0})}),m("div",{className:"weight-waist-form__btns-container",children:[o(L,{className:"btn",type:"submit",children:"update"}),!e.isWeightWaistIgnored&&o(L,{className:"btn",onClickFn:l,children:"dissmis"})]})]}):m(be,{children:[m("div",{className:"weight-waist-details","data-testid":"weight-waist-details",children:[o("p",{className:"weight-waist-details__title",children:"weight:"}),m("p",{className:"weight-waist-details__text",children:[e.weight," kg"]}),o("p",{className:"weight-waist-details__title",children:"waist:"}),m("p",{className:"weight-waist-details__text",children:[e.waist," cm"]})]}),u&&o(yn,{})]})},dt="nutrition";async function Gi(e){const t=await ee.get(`${dt}/chatGPT?prompt=${e}`);return le(t)}async function Ki(e){const t=await ee.get(`${dt}/ninja?query=${e}`);return le(t)}async function zi(e){const t=await ee.get(`${dt}/usda?query=${e}`);return le(t)}const He={queryChatGPT:Gi,queryNinja:Ki,queryUSDA:zi};const Vi=()=>o("div",{className:"dot-loader","data-testid":"dot-loader"}),Ye=({queryState:{type:e,status:t,error:n,response:r}})=>t==="loading"?o(Vi,{}):t==="error"&&n?o(lt,{msg:n}):t==="success"?m("section",{"data-testid":"nutrition-query-response-handler",children:[e==="chatGPT"&&o("p",{children:r}),e==="ninjaAPI"&&o("ul",{className:"nutrition-query__results__item__list","data-testid":"nutrition-query-response-ninja-api-response",children:r.map((a,i)=>o("li",{children:Object.entries(a).map(([s,c])=>s==="name"?o("strong",{children:a.name},s):m("div",{children:[m("span",{children:[s,":"]}),o("span",{children:c})]},s))},i))}),e==="usdaAPI"&&o("ul",{className:"nutrition-query__results__item__list","data-testid":"nutrition-query-response-usda-api-response",children:r.map((a,i)=>{const s=Object.entries(a);return o("li",{children:s.map(([c,u])=>c==="description"?o("strong",{children:a.description},c):m("div",{children:[m("span",{children:[c,":"]}),o("span",{children:u})]},c))},i)})})]}):null;const Hi=()=>{const{chatGPTQuery:e,setChatGPTQuery:t,ninjaAPIQuery:n,setNinjaAPIQuery:r,USDAAPIQuery:a,setUSDAAPIQuery:i}=G(),{control:s,handleSubmit:c}=Gt({defaultValues:{chatGPTQuery:"",ninjaAPIQuery:"",USDAAPIQuery:""}});async function u(d){if(d.chatGPTQuery)try{t({...e,status:"loading"});const l=await He.queryChatGPT(d.chatGPTQuery);t({...e,status:"success",response:l})}catch(l){t({...e,status:"error",error:l instanceof Error?l.message:"An unknown error occurred."})}if(d.ninjaAPIQuery)try{r({...n,status:"loading"});const l=await He.queryNinja(d.ninjaAPIQuery);r({...n,status:"success",response:l})}catch(l){r({...n,status:"error",error:l instanceof Error?l.message:"An unknown error occurred."})}if(d.USDAAPIQuery)try{i({...a,status:"loading"});const l=await He.queryUSDA(d.USDAAPIQuery);i({...a,status:"success",response:l})}catch(l){i({...a,status:"error",error:l instanceof Error?l.message:"An unknown error occurred."})}}return m("section",{className:"nutrition-query","data-testid":"nutrition-query",children:[m("section",{className:"nutrition-query__desc",children:[o("p",{children:"This tab let's you query the APIs used by the app."}),m("ul",{children:[o("li",{children:"The first one is a chatbot that generates a response based on the input"}),o("li",{children:"The second one is a food database."}),o("li",{children:"The third one is a nutrition database."})]})]}),m("form",{className:"nutrition-query__form",autoComplete:"off","data-testid":"nutrition-query-form",children:[m("label",{htmlFor:"chatGPTQuery",children:[o("span",{children:"Chat GPT"}),o(Bn,{})]}),o(Ie,{name:"chatGPTQuery",control:s,render:({field:d})=>o("textarea",{id:"chatGPTQuery",...d})}),m("label",{htmlFor:"ninjaAPIQuery",children:[o("span",{children:"Ninja API"}),o(bn,{})]}),o(Ie,{name:"ninjaAPIQuery",control:s,render:({field:d})=>o("input",{id:"ninjaAPIQuery",...d})}),m("label",{htmlFor:"USDAAPIQuery",children:[o("span",{children:"USDA API"}),o(Un,{})]}),o(Ie,{name:"USDAAPIQuery",control:s,render:({field:d})=>o("input",{id:"USDAAPIQuery",...d})}),o(L,{onClickFn:c(u),children:"query"})]}),m("div",{className:"nutrition-query__results",children:[e.status!=="idle"&&m("div",{className:"nutrition-query__results__item",children:[o("h1",{children:"Chat GPT Response:"}),o(Ye,{queryState:e})]}),n.status!=="idle"&&m("div",{className:"nutrition-query__results__item",children:[o("h1",{children:"Ninja API Response:"}),o(Ye,{queryState:n})]}),a.status!=="idle"&&m("div",{className:"nutrition-query__results__item",children:[o("h1",{children:"USDA API Response:"}),o(Ye,{queryState:a})]})]})]})};const jt=[{name:"cup (250ml)",value:250},{name:"bottle (750ml)",value:750},{name:"1.5 Liter",value:1500}],Yi=()=>{const{dailyData:e,updateDailyData:t,recommendedWaterIntake:n}=G(),[r,a]=P.useState("");function i(c){a(c.name)}function s(){if(!e)return;const c=jt.find(l=>l.name===r);if(!c)return Xe.error("Please select a value");const u=Q.getDefaultIntake();u.type="drink",u.items[0].quantity=c.value,u.items[0].unit=Be.MILLILITER,u.items[0].name="water";const d=[...e.intakes,u];t({...e,intakes:d})}return m("section",{className:"water-edit","data-testid":"water-edit",children:[o("h2",{className:"water-edit__title",children:`Recommended water intake: ${n} ml`}),o("div",{className:"water-edit__btns-values-container",children:jt.map(c=>o(L,{className:me("btn",{"btn-selected":r===c.name}),onClickFn:()=>i(c),children:c.name},c.value))}),o(L,{className:"water-edit__btn-save",onClickFn:s,children:"Save"})]})};const Xi=()=>{const{favoriteIntakes:e,isErrorFavoriteIntakes:t,isLoadingFavoriteIntakes:n,isSuccessFavoriteIntakes:r,isEmptyFavoriteIntakes:a}=G(),{updateFavoriteIntake:i}=en(),[s,c]=P.useState($t(e));function u(f,v){return{background:f?"var(--color-warning)":"",transform:f?"rotate(7deg)":"",...v}}function d(f){if(!f.destination||!s)return;const h=((y,g,w)=>{const I=Array.from(y),[C]=I.splice(g,1);return I.splice(w,0,C),I})(s,f.source.index,f.destination.index);c(h);const p={...h[f.destination.index]};p.sortOrder=f.destination.index,i(p)}function l(f){const{value:v}=f.target;if(!e)return c($t(e));const h=e==null?void 0:e.filter(p=>p.name.toLowerCase().includes(v.toLowerCase())||p.items.some(y=>y.name.toLowerCase().includes(v.toLowerCase())));c(h)}return m("section",{className:"day-edit__favorite-intakes","data-testid":"day-edit-favorite-intakes",children:[o("input",{type:"text",className:"day-edit__favorite-intakes__input",autoComplete:"off",placeholder:"Search...",onChange:l}),n&&o(te,{}),r&&!a&&o(qn,{onDragEnd:d,children:o(Qn,{droppableId:"droppable",children:f=>m("ul",{className:"list day-edit__favorite-intakes__list",...f.droppableProps,ref:f.innerRef,children:[s.map((v,h)=>o(Gn,{draggableId:v.id,index:h,children:(p,y)=>o("li",{ref:p.innerRef,...p.draggableProps,...p.dragHandleProps,style:u(y.isDragging,p.draggableProps.style),className:"day-edit__favorite-intakes__list__item",children:o(on,{intake:v})})},v.id)),f.placeholder]})})}),r&&a&&o(Kn,{entityName:"favorite intake"}),t&&o(lt,{msg:"Couldn't get favorite intake. Please try again later."})]})};function $t(e){return e?e==null?void 0:e.sort((t,n)=>t.sortOrder-n.sortOrder):[]}const Zi=()=>{const{dailyData:e,isLoading:t,isSuccess:n,isError:r,isLoadingUpdate:a,openedTab:i}=G(),{backgroundColor:s}=st(),c=n&&e&&!a&&!t,u=t||a,d=i===j.IntakeList||i===j.UnRecordedIntakeList;return m("section",{className:"day-edit",style:{backgroundColor:s,border:`5px solid ${s}`},"data-testid":"day-edit",children:[u&&o(te,{}),r&&o(lt,{}),c&&m(be,{children:[o(Ti,{}),o(wa,{}),i===j.WeightWaistInput&&o(Qi,{}),i===j.IntakeEdit&&o(_a,{}),i===j.Workouts&&o(Me,{className:"day-edit__workouts-list",items:e.workouts,render:l=>o(Wn,{workout:l,isDayEdit:!0},l.id)}),i===j.FavoriteIntake&&o(Xi,{}),d&&o(qi,{}),i===j.Query&&o(Hi,{}),i===j.Water&&o(Yi,{})]})]})};const Ji=()=>{const e=kn();return m("div",{className:"login-signup-msg","data-testid":"login-signup-msg",children:[o("div",{className:"login-signup-msg-text-container",children:o("h1",{children:"Start Your Journey Now!"})}),o("div",{className:"login-signup-msg-btn-container",children:[{title:"Log in",className:"btn-login",path:"/login"},{title:"Sign up",className:"btn-signup",path:"/signup"}].map(n=>o("button",{className:n.className,onClick:()=>{e(n.path)},children:n.title},n.title))})]})};function es(){const e=je(),{mutate:t,isLoading:n}=$e({mutationFn:_n.create,onSuccess:()=>{e.invalidateQueries(["today"])}});return{createDay:t,isLoading:n}}const ls=()=>{const{loggedInUser:e}=at(),{dailyData:t}=Mt(),{createDay:n,isLoading:r}=es(),{backgroundColor:a}=st(),i=e&&!r,s=e&&t&&!ts(t);Vn({title:"Home / Kceli"});function c(){const u=new Date().toDateString();n({date:u})}return m("main",{className:"home","data-testid":"home-page",children:[!e&&o(Ji,{}),i&&o(sa,{children:o(Zi,{})}),r&&o(te,{}),s&&m(q,{children:[o(q.OpenBtn,{modalName:"create-day",children:o("button",{className:"home__btn","data-testid":"create-day-open-modal-btn",style:{backgroundColor:a},children:"start a new day"})}),m(q.Window,{name:"create-day",className:"create-day-modal",children:[m("h2",{className:"create-day-modal__title",children:["Are you sure you want to start a new day? ",o("br",{})]}),o(q.CloseBtn,{onClickFn:c,children:o("button",{className:"btn create-day-modal__btn","data-testid":"create-day-modal-btn",children:"start a new day"})}),o(q.CloseBtn,{children:o("button",{className:"btn create-day-modal__btn",children:"cancel"})})]})]})]})};function ts(e){const t=new Date().toDateString(),n=new Date(e.date).toDateString();return t===n}export{ls as default};
