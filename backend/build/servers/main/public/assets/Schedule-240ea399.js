import{j as e,l as r,C as F,z as T,K as x,r as v,L as A,i as b,M as U,N as z,b as K,G as L,P as M,Q as y,B as I,T as X,U as S,S as j,F as G}from"./index-a4812209.js";import{E as H}from"./ErrorMsg-ed3c6cca.js";import{X as E,Y as B,R as O,C as Y}from"./YAxis-64c976b4.js";import{B as q,N as P,K as Q,F as J,v as V,c as R}from"./generateCategoricalChart-884f19e7.js";import{L as Z}from"./List-719898d1.js";import{u as ee}from"./usePageLoaded-35cdebb6.js";import{F as te,a as re}from"./index.esm-0279b3fe.js";var ae=q({chartName:"BarChart",GraphicalChild:P,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:E},{axisType:"yAxis",AxisComp:B}],formatAxisMap:Q});const ne=({intakes:s})=>{const o=s.sort((i,a)=>{const d=new Date(i.recordedAt).getTime(),n=new Date(a.recordedAt).getTime();return d-n}).map(i=>({name:i.items.reduce((a,d,n,l)=>l.length===1?d.name:n===0?a+`${d.name}, `:n===l.length-1?a+`and ${d.name}`:a+` ${d.name}, `,""),calories:i.items.reduce((a,d)=>a+d.calories,0)}));return e("div",{style:{width:"100%",maxWidth:1200,height:300},children:e(O,{children:r(ae,{data:o,children:[e(Y,{strokeDasharray:"3 3"}),e(E,{dataKey:"name"}),e(B,{}),e(J,{}),e(P,{dataKey:"calories",barSize:25,children:o.map((i,a)=>e(V,{fill:F[a%F.length]},`cell-${a}`))})]})})})};function oe(s){if(!s||s.intakes.length===0)return"No data";let c=0,o=0,i;for(const n of s.intakes){if(!n.recordedAt||n.type!=="food")continue;const l=new Date(n.recordedAt).getTime();i!==void 0&&(c+=l-i,o++),i=l}if(o===0)return"No data";const d=c/o/1e3/60/60;return d>=1?`${Math.round(d)} hours`:`${Math.round(d*60)} minutes`}const se={calcAverageTimeBetweenMeals:oe};const ie=({workout:s})=>{const{description:c,type:o,items:i}=s,a=T.calcWorkoutDuration({workout:s})+" min",d=Math.round(i.filter(n=>n.isCompleted).length/i.length*100);return r("article",{className:"day-report__workout-preview",children:[e(x,{className:"day-report__workout-preview__header",children:r("h3",{children:[c," - ",o," - ",a," - ",d,"% completed"]})}),r("table",{className:"day-report__workout-preview__table",children:[e("thead",{className:"day-report__workout-preview__table__header",children:r("tr",{children:[e("th",{children:"Exercise"}),e("th",{children:"Duration"}),e("th",{children:"Reps"}),e("th",{children:"Sets"}),e("th",{children:"Weight"}),e("th",{className:"day-report__workout-preview__table__header__completed",children:"Completed"})]})}),e("tbody",{className:"day-report__workout-preview__table__body",children:i.map((n,l)=>{const t=T.calcItemDuration(n)+" min";return n.type==="superset"?r(v.Fragment,{children:[r("tr",{children:[e("td",{children:n.name}),e("td",{children:t}),e("td",{}),e("td",{children:n.sets}),e("td",{}),e("td",{className:"completed",children:n.isCompleted?e(A,{}):""})]}),n.items.map((h,_)=>r("tr",{children:[e("td",{children:h.name}),e("td",{}),e("td",{children:h.reps}),e("td",{}),r("td",{children:[h.weight," ",h.weightUnit]}),e("td",{className:"completed"})]},`superset-${l}-subitem-${_}`))]},`superset-${l}`):n.type==="anaerobic"?r("tr",{children:[e("td",{children:n.name}),e("td",{children:t}),e("td",{children:n.reps}),e("td",{children:n.sets}),r("td",{children:[n.weight," ",n.weightUnit]}),e("td",{className:"completed",children:n.isCompleted?e(A,{}):""})]},l):r("tr",{children:[e("td",{children:n.name}),e("td",{children:t}),e("td",{}),e("td",{}),e("td",{}),e("td",{className:"completed",children:n.isCompleted?e(A,{}):""})]},l)})})]})]})};const ce=({intake:s})=>{const[c,o]=v.useState(!1),i=s.name||s.items.map(l=>l.name).join(", "),a=b.getTotalCalories(s),d=s.recordedAt?new Date(s.recordedAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"";function n(){o(!c)}return r("article",{className:"day-report__intake-preview",children:[r(x,{className:"day-report__intake-preview__header",onClickFn:n,children:[r("h3",{className:"day-report__intake-preview__header__title",children:[i," - ",a," kcal - ",d]}),e("div",{children:c?e(U,{}):e(z,{})})]}),c&&r("table",{className:"day-report__intake-preview__table",children:[e("thead",{className:"day-report__intake-preview__table__head",children:r("tr",{children:[e("th",{children:"Item"}),e("th",{children:"Calories"}),e("th",{children:"Weight"})]})}),e("tbody",{className:"day-report__intake-preview__table__body",children:s.items.map(l=>r("tr",{children:[e("td",{children:l.name}),e("td",{children:l.calories}),r("td",{children:[l.quantity," ",l.unit]})]},l.id))})]})]})},le=({day:s})=>{const{loggedInUser:c}=K(),{data:o,backgroundColor:i}=s;if(!o)return e("section",{className:"report day-report empty",children:e("p",{children:"No data for this day"})});const a=b.getTotalCalories(o),d=b.calcRemainingCalories(c,o),l=` calories ${d>0?"remaining":"over your limit"}`,t=new Intl.DateTimeFormat("en-US",{dateStyle:"full"}).format(s.date),h=se.calcAverageTimeBetweenMeals(o);return r("section",{className:"report day-report",children:[r(x,{className:"day-report__header",children:[e("h1",{children:t}),e("div",{className:"day-report__header__color-circle",style:{backgroundColor:i}})]}),r("div",{className:"day-report__weight",children:[o.weight&&r("p",{children:[e("strong",{children:"Weight: "}),o.weight]}),o.waist&&r("p",{children:[e("strong",{children:"Waist: "}),o.waist]})]}),r("div",{className:"day-report__calories",children:[e("h3",{className:"day-report__calories__title",children:"calories"}),r("p",{children:[e("strong",{children:"consumed Calories: "}),a]}),r("p",{children:[r("strong",{children:[l,": "]}),Math.abs(d)]}),r("p",{children:[e("strong",{children:"target caloric intake: "}),s.targetCalorie]})]}),o.intakes.length>0&&r("div",{className:"day-report__intakes",children:[e("h2",{className:"day-report__intakes__title",children:"Intakes"}),r("h4",{children:["Number of Intakes: ",o.intakes.length]}),r("h4",{children:["Average time between meals: ",h]}),e(Z,{className:"day-report__intakes__list",items:o.intakes,render:_=>e(ce,{intake:_},_.id)}),e(ne,{intakes:o.intakes})]}),o.workouts.length>0&&r("div",{className:"day-report__workouts",children:[e("h1",{className:"day-report__workouts__title",children:"Workouts"}),e("ul",{children:o.workouts.map((_,f)=>e("li",{children:e(ie,{workout:_})},f))})]})]})};function de(s){return L({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.13 48 48 141.13 48 256s93.13 208 208 208 208-93.13 208-208S370.87 48 256 48zm62.63 304L296 374.63 177.37 256 296 137.37 318.63 160l-96 96z"}}]})(s)}function he(s){return L({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.13 48 48 141.13 48 256s93.13 208 208 208 208-93.13 208-208S370.87 48 256 48zm-40 326.63L193.37 352l96-96-96-96L216 137.37 334.63 256z"}}]})(s)}const ue=({days:s})=>e("section",{className:"days-report",children:s.map(c=>e("div",{className:"day-report",children:e("h3",{className:"day-report__date",children:c.date.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})})},c.date.toISOString()))});const pe=()=>{const{isSuccess:s,filterBy:c,setFilterBy:o,currDay:i,setCurrDays:a,getWeekDays:d,getMonthDays:n}=M();function l(t){if(s){switch(t){case y.Day:a([]);break;case y.Week:{if(!i)return;const h=d(i);if(!h)return;a(h);break}case y.Month:{if(!i)return;const h=n(i);if(!h)return;a(h);break}}o(t)}}return e("section",{className:"schedule-filter",children:Object.values(y).map(t=>e(I,{onClickFn:()=>l(t),className:R("schedule-filter__btn",{active:c===t}),children:e("span",{children:t})},t))})};const me=()=>{const{currDate:s,currDay:c,setCurrDay:o,currDays:i,setCurrDays:a,filterBy:d,calenderDays:n,isSuccess:l,moveToMonth:t,getWeekDays:h,getMonthDays:_}=M(),[f,w]=v.useState(!1),W=v.useRef(null),N=v.useRef(0);function $(u){switch(d){case y.Day:{if(!f){o(u),a([]);return}if(!c)return;const p=[],m=n.findIndex(k=>S(k.date,c==null?void 0:c.date)),g=n.findIndex(k=>S(k.date,u.date)),C=Math.min(m,g),D=Math.max(m,g);for(let k=C;k<=D;k++)p.push(n[k]);a(p),o(u);break}case y.Week:{const p=h(u);if(!p)return;a(p),o(u);break}case y.Month:{const p=_(u);if(!p)return;a(p),o(u);break}}}return v.useEffect(()=>{const u=g=>{const C=g.touches[0];N.current=C.clientX},p=g=>{const D=g.changedTouches[0].clientX,k=50;D-N.current>k&&t(-1),N.current-D>k&&t(1)},m=W.current;if(m)return m.addEventListener("touchstart",u,!1),m.addEventListener("touchend",p,!1),()=>{m&&(m.removeEventListener("touchstart",u),m.removeEventListener("touchend",p))}},[s,l,t]),v.useEffect(()=>{const u=m=>{m.key==="Shift"&&w(!0)},p=m=>{m.key==="Shift"&&w(!1)};return window.addEventListener("keydown",u),window.addEventListener("keyup",p),()=>{window.removeEventListener("keydown",u),window.removeEventListener("keyup",p)}},[]),r("ul",{className:"calender",ref:W,children:[X.map(u=>e("li",{className:"calender__item weekday-item",children:e("h3",{className:"calender__item__title",children:u.short})},u.short)),n.map(u=>{const{backgroundColor:p,date:m}=u,g=u.backgroundColor?"white":"",C=u.isBorder?"4px solid var(--color-success)":"none";return e("li",{className:R("calender__item",{active:c&&S(u.date,c.date)||i.some(D=>S(u.date,D.date))}),onClick:()=>$(u),style:{backgroundColor:p,color:g},children:e("div",{className:"calender__item__wrapper",style:{border:C},children:e("h3",{children:u.day})})},m.toISOString())})]})};const _e=()=>{const{currDays:s,data:c}=M();if(!s.length||!c)return e("section",{className:"report week-report",children:e("p",{children:"No data for this week"})});const o=s.map(t=>t.data).filter(t=>!!t),i=d(),a=l();function d(){if(!s.length||!c)return;const t=s[0],h=new Date(t.date);return h.setDate(h.getDate()-7),h.setHours(0,0,0,0),c.filter(f=>{const w=new Date(f.date);return w>=h&&w<t.date})}function n({trend:t,positive:h}){if(!t)return;const _=20;return t>0?e(te,{size:_,color:h==="up"?"green":"red"}):e(re,{size:_,color:h==="down"?"green":"red"})}function l(){const t={documentedDay:{currWeek:0,prevWeek:0,trend:0},totalCalories:{currWeek:0,prevWeek:0,trend:0},averageCaloriesPerDay:{currWeek:0,prevWeek:0,trend:0},totalWorkouts:{currWeek:0,prevWeek:0,trend:0}};if(!(!o.length||!(i!=null&&i.length)))return t.documentedDay.currWeek=o.length,t.documentedDay.prevWeek=i.length,t.documentedDay.trend=t.documentedDay.currWeek-t.documentedDay.prevWeek,t.totalCalories.currWeek=b.getTotalCalories(o),t.totalCalories.prevWeek=b.getTotalCalories(i),t.totalCalories.trend=t.totalCalories.currWeek-t.totalCalories.prevWeek,t.averageCaloriesPerDay.currWeek=Math.round(t.totalCalories.currWeek/o.length),t.averageCaloriesPerDay.prevWeek=Math.round(t.totalCalories.prevWeek/i.length),t.averageCaloriesPerDay.trend=t.averageCaloriesPerDay.currWeek-t.averageCaloriesPerDay.prevWeek,t.totalWorkouts.currWeek=T.getTotalWorkouts(o),t.totalWorkouts.prevWeek=T.getTotalWorkouts(i),t.totalWorkouts.trend=t.totalWorkouts.currWeek-t.totalWorkouts.prevWeek,t}return e("div",{className:"report week-report",children:a&&e("div",{className:"table-container",children:r("table",{children:[e("thead",{children:r("tr",{children:[e("th",{children:"value"}),e("th",{children:"current week"}),e("th",{children:"previous week"}),e("th",{children:"trend"})]})}),r("tbody",{children:[r("tr",{children:[e("td",{children:"documented days"}),e("td",{children:a.documentedDay.currWeek}),e("td",{children:a.documentedDay.prevWeek}),e("td",{children:n({trend:a.documentedDay.trend,positive:"up"})})]}),r("tr",{children:[e("td",{children:"total calories"}),e("td",{children:a.totalCalories.currWeek}),e("td",{children:a.totalCalories.prevWeek}),e("td",{children:n({trend:a.totalCalories.trend,positive:"down"})})]}),r("tr",{children:[e("td",{children:"average calories per day"}),e("td",{children:a.averageCaloriesPerDay.currWeek}),e("td",{children:a.averageCaloriesPerDay.prevWeek}),e("td",{children:n({trend:a.averageCaloriesPerDay.trend,positive:"down"})})]}),r("tr",{children:[e("td",{children:"total workouts"}),e("td",{children:a.totalWorkouts.currWeek}),e("td",{children:a.totalWorkouts.prevWeek}),e("td",{children:n({trend:a.totalWorkouts.trend,positive:"up"})})]})]})]})})})},De=()=>{ee({title:"Schedule / Kceli"});const{currDate:s,currDay:c,setCurrDay:o,currDays:i,filterBy:a,calenderDays:d,isLoading:n,isSuccess:l,isError:t,moveToMonth:h}=M(),_=!!c&&a===y.Day,f=i.length>0&&a===y.Day;return v.useEffect(()=>{if(!l||c)return;const w=new Date,W=d.find(N=>S(N.date,w));W&&o(W)},[d,l,c,i,o]),r("main",{className:"page schedule-page",children:[n&&e(j,{}),t&&e(H,{}),l&&r(G,{children:[r(x,{className:"schedule-page__header",children:[r("h2",{className:"schedule-page__header__title",children:[s.toLocaleString("en-US",{month:"long"})," ",s.getFullYear()]}),r("div",{className:"schedule-page__header__btns-container",children:[e(I,{onClickFn:()=>h(-1),children:e(de,{className:"schedule-page__header__btns-container__btn__icon"})}),e(I,{onClickFn:()=>h(1),children:e(he,{className:"schedule-page__header__btns-container__btn__icon"})})]})]}),e(me,{}),e(pe,{}),_&&e(le,{day:c}),f&&e(ue,{days:i}),a===y.Week&&e(_e,{})]})]})};export{De as default};
