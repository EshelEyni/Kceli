import{r as P,u as ln,s as un,c as Ee,g as Fe,h as te,a as le,b as dn,d as je,e as Mt,f as Bt,i as fn,k as we,j as o,l as it,n as ft,m,B as D,G as Wt,S as J,o as $e,p as Me,q as hn,t as st,F as ke,_ as Ze,R as N,C as ht,v as pn,w as mn,x as gn,y as vn,z as yn,A as kn,D as bn,E as _n,H as wn}from"./index-cfe9248a.js";import{c as me,f as $,_ as Ut,a as qt,b as In,d as An,e as se,T as ot,p as Z,L as V,g as ct,h as Qt,D as Pn,i as Sn,j as Cn,k as On,G as Nn,u as xn,C as En,S as pt,l as pe,m as ue,A as Rn,n as Dn,o as mt,q as Tn,r as fe,s as Ln,t as Fn,v as Gt,w as jn,x as Ce,y as gt,z as Ne,B as $n,E as Mn,F as Bn}from"./generateCategoricalChart-ded5f26b.js";import{L as Be}from"./List-9a629674.js";import{E as lt}from"./ErrorMsg-de8c4123.js";import{u as Wn,W as Un}from"./WorkoutEditMainInputs-5ef08c69.js";import{u as Kt,C as Ie}from"./index.esm-4b31c387.js";import{R as qn,a as Qn,W as Gn}from"./WorkoutPreview-aad0c3f8.js";import{D as Kn,S as zn,P as Vn,E as Hn}from"./Empty-d8a29991.js";function Yn(e){P.useEffect(()=>{const t=document.title;return document.title=e||"Kceli",()=>{document.title=t}},[e])}function Xn({title:e}){const t=ln();Yn(e),P.useEffect(()=>{t(un(!1))},[t])}var We=(e=>(e.UNIT="unit",e.GRAM="g",e.CUP="cup",e.TABLE_SPOON="tbsp",e.TEA_SPOON="tsp",e.MILLILITER="ml",e))(We||{});const Zn=Object.values(We);function Jn(){return{id:Ee(),name:"",items:[zt()],isRecorded:!0,recordedAt:null,type:"food"}}function zt(){return{id:Ee(),unit:We.UNIT,quantity:1,name:""}}function er(e){switch(e){case"g":return 100;case"ml":return 100;case"unit":return 1;case"cup":return 1;case"tbsp":return 1;case"tsp":return 1;default:return 1}}function tr(e){switch(e){case"g":return 25;case"ml":return 25;case"unit":return 1;case"cup":return 1;case"tbsp":return 1;case"tsp":return 1;default:return 1}}const G={getDefaultIntake:Jn,getDefaultIntakeItem:zt,getUnitDefaultQuantity:er,getQuantityStepPerUnit:tr,units:Zn};/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var nr=function(t){return t!=null&&t.constructor!=null&&typeof t.constructor.isBuffer=="function"&&t.constructor.isBuffer(t)},Vt=ar,rr=[];function ar(e,t){var n=0,r;if(!t)return rr;if(e.FLAG==="long"){for(r=new Array(Math.ceil(t.length/2));n<t.length;)r[n/2]=t.slice(n,n+2),n+=2;return r}return t.split(e.FLAG==="num"?",":"")}var ir=Vt,sr=lr,or=[].push,Oe="etaoinshrdlcumwfgypbvkjxqz".split(""),_e=/\s+/,cr=["qwertzuop","yxcvbnm","qaw","say","wse","dsx","sy","edr","fdc","dx","rft","gfv","fc","tgz","hgb","gv","zhu","jhn","hb","uji","kjm","jn","iko","lkm"];function lr(e){var t=Object.create(null),n=Object.create(null),r=Object.create(null),a=[],i={in:[],out:[]},s=[],c=e.toString("utf8"),l=[],d=0,u=c.indexOf(`
`),f,v,h,p,g,y,_,I,C,b,w,k,x;for(r.KEY=[];u>-1;)O(c.slice(d,u)),d=u+1,u=c.indexOf(`
`,d);for(O(c.slice(d)),u=-1;++u<l.length;)if(v=l[u],f=v.split(_e),h=f[0],h==="REP"){for(p=u+parseInt(f[1],10);++u<=p;)f=l[u].split(_e),a.push([f[1],f[2]]);u--}else if(h==="ICONV"||h==="OCONV"){for(p=u+parseInt(f[1],10),I=i[h==="ICONV"?"in":"out"];++u<=p;)f=l[u].split(_e),I.push([new RegExp(f[1],"g"),f[2]]);u--}else if(h==="COMPOUNDRULE"){for(p=u+parseInt(f[1],10);++u<=p;)for(b=l[u].split(_e)[1],C=-1,s.push(b);++C<b.length;)n[b.charAt(C)]=[];u--}else if(h==="PFX"||h==="SFX"){for(p=u+parseInt(f[3],10),b={type:h,combineable:f[2]==="Y",entries:[]},t[f[1]]=b;++u<=p;){f=l[u].split(_e),g=f[2],y=f[3].split("/"),_=f[4],I={add:"",remove:"",match:"",continuation:ir(r,y[1])},y&&y[0]!=="0"&&(I.add=y[0]);try{g!=="0"&&(I.remove=h==="SFX"?vt(g):g),_&&_!=="."&&(I.match=h==="SFX"?vt(_):ur(_))}catch{I=null}I&&b.entries.push(I)}u--}else if(h==="TRY"){for(_=f[1],k=-1,w=[];++k<_.length;)x=_.charAt(k),x.toLowerCase()===x&&w.push(x);for(k=-1;++k<Oe.length;)_.indexOf(Oe[k])<0&&w.push(Oe[k]);r[h]=w}else h==="KEY"?or.apply(r[h],f[1].split("|")):h==="COMPOUNDMIN"?r[h]=Number(f[1]):h==="ONLYINCOMPOUND"?(r[h]=f[1],n[f[1]]=[]):r[h]=f[1];return isNaN(r.COMPOUNDMIN)&&(r.COMPOUNDMIN=3),r.KEY.length||(r.KEY=cr),r.TRY||(r.TRY=Oe.concat()),r.KEEPCASE||(r.KEEPCASE=!1),{compoundRuleCodes:n,replacementTable:a,conversion:i,compoundRules:s,rules:t,flags:r};function O(S){S=S.trim(),S&&S.charCodeAt(0)!==35&&l.push(S)}}function vt(e){return new RegExp(e+"$")}function ur(e){return new RegExp("^"+e)}var Ht=dr;function dr(e,t){for(var n=-1;++n<t.length;)e=e.replace(t[n][0],t[n][1]);return e}var Ue=fr;function fr(e,t,n){return n&&t in e&&n.indexOf(e[t])>-1}var hr=Ue,pr=mr;function mr(e,t){var n=-1;if(e.data[t])return!hr(e.flags,"ONLYINCOMPOUND",e.data[t]);if(t.length>=e.flags.COMPOUNDMIN){for(;++n<e.compoundRules.length;)if(e.compoundRules[n].test(t))return!0}return!1}var gr=Ht,Ve=pr,Je=Ue,ut=vr;function vr(e,t,n){var r=t.trim(),a;if(!r)return null;if(r=gr(r,e.conversion.in),Ve(e,r))return!n&&Je(e.flags,"FORBIDDENWORD",e.data[r])?null:r;if(r.toUpperCase()===r){if(a=r.charAt(0)+r.slice(1).toLowerCase(),yt(e.flags,e.data[a],n))return null;if(Ve(e,a))return a}if(a=r.toLowerCase(),a!==r){if(yt(e.flags,e.data[a],n))return null;if(Ve(e,a))return a}return null}function yt(e,t,n){return Je(e,"KEEPCASE",t)||n||Je(e,"FORBIDDENWORD",t)}var yr=ut,kr=br;function br(e){return!!yr(this,e)}var _r=wr;function wr(e){var t=kt(e.charAt(0)),n=e.slice(1);return!n||(n=kt(n),t===n)?t:t==="u"&&n==="l"?"s":null}function kt(e){return e===e.toLowerCase()?"l":e===e.toUpperCase()?"u":null}var xe=_r,bt=Ht,Ir=Ue,Ar=ut,Pr=Cr,Sr=[].push;function Cr(e){var t=this,n={},r=[],a={},i,s,c=[],l,d,u,f,v,h,p,g,y,_,I,C,b,w,k,x,O,S,T,W,K,M,U;if(e=bt(e.trim(),t.conversion.in),!e||t.correct(e))return[];for(U=xe(e),d=-1;++d<t.replacementTable.length;)for(s=t.replacementTable[d],u=e.indexOf(s[0]);u>-1;)c.push(e.replace(s[0],s[1])),u=e.indexOf(s[0],u+1);for(d=-1;++d<e.length;)for(g=e.charAt(d),_=e.slice(0,d),I=e.slice(d+1),b=g.toLowerCase(),C=b!==g,n={},u=-1;++u<t.flags.KEY.length;)if(y=t.flags.KEY[u],f=y.indexOf(b),!(f<0)){for(h=-1;++h<y.length;)if(h!==f){if(p=y.charAt(h),n[p])continue;n[p]=!0,C&&(p=p.toUpperCase()),c.push(_+p+I)}}for(d=-1,O=e.charAt(0),l=[""],S=1,T=0;++d<e.length;){for(g=O,O=e.charAt(d+1),_=e.slice(0,d),s=g===O?"":g+g,u=-1,v=l.length;++u<v;)u<=S&&l.push(l[u]+s),l[u]+=g;++T<3&&(S=l.length)}for(Sr.apply(c,l),l=[e],s=e.toLowerCase(),(e===s||U===null)&&l.push(e.charAt(0).toUpperCase()+s.slice(1)),s=e.toUpperCase(),e!==s&&l.push(s),i={state:{},weighted:a,suggestions:r},w=_t(t,i,l,c),k=0,S=Math.min(w.length,Math.pow(Math.max(15-e.length,3),3)),W=Math.max(Math.pow(10-e.length,3),1);!r.length&&k<S;)x=k+W,_t(t,i,w.slice(k,x)),k=x;for(r.sort(Y),l=[],K=[],d=-1;++d<r.length;)M=bt(r[d],t.conversion.out),s=M.toLowerCase(),K.indexOf(s)<0&&(l.push(M),K.push(s));return l;function Y(R,F){return ee(R,F)||A(R,F)||E(R,F)}function ee(R,F){return a[R]===a[F]?0:a[R]>a[F]?-1:1}function A(R,F){var B=xe(R),re=xe(F);return B===re?0:B===U?-1:re===U?1:void 0}function E(R,F){return R.localeCompare(F)}}function _t(e,t,n,r){var a=e.flags.TRY,i=e.data,s=e.flags,c=[],l=-1,d,u,f,v,h,p,g,y,_,I,C,b,w;if(r)for(;++l<r.length;)k(r[l],!0);for(l=-1;++l<n.length;)for(d=n[l],u="",f="",v=d.charAt(0),h=d,p=d.slice(1),g=v.toLowerCase()!==v,y=xe(d),_=-1;++_<=d.length;)for(u+=f,I=h,h=p,p=h.slice(1),f=v,v=d.charAt(_+1),C=g,v&&(g=v.toLowerCase()!==v),h&&C!==g&&(k(u+x(h)),k(u+x(v)+x(f)+p)),k(u+h),h&&k(u+v+f+p),w=-1;++w<a.length;)b=a[w],C&&b!==b.toUpperCase()?(y!=="s"&&(k(u+b+I),k(u+b+h)),b=b.toUpperCase(),k(u+b+I),k(u+b+h)):(k(u+b+I),k(u+b+h));return c;function k(O,S){var T=t.state[O],W;T!==!!T&&(c.push(O),W=Ar(e,O),T=W&&!Ir(s,"NOSUGGEST",i[W]),t.state[O]=T,T&&(t.weighted[O]=S?10:0,t.suggestions.push(O))),T&&t.weighted[O]++}function x(O){var S=O.charAt(0);return(S.toLowerCase()===S?S.toUpperCase():S.toLowerCase())+O.slice(1)}}var Or=ut,wt=Ue,Nr=xr;function xr(e){var t=this,n=Or(t,e,!0);return{correct:t.correct(e),forbidden:!!(n&&wt(t.flags,"FORBIDDENWORD",t.data[n])),warn:!!(n&&wt(t.flags,"WARN",t.data[n]))}}var Er=Yt;function Yt(e,t,n,r){for(var a=-1,i,s,c,l,d;++a<t.entries.length;)if(i=t.entries[a],l=i.continuation,d=-1,(!i.match||i.match.test(e))&&(s=i.remove?e.replace(i.remove,""):e,s=t.type==="SFX"?s+i.add:i.add+s,r.push(s),l&&l.length))for(;++d<l.length;)c=n[l[d]],c&&Yt(s,c,n,r);return r}var It=Er,Xt=Tr,Rr=[].push,et=[];function Dr(e,t,n){var r=e[t];t in e?r===et?e[t]=n.concat():Rr.apply(r,n):e[t]=n.concat()}function Tr(e,t,n,r){var a=-1,i,s,c,l,d,u,f;for((!("NEEDAFFIX"in r.flags)||n.indexOf(r.flags.NEEDAFFIX)<0)&&Dr(e,t,n);++a<n.length;)if(i=r.rules[n[a]],n[a]in r.compoundRuleCodes&&r.compoundRuleCodes[n[a]].push(t),i){for(u=It(t,i,r.rules,[]),s=-1;++s<u.length;)if(u[s]in e||(e[u[s]]=et),i.combineable){for(c=a;++c<n.length;)if(d=r.rules[n[c]],d&&d.combineable&&i.type!==d.type)for(f=It(u[s],d,r.rules,[]),l=-1;++l<f.length;)f[l]in e||(e[f[l]]=et)}}}var Lr=Xt,Fr=$r,jr=[];function $r(e,t){var n=this;return Lr(n.data,e,n.data[t]||jr,n),n}var Mr=Br;function Br(e){var t=this;return delete t.data[e],t}var Wr=Ur;function Ur(){return this.flags.WORDCHARS||null}var qr=Vt,Qr=Xt,Gr=Kr,At=/\s/g;function Kr(e,t,n){for(var r=e.toString("utf8"),a=r.indexOf(`
`)+1,i=r.indexOf(`
`,a);i>-1;)r.charCodeAt(a)!==9&&Pt(r.slice(a,i),t,n),a=i+1,i=r.indexOf(`
`,a);Pt(r.slice(a),t,n)}function Pt(e,t,n){for(var r=e.indexOf("/"),a=e.indexOf("#"),i="",s,c;r>-1&&e.charCodeAt(r-1)===92;)e=e.slice(0,r-1)+e.slice(r),r=e.indexOf("/",r);a>-1?r>-1&&r<a?(s=e.slice(0,r),At.lastIndex=r+1,c=At.exec(e),i=e.slice(r+1,c?c.index:void 0)):s=e.slice(0,a):r>-1?(s=e.slice(0,r),i=e.slice(r+1)):s=e,s=s.trim(),s&&Qr(n,s,qr(t.flags,i.trim()),t)}var zr=Gr,Vr=Hr;function Hr(e){var t=this,n=-1,r,a,i,s;for(zr(e,t,t.data);++n<t.compoundRules.length;){for(r=t.compoundRules[n],a="",s=-1;++s<r.length;)i=r.charAt(s),a+=t.compoundRuleCodes[i].length?"(?:"+t.compoundRuleCodes[i].join("|")+")":i;t.compoundRules[n]=new RegExp(a,"i")}return t}var Yr=Xr;function Xr(e){var t=this,n=e.toString("utf8").split(`
`),r=-1,a,i,s,c;for(t.flags.FORBIDDENWORD===void 0&&(t.flags.FORBIDDENWORD=!1),c=t.flags.FORBIDDENWORD;++r<n.length;)a=n[r].trim(),a&&(a=a.split("/"),s=a[0],i=s.charAt(0)==="*",i&&(s=s.slice(1)),t.add(s,a[1]),i&&t.data[s].push(c));return t}var St=nr,Zr=sr,Jr=Re,ne=Re.prototype;ne.correct=kr;ne.suggest=Pr;ne.spell=Nr;ne.add=Fr;ne.remove=Mr;ne.wordCharacters=Wr;ne.dictionary=Vr;ne.personal=Yr;function Re(e,t){var n=-1,r;if(!(this instanceof Re))return new Re(e,t);if(typeof e=="string"||St(e)?(typeof t=="string"||St(t))&&(r=[{dic:t}]):e&&("length"in e?(r=e,e=e[0]&&e[0].aff):(e.dic&&(r=[e]),e=e.aff)),!e)throw new Error("Missing `aff` in dictionary");if(e=Zr(e),this.data=Object.create(null),this.compoundRuleCodes=e.compoundRuleCodes,this.replacementTable=e.replacementTable,this.conversion=e.conversion,this.compoundRules=e.compoundRules,this.rules=e.rules,this.flags=e.flags,r)for(;++n<r.length;)r[n].dic&&this.dictionary(r[n].dic)}const ea=Fe(Jr);function ta(e,t){if(!e||!t)return 0;const n=t.weight||e.weight,r=Number((n*33).toFixed(2)),a=t.intakes.filter(i=>i.isRecorded).reduce((i,s)=>s.items.reduce((c,l)=>{if(l.name.toLocaleLowerCase()==="water")switch(l.unit){case"ml":return c+l.quantity;case"cup":return c+l.quantity*250;default:return c}return c},i),0)||0;return Number(((r-a)/1e3).toFixed(2))}const na={calcRecommendedWaterIntake:ta};function ra(e){return{type:e,response:null,status:"idle",error:null}}const He={getDefaultNutritionQuery:ra};async function aa(){const e=await te.get("intake/favorite");return le(e)}async function ia(e){const t=await te.post("intake/favorite",e);return le(t)}async function sa(e){const t=await te.patch(`intake/favorite/${e.id}`,e);return le(t)}async function oa(e){await te.delete(`intake/favorite/${e}`)}const qe={getUserFavoriteIntakes:aa,addUserFavoriteIntake:ia,updateUserFavoriteIntake:sa,removeUserFavoriteIntake:oa};function ca(){const{data:e,error:t,isLoading:n,isSuccess:r,isError:a}=dn({queryKey:["favoriteIntakes"],queryFn:qe.getUserFavoriteIntakes}),i=!!e&&e.length===0;return{favoriteIntakes:e,error:t,isLoading:n,isSuccess:r,isError:a,isEmpty:i}}var j=(e=>(e.IntakeEdit="IntakeEdit",e.IntakeList="IntakeList",e.UnRecordedIntakeList="UnRecordedIntakeList",e.FavoriteIntake="FavoriteIntake",e.Water="Water",e.WeightWaistInput="WeightWaistInput",e.Workouts="Workouts",e.Query="Query",e))(j||{});const Zt=P.createContext(void 0);function la({children:e}){const{loggedInUser:t}=je(),{dailyData:n,isLoading:r,isSuccess:a,isError:i}=Mt(),{updateDailyData:s,isLoading:c}=Bt(),{favoriteIntakes:l,isLoading:d,isSuccess:u,isError:f,isEmpty:v}=ca(),[h,p]=fn(),[g,y]=P.useState(h.get("tab")||"IntakeEdit"),[_,I]=P.useState(G.getDefaultIntake()),[C,b]=P.useState(_.items[0].id),[w,k]=P.useState(He.getDefaultNutritionQuery("chatGPT")),[x,O]=P.useState(He.getDefaultNutritionQuery("ninjaAPI")),[S,T]=P.useState(He.getDefaultNutritionQuery("usdaAPI")),W=(n==null?void 0:n.intakes.filter(B=>B.isRecorded))||[],K=(n==null?void 0:n.intakes.filter(B=>!B.isRecorded))||[],M=we.getTotalCalories(n),U=we.calcRemainingCalories(t,n),Y=(n==null?void 0:n.targetCaloricIntake)??(t==null?void 0:t.targetCaloricIntakePerDay)??0,ee=we.calcEstimatedBodyFatStatusPerDay(t,n),A=Math.round(M/Y*100),E=Math.round(U/Y*100),R=na.calcRecommendedWaterIntake(t,n);P.useEffect(()=>{if(!a||!n||n!=null&&n.weight||n!=null&&n.isWeightWaistIgnored)return;y("WeightWaistInput");const B=new URLSearchParams({tab:"WeightWaistInput"});p(B)},[n,a]);const F={dailyData:n,isLoading:r,isSuccess:a,isError:i,updateDailyData:s,isLoadingUpdate:c,recordedIntakes:W,unrecordedIntakes:K,remainingCalories:U,consumedCalories:M,targetCaloricIntakePerDay:Y,estimatedKGChange:ee,openedTab:g,setOpenedTab:y,recommendedWaterIntake:R,intake:_,setIntake:I,calConsumedPct:A,calRemainingPct:E,chatGPTQuery:w,setChatGPTQuery:k,ninjaAPIQuery:x,setNinjaAPIQuery:O,USDAAPIQuery:S,setUSDAAPIQuery:T,currIntakeItemId:C,setCurrIntakeItemId:b,favoriteIntakes:l,isLoadingFavoriteIntakes:d,isSuccessFavoriteIntakes:u,isErrorFavoriteIntakes:f,isEmptyFavoriteIntakes:v,setSearchParams:p};return o(Zt.Provider,{value:F,children:e})}function Q(){const e=P.useContext(Zt);if(e===void 0)throw new Error("useDayEdit must be used within a DayEditProvider");return e}const ua="calorie";async function da(e){const t=await te.post(`${ua}/item`,e);return le(t)}const fa={getCaloriesForItem:da},Jt=P.createContext(void 0);function ha({intakeItem:e,children:t}){const{intake:n,setIntake:r,currIntakeItemId:a,setCurrIntakeItemId:i}=Q(),s=n.items.length===1,c=e.id===a,[l,d]=P.useState(!1),[u,f]=P.useState(""),[v,h]=P.useState(!1),[p,g]=P.useState([]),[y,_]=P.useState(null),I=P.useRef(null),C=p.length>0&&p[0].suggestions.length>0&&!!e.name.length&&!!y;function b(A){A!==a&&i(A)}function w(A){A.preventDefault();const{value:E,name:R}=A.target;switch(R){case"name":if(k({...e,name:E}),E.length||g([]),!I.current)return;I.current(E);break;case"quantity":k({...e,quantity:Number(E)});break;case"calories":{const F={...e,calories:Number(E)};delete F.caloriesPer100g,k(F),f("caloriesPer100g");break}case"caloriesPer100g":{const B=Number(E)*(e.quantity/100);k({...e,caloriesPer100g:Number(E),calories:B}),f("calories");break}}}function k(A){r(E=>({...E,items:E.items.map(R=>R.id===A.id?A:R)}))}function x(){const A=G.getQuantityStepPerUnit(e.unit);e.quantity-A<1||k({...e,quantity:e.quantity-A})}function O(){const A=G.getQuantityStepPerUnit(e.unit);k({...e,quantity:e.quantity+A})}function S(){const A=G.units.indexOf(e.unit),E=A===G.units.length-1?G.units[0]:G.units[A+1],R=G.getUnitDefaultQuantity(E);k({...e,unit:E,quantity:R})}function T(){const A={...e};l&&(delete A.calories,delete A.caloriesPer100g,f("")),d(E=>!E),k(A)}async function W(){if(!e.name.length)return ft.error("Please enter a food name!");try{h(!0);const A=await fa.getCaloriesForItem(e);k({...e,calories:A}),d(!0)}catch(A){console.error(A),ft.error("Failed to calculate calories!")}finally{h(!1)}}function K(A,E){const R=e.name.replace(A,E),F=p.filter(B=>B.original!==A);g(F),k({...e,name:R})}function M(A){const E=p.filter(R=>R.original!==A);g(E)}function U(){const A=G.getDefaultIntakeItem();r(E=>({...E,items:[...E.items,A]})),i(A.id)}function Y(){var B,re;if(n.items.length===1)return;const A=n.items.findIndex(X=>X.id===e.id),E=(B=n.items[A-1])==null?void 0:B.id,R=(re=n.items[A+1])==null?void 0:re.id,F=[...n.items];F.splice(A,1),r(X=>({...X,items:F})),i(R||E)}P.useEffect(()=>{Promise.all([fetch("/assets/dictionaries/en_US.aff").then(A=>A.text()),fetch("/assets/dictionaries/en_US.dic").then(A=>A.text())]).then(([A,E])=>{const R=new ea(A,E);_(R)}).catch(A=>{console.error("Failed to load dictionaries:",A)})},[]),P.useEffect(()=>{function A(E){if(!y)return;const R=new Set(["nes","ness"]),re=E.split(" ").filter(X=>!R.has(X)&&X.length>3).map(X=>({original:X,suggestions:y.suggest(X)}));g(re)}I.current=it(A,1e3).debouncedFunc},[y]);const ee={intakeItem:e,isOneItem:s,isCurrIntakeItem:c,isManual:l,inputFaded:u,setInputFaded:f,isLoadingCal:v,suggestions:p,setSuggestions:g,isSuggestionListShown:C,handleNameInputClick:b,handleInputChange:w,decreaseQuantity:x,increaseQuantity:O,handleUnitBtnClick:S,handleToggleManual:T,handleCalcBtnClick:W,handleSuggestionClick:K,handleIgnoreSuggestionClick:M,handleAddButtonClick:U,handleRemoveButtonClick:Y};return o(Jt.Provider,{value:ee,children:t})}function be(){const e=P.useContext(Jt);if(!e)throw new Error("useIntakeItemEdit must be used within an IntakeItemEditProvider");return e}const pa=()=>{const{suggestions:e,handleSuggestionClick:t,handleIgnoreSuggestionClick:n}=be();return o("ul",{className:"spelling-suggestion-list","data-testid":"spelling-suggestion-list",children:e.map((r,a)=>m("li",{className:"spelling-suggestion-list__item",children:[r.suggestions.map(i=>o(D,{className:"intake-item-edit__btn spelling-suggestion-list__btn",onClickFn:()=>t(r.original,i),dataTestId:"spelling-suggestion-list-btn",children:o("span",{children:i})},i)),o(D,{className:"intake-item-edit__btn spelling-suggestion-list__btn",dataTestId:"ignore-suggestion-btn",onClickFn:()=>n(r.original),children:o("span",{children:"ignore"})})]},a))})};const ma=()=>{const{intakeItem:e,inputFaded:t,setInputFaded:n,handleInputChange:r}=be(),a=e.calories?Math.round(e.calories):"";function i(s){t===s&&n("")}return m("div",{className:"intake-item-edit__manuall-calorie-edit","data-testid":"intake-item-edit-manuall-calorie-edit",children:[o("input",{type:"number",name:"calories",className:me("intake-item-input",{faded:t==="calories"}),value:a,placeholder:"Calories",onChange:r,onClick:()=>i("calories")}),o("input",{type:"number",name:"caloriesPer100g",className:me("intake-item-input",{faded:t==="caloriesPer100g"}),value:e.caloriesPer100g||"",placeholder:"Calories per 100g",onChange:r,onClick:()=>i("caloriesPer100g")})]})};function ga(e){return Wt({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h368c4.4 0 8 3.6 8 8v48z"}}]})(e)}function va(e){return Wt({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H544v152c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V544H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h152V328c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v152h152c4.4 0 8 3.6 8 8v48z"}}]})(e)}const ya=()=>{const{intakeItem:e,isManual:t,isLoadingCal:n,handleInputChange:r,decreaseQuantity:a,increaseQuantity:i,handleUnitBtnClick:s,handleToggleManual:c,handleCalcBtnClick:l}=be();return m("section",{className:"intake-item-edit__inputs-btns","data-testid":"intake-item-edit-inputs-btns",children:[m("div",{className:"quantity-input-container",children:[o(D,{onClickFn:a,children:o(ga,{})}),o("input",{type:"number",name:"quantity",className:"intake-item-input quantity-input",value:e.quantity,onChange:r}),o(D,{onClickFn:i,children:o(va,{})})]}),o(D,{onClickFn:s,className:"intake-item-edit__btn",children:o("span",{children:e.unit})}),o(D,{onClickFn:c,className:"intake-item-edit__btn",children:o("span",{children:t?"Manual":"Auto"})}),o(D,{onClickFn:l,className:"intake-item-edit__btn calc-calories-btn",children:n?o(J,{withContainer:!0,containerSize:{width:"100%"}}):o("span",{children:"calc"})})]})},ka=()=>{const{isOneItem:e,handleAddButtonClick:t,handleRemoveButtonClick:n}=be();return m("section",{className:"intake-edit-item__btns-container","data-testid":"intake-item-edit-btns",children:[!e&&o(D,{onClickFn:n,children:"remove item"}),o(D,{onClickFn:t,children:"add item"})]})},ba=()=>{const{intakeItem:e,handleNameInputClick:t,handleInputChange:n}=be();return o("input",{type:"text",name:"name",className:"intake-item-input",value:e.name,onChange:n,spellCheck:!0,autoComplete:"off",placeholder:"Enter food name",onClick:()=>t(e.id)})},_a=()=>{const{isCurrIntakeItem:e,isManual:t,isSuggestionListShown:n}=be();return m("section",{className:"intake-item-edit","data-testid":"intake-item-edit",children:[o(ba,{}),n&&o(pa,{}),o(ya,{}),t&&o(ma,{}),e&&o(ka,{})]})};function en(){const e=$e(),{mutate:t,isLoading:n}=Me({mutationFn:qe.addUserFavoriteIntake,onSuccess:()=>{e.invalidateQueries(["favoriteIntakes"])}});return{addFavoriteIntake:t,isLoading:n}}function tn(){const e=$e(),{mutate:t,isLoading:n}=Me({mutationFn:r=>qe.updateUserFavoriteIntake(r),onSuccess:()=>{e.invalidateQueries(["favoriteIntakes"])}});return{updateFavoriteIntake:t,isLoading:n}}const wa=()=>{const{dailyData:e}=Q();if(!e)return null;const t=e.intakes.findLast(r=>r.isRecorded&&r.type==="food");if(!t)return null;const n=hn(t.recordedAt);return m("h5",{className:"last-time-you-ate-title",children:["Last time you ate: ",n]})};const Ia=()=>{const{intake:e,consumedCalories:t,remainingCalories:n}=Q();if(!e||!e.isRecorded)return null;const r=e.items.reduce((s,c)=>c.calories===void 0?s:s+c.calories,0);if(r<=0)return null;const a=t+r,i=n-r;return m("section",{className:"pre-save-calorie-count",children:[m("p",{children:[o("strong",{children:"Total:"})," ",o("span",{children:r})]}),m("p",{children:[o("strong",{children:"Consumed:"})," ",o("span",{children:a})]}),m("p",{children:[o("strong",{children:"Remaining:"})," ",o("span",{children:i})]})]})};const Aa=()=>{const{dailyData:e,isLoading:t,isLoadingUpdate:n,intake:r,updateDailyData:a,setIntake:i}=Q(),{addFavoriteIntake:s,isLoading:c}=en(),{updateFavoriteIntake:l,isLoading:d}=tn(),{backgroundColor:u}=st(),f=t||n||c||d,v=r.recordedAt&&r.isRecorded;function h(w){w.preventDefault();const{value:k}=w.target;i(x=>({...x,name:k}))}function p(){const w=r.type==="food"?"drink":"food";i(k=>({...k,type:w}))}function g(w){w.preventDefault();const{value:k}=w.target,[x,O]=k.split(":"),S=new Date(r.recordedAt);S.setHours(+x),S.setMinutes(+O),i(T=>({...T,recordedAt:S}))}function y(){i(G.getDefaultIntake())}function _(w){if(w.preventDefault(),!r.items.every(x=>x.name.length&&x.quantity>0))return Ze.error("Please fill all intake items");r.recordedAt=null,r.isRecorded=!1,"userId"in r?l(r):s(r),i(G.getDefaultIntake())}function I(){i(w=>({...w,recordedAt:w.isRecorded?null:new Date,isRecorded:!w.isRecorded}))}function C(w){if(w.preventDefault(),!e)return;if(!r.items.every(S=>S.name.length&&S.quantity>0))return Ze.error("Please fill all intake items");r.isRecorded&&!r.recordedAt&&(r.recordedAt=new Date);const O=!e.intakes.some(S=>S.id===r.id)?[...e.intakes,r]:e.intakes.map(S=>S.id===r.id?r:S);a({...e,intakes:O}),i(G.getDefaultIntake())}function b(w){const k=new Date(w),x=k.getTimezoneOffset();return k.setMinutes(k.getMinutes()-x),k.toISOString().slice(11,16)}return m("form",{className:"intake-edit",onSubmit:C,"data-testid":"intake-edit",children:[f&&o(J,{withContainer:!0,containerSize:{height:"75px",width:"100%"}}),!f&&m(ke,{children:[m("header",{className:"intake-edit__header","data-testid":"intake-edit-header",children:[m("div",{className:"intake-edit__header__input-name-btn-type",children:[o("input",{type:"text",placeholder:"Name your intake",autoComplete:"off",value:r.name||"",onChange:h,className:"intake-edit__header__name-input","data-testid":"intake-edit-name-input"}),o(D,{onClickFn:p,className:"intake-edit-btn",children:o("span",{children:r.type})})]}),v&&o("input",{className:"intake-edit__header__time-input",type:"time",value:b(r.recordedAt),onChange:g,"data-testid":"intake-edit-time-input"})]}),o(Be,{items:r.items,render:w=>o(ha,{intakeItem:w,children:o(_a,{})},w.id),className:"intake-edit-item-list",dataTestId:"intake-edit-item-list"})]}),m("div",{className:"intake-edit__info-container","data-testid":"intake-edit-info-container",children:[o(wa,{}),o(Ia,{})]}),m("div",{className:"intake-edit-btns-container","data-testid":"intake-edit-btns-container",style:{backgroundColor:u},children:[o(D,{onClickFn:y,className:"intake-edit-btn",children:"clear"}),o(D,{onClickFn:_,className:"intake-edit-btn",type:"submit",children:"Save To Fav"}),o(D,{onClickFn:I,className:"intake-edit-btn btn-toggle-save-later "+me({clicked:!r.isRecorded}),children:"Save Later"}),o(D,{onClickFn:w=>C(w),className:"intake-edit-btn",type:"submit",children:"Save Intake"})]})]})};const Pa=()=>{const{dailyData:e,setOpenedTab:t,setSearchParams:n}=Q();if(!e)return null;function r(i){t(i);const s=new URLSearchParams({tab:i});n(s)}const a=[{name:"add",value:j.IntakeEdit},{name:"intakes",value:j.IntakeList,isShown:e==null?void 0:e.intakes.some(i=>i.isRecorded===!0)},{name:"unrecorded",value:j.UnRecordedIntakeList,isShown:e==null?void 0:e.intakes.some(i=>i.isRecorded===!1)},{name:"favorites",value:j.FavoriteIntake},{name:"water",value:j.Water},{name:"weight",value:j.WeightWaistInput},{name:"workouts",value:j.Workouts},{name:"query",value:j.Query}];return o("ul",{className:"day-edit__filter","data-testid":"day-edit-filter",children:a.map(i=>i.isShown===!1?null:o("li",{className:"filter__item",children:o(D,{className:"btn",onClickFn:()=>r(i.value),children:i.name})},i.value))})};var Sa=["points","className","baseLinePoints","connectNulls"];function he(){return he=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},he.apply(this,arguments)}function Ca(e,t){if(e==null)return{};var n=Oa(e,t),r,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Oa(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,i;for(i=0;i<r.length;i++)a=r[i],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function Ct(e){return Ra(e)||Ea(e)||xa(e)||Na()}function Na(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xa(e,t){if(e){if(typeof e=="string")return tt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tt(e,t)}}function Ea(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function Ra(e){if(Array.isArray(e))return tt(e)}function tt(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ot=function(t){return t&&t.x===+t.x&&t.y===+t.y},Da=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],n=[[]];return t.forEach(function(r){Ot(r)?n[n.length-1].push(r):n[n.length-1].length>0&&n.push([])}),Ot(t[0])&&n[n.length-1].push(t[0]),n[n.length-1].length<=0&&(n=n.slice(0,-1)),n},Ae=function(t,n){var r=Da(t);n&&(r=[r.reduce(function(i,s){return[].concat(Ct(i),Ct(s))},[])]);var a=r.map(function(i){return i.reduce(function(s,c,l){return"".concat(s).concat(l===0?"M":"L").concat(c.x,",").concat(c.y)},"")}).join("");return r.length===1?"".concat(a,"Z"):a},Ta=function(t,n,r){var a=Ae(t,r);return"".concat(a.slice(-1)==="Z"?a.slice(0,-1):a,"L").concat(Ae(n.reverse(),r).slice(1))},La=function(t){var n=t.points,r=t.className,a=t.baseLinePoints,i=t.connectNulls,s=Ca(t,Sa);if(!n||!n.length)return null;var c=me("recharts-polygon",r);if(a&&a.length){var l=s.stroke&&s.stroke!=="none",d=Ta(n,a,i);return N.createElement("g",{className:c},N.createElement("path",he({},$(s,!0),{fill:d.slice(-1)==="Z"?s.fill:"none",stroke:"none",d})),l?N.createElement("path",he({},$(s,!0),{fill:"none",d:Ae(n,i)})):null,l?N.createElement("path",he({},$(s,!0),{fill:"none",d:Ae(a,i)})):null)}var u=Ae(n,i);return N.createElement("path",he({},$(s,!0),{fill:u.slice(-1)==="Z"?s.fill:"none",className:c,d:u}))},Fa=Ut,ja=qt,$a=In;function Ma(e,t){return e&&e.length?Fa(e,ja(t),$a):void 0}var Ba=Ma;const Wa=Fe(Ba);var Ua=Ut,qa=An,Qa=qt;function Ga(e,t){return e&&e.length?Ua(e,Qa(t),qa):void 0}var Ka=Ga;const za=Fe(Ka);var Va=["cx","cy","angle","ticks","axisLine"],Ha=["ticks","tick","angle","tickFormatter","stroke"];function ge(e){"@babel/helpers - typeof";return ge=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ge(e)}function Pe(){return Pe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Pe.apply(this,arguments)}function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ae(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Nt(Object(n),!0).forEach(function(r){Qe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xt(e,t){if(e==null)return{};var n=Ya(e,t),r,a;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Ya(e,t){if(e==null)return{};var n={},r=Object.keys(e),a,i;for(i=0;i<r.length;i++)a=r[i],!(t.indexOf(a)>=0)&&(n[a]=e[a]);return n}function Xa(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Et(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,nn(r.key),r)}}function Za(e,t,n){return t&&Et(e.prototype,t),n&&Et(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function Ja(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&nt(e,t)}function nt(e,t){return nt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},nt(e,t)}function ei(e){var t=ri();return function(){var r=De(e),a;if(t){var i=De(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return ti(this,a)}}function ti(e,t){if(t&&(ge(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ni(e)}function ni(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ri(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function De(e){return De=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},De(e)}function Qe(e,t,n){return t=nn(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nn(e){var t=ai(e,"string");return ge(t)==="symbol"?t:String(t)}function ai(e,t){if(ge(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ge(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ge=function(e){Ja(n,e);var t=ei(n);function n(){return Xa(this,n),t.apply(this,arguments)}return Za(n,[{key:"getTickValueCoord",value:function(a){var i=a.coordinate,s=this.props,c=s.angle,l=s.cx,d=s.cy;return Z(l,d,i,c)}},{key:"getTickTextAnchor",value:function(){var a=this.props.orientation,i;switch(a){case"left":i="end";break;case"right":i="start";break;default:i="middle";break}return i}},{key:"getViewBox",value:function(){var a=this.props,i=a.cx,s=a.cy,c=a.angle,l=a.ticks,d=za(l,function(f){return f.coordinate||0}),u=Wa(l,function(f){return f.coordinate||0});return{cx:i,cy:s,startAngle:c,endAngle:c,innerRadius:u.coordinate||0,outerRadius:d.coordinate||0}}},{key:"renderAxisLine",value:function(){var a=this.props,i=a.cx,s=a.cy,c=a.angle,l=a.ticks,d=a.axisLine,u=xt(a,Va),f=l.reduce(function(g,y){return[Math.min(g[0],y.coordinate),Math.max(g[1],y.coordinate)]},[1/0,-1/0]),v=Z(i,s,f[0],c),h=Z(i,s,f[1],c),p=ae(ae(ae({},$(u)),{},{fill:"none"},$(d)),{},{x1:v.x,y1:v.y,x2:h.x,y2:h.y});return N.createElement("line",Pe({className:"recharts-polar-radius-axis-line"},p))}},{key:"renderTicks",value:function(){var a=this,i=this.props,s=i.ticks,c=i.tick,l=i.angle,d=i.tickFormatter,u=i.stroke,f=xt(i,Ha),v=this.getTickTextAnchor(),h=$(f),p=$(c),g=s.map(function(y,_){var I=a.getTickValueCoord(y),C=ae(ae(ae(ae({textAnchor:v,transform:"rotate(".concat(90-l,", ").concat(I.x,", ").concat(I.y,")")},h),{},{stroke:"none",fill:u},p),{},{index:_},I),{},{payload:y});return N.createElement(V,Pe({className:"recharts-polar-radius-axis-tick",key:"tick-".concat(_)},ct(a.props,y,_)),n.renderTickItem(c,C,d?d(y.value,_):y.value))});return N.createElement(V,{className:"recharts-polar-radius-axis-ticks"},g)}},{key:"render",value:function(){var a=this.props,i=a.ticks,s=a.axisLine,c=a.tick;return!i||!i.length?null:N.createElement(V,{className:"recharts-polar-radius-axis"},s&&this.renderAxisLine(),c&&this.renderTicks(),Qt.renderCallByParent(this.props,this.getViewBox()))}}],[{key:"renderTickItem",value:function(a,i,s){var c;return N.isValidElement(a)?c=N.cloneElement(a,i):se(a)?c=a(i):c=N.createElement(ot,Pe({},i,{className:"recharts-polar-radius-axis-tick-value"}),s),c}}]),n}(P.PureComponent);Qe(Ge,"displayName","PolarRadiusAxis");Qe(Ge,"axisType","radiusAxis");Qe(Ge,"defaultProps",{type:"number",radiusAxisId:0,cx:0,cy:0,angle:0,orientation:"right",stroke:"#ccc",axisLine:!0,tick:!0,tickCount:5,allowDataOverflow:!1,scale:"auto",allowDuplicatedCategory:!0});function ve(e){"@babel/helpers - typeof";return ve=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ve(e)}function oe(){return oe=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},oe.apply(this,arguments)}function Rt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function ie(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Rt(Object(n),!0).forEach(function(r){Ke(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Rt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ii(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Dt(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rn(r.key),r)}}function si(e,t,n){return t&&Dt(e.prototype,t),n&&Dt(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function oi(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rt(e,t)}function rt(e,t){return rt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},rt(e,t)}function ci(e){var t=di();return function(){var r=Te(e),a;if(t){var i=Te(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return li(this,a)}}function li(e,t){if(t&&(ve(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ui(e)}function ui(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function di(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Te(e){return Te=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Te(e)}function Ke(e,t,n){return t=rn(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rn(e){var t=fi(e,"string");return ve(t)==="symbol"?t:String(t)}function fi(e,t){if(ve(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ve(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var hi=Math.PI/180,Tt=1e-5,ze=function(e){oi(n,e);var t=ci(n);function n(){return ii(this,n),t.apply(this,arguments)}return si(n,[{key:"getTickLineCoord",value:function(a){var i=this.props,s=i.cx,c=i.cy,l=i.radius,d=i.orientation,u=i.tickSize,f=u||8,v=Z(s,c,l,a.coordinate),h=Z(s,c,l+(d==="inner"?-1:1)*f,a.coordinate);return{x1:v.x,y1:v.y,x2:h.x,y2:h.y}}},{key:"getTickTextAnchor",value:function(a){var i=this.props.orientation,s=Math.cos(-a.coordinate*hi),c;return s>Tt?c=i==="outer"?"start":"end":s<-Tt?c=i==="outer"?"end":"start":c="middle",c}},{key:"renderAxisLine",value:function(){var a=this.props,i=a.cx,s=a.cy,c=a.radius,l=a.axisLine,d=a.axisLineType,u=ie(ie({},$(this.props)),{},{fill:"none"},$(l));if(d==="circle")return N.createElement(Pn,oe({className:"recharts-polar-angle-axis-line"},u,{cx:i,cy:s,r:c}));var f=this.props.ticks,v=f.map(function(h){return Z(i,s,c,h.coordinate)});return N.createElement(La,oe({className:"recharts-polar-angle-axis-line"},u,{points:v}))}},{key:"renderTicks",value:function(){var a=this,i=this.props,s=i.ticks,c=i.tick,l=i.tickLine,d=i.tickFormatter,u=i.stroke,f=$(this.props),v=$(c),h=ie(ie({},f),{},{fill:"none"},$(l)),p=s.map(function(g,y){var _=a.getTickLineCoord(g),I=a.getTickTextAnchor(g),C=ie(ie(ie({textAnchor:I},f),{},{stroke:"none",fill:u},v),{},{index:y,payload:g,x:_.x2,y:_.y2});return N.createElement(V,oe({className:"recharts-polar-angle-axis-tick",key:"tick-".concat(y)},ct(a.props,g,y)),l&&N.createElement("line",oe({className:"recharts-polar-angle-axis-tick-line"},h,_)),c&&n.renderTickItem(c,C,d?d(g.value,y):g.value))});return N.createElement(V,{className:"recharts-polar-angle-axis-ticks"},p)}},{key:"render",value:function(){var a=this.props,i=a.ticks,s=a.radius,c=a.axisLine;return s<=0||!i||!i.length?null:N.createElement(V,{className:"recharts-polar-angle-axis"},c&&this.renderAxisLine(),this.renderTicks())}}],[{key:"renderTickItem",value:function(a,i,s){var c;return N.isValidElement(a)?c=N.cloneElement(a,i):se(a)?c=a(i):c=N.createElement(ot,oe({},i,{className:"recharts-polar-angle-axis-tick-value"}),s),c}}]),n}(P.PureComponent);Ke(ze,"displayName","PolarAngleAxis");Ke(ze,"axisType","angleAxis");Ke(ze,"defaultProps",{type:"category",angleAxisId:0,scale:"auto",cx:0,cy:0,orientation:"outer",axisLine:!0,tickLine:!0,tickSize:8,tick:!0,hide:!1,allowDuplicatedCategory:!0});var pi=Sn,mi=pi(Object.getPrototypeOf,Object),gi=mi,vi=Cn,yi=gi,ki=On,bi="[object Object]",_i=Function.prototype,wi=Object.prototype,an=_i.toString,Ii=wi.hasOwnProperty,Ai=an.call(Object);function Pi(e){if(!ki(e)||vi(e)!=bi)return!1;var t=yi(e);if(t===null)return!0;var n=Ii.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&an.call(n)==Ai}var Si=Pi;const Ci=Fe(Si);function ye(e){"@babel/helpers - typeof";return ye=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(e)}function ce(){return ce=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ce.apply(this,arguments)}function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?Lt(Object(n),!0).forEach(function(r){z(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Oi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ft(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,sn(r.key),r)}}function Ni(e,t,n){return t&&Ft(e.prototype,t),n&&Ft(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function xi(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&at(e,t)}function at(e,t){return at=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,a){return r.__proto__=a,r},at(e,t)}function Ei(e){var t=Di();return function(){var r=Le(e),a;if(t){var i=Le(this).constructor;a=Reflect.construct(r,arguments,i)}else a=r.apply(this,arguments);return Ri(this,a)}}function Ri(e,t){if(t&&(ye(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return de(e)}function de(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Di(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Le(e){return Le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Le(e)}function z(e,t,n){return t=sn(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sn(e){var t=Ti(e,"string");return ye(t)==="symbol"?t:String(t)}function Ti(e,t){if(ye(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ye(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var H=function(e){xi(n,e);var t=Ei(n);function n(r){var a;return Oi(this,n),a=t.call(this,r),z(de(a),"pieRef",null),z(de(a),"sectorRefs",[]),z(de(a),"id",xn("recharts-pie-")),z(de(a),"handleAnimationEnd",function(){var i=a.props.onAnimationEnd;a.setState({isAnimationFinished:!0}),se(i)&&i()}),z(de(a),"handleAnimationStart",function(){var i=a.props.onAnimationStart;a.setState({isAnimationFinished:!1}),se(i)&&i()}),a.state={isAnimationFinished:!r.isAnimationActive,prevIsAnimationActive:r.isAnimationActive,prevAnimationId:r.animationId,sectorToFocus:0},a}return Ni(n,[{key:"isActiveIndex",value:function(a){var i=this.props.activeIndex;return Array.isArray(i)?i.indexOf(a)!==-1:a===i}},{key:"hasActiveIndex",value:function(){var a=this.props.activeIndex;return Array.isArray(a)?a.length!==0:a||a===0}},{key:"renderLabels",value:function(a){var i=this.props.isAnimationActive;if(i&&!this.state.isAnimationFinished)return null;var s=this.props,c=s.label,l=s.labelLine,d=s.dataKey,u=s.valueKey,f=$(this.props),v=$(c),h=$(l),p=c&&c.offsetRadius||20,g=a.map(function(y,_){var I=(y.startAngle+y.endAngle)/2,C=Z(y.cx,y.cy,y.outerRadius+p,I),b=L(L(L(L({},f),y),{},{stroke:"none"},v),{},{index:_,textAnchor:n.getTextAnchor(C.x,y.cx)},C),w=L(L(L(L({},f),y),{},{fill:"none",stroke:y.fill},h),{},{index:_,points:[Z(y.cx,y.cy,y.outerRadius,I),C],key:"line"}),k=d;return pe(d)&&pe(u)?k="value":pe(d)&&(k=u),N.createElement(V,{key:"label-".concat(_)},l&&n.renderLabelLineItem(l,w),n.renderLabelItem(c,b,ue(y,k)))});return N.createElement(V,{className:"recharts-pie-labels"},g)}},{key:"renderSectorsStatically",value:function(a){var i=this,s=this.props,c=s.activeShape,l=s.blendStroke,d=s.inactiveShape;return a.map(function(u,f){var v=d&&i.hasActiveIndex()?d:null,h=i.isActiveIndex(f)?c:v,p=L(L({},u),{},{stroke:l?u.fill:u.stroke});return N.createElement(V,ce({ref:function(y){y&&!i.sectorRefs.includes(y)&&i.sectorRefs.push(y)},tabIndex:-1,className:"recharts-pie-sector"},ct(i.props,u,f),{key:"sector-".concat(f)}),n.renderSectorItem(h,p))})}},{key:"renderSectorsWithAnimation",value:function(){var a=this,i=this.props,s=i.sectors,c=i.isAnimationActive,l=i.animationBegin,d=i.animationDuration,u=i.animationEasing,f=i.animationId,v=this.state,h=v.prevSectors,p=v.prevIsAnimationActive;return N.createElement(Rn,{begin:l,duration:d,isActive:c,easing:u,from:{t:0},to:{t:1},key:"pie-".concat(f,"-").concat(p),onAnimationStart:this.handleAnimationStart,onAnimationEnd:this.handleAnimationEnd},function(g){var y=g.t,_=[],I=s&&s[0],C=I.startAngle;return s.forEach(function(b,w){var k=h&&h[w],x=w>0?Dn(b,"paddingAngle",0):0;if(k){var O=mt(k.endAngle-k.startAngle,b.endAngle-b.startAngle),S=L(L({},b),{},{startAngle:C+x,endAngle:C+O(y)+x});_.push(S),C=S.endAngle}else{var T=b.endAngle,W=b.startAngle,K=mt(0,T-W),M=K(y),U=L(L({},b),{},{startAngle:C+x,endAngle:C+M+x});_.push(U),C=U.endAngle}}),N.createElement(V,null,a.renderSectorsStatically(_))})}},{key:"attachKeyboardHandlers",value:function(a){var i=this;a.onkeydown=function(s){if(!s.altKey)switch(s.key){case"ArrowLeft":{var c=++i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[c].focus(),i.setState({sectorToFocus:c});break}case"ArrowRight":{var l=--i.state.sectorToFocus<0?i.sectorRefs.length-1:i.state.sectorToFocus%i.sectorRefs.length;i.sectorRefs[l].focus(),i.setState({sectorToFocus:l});break}case"Escape":{i.sectorRefs[i.state.sectorToFocus].blur(),i.setState({sectorToFocus:0});break}}}}},{key:"renderSectors",value:function(){var a=this.props,i=a.sectors,s=a.isAnimationActive,c=this.state.prevSectors;return s&&i&&i.length&&(!c||!Tn(c,i))?this.renderSectorsWithAnimation():this.renderSectorsStatically(i)}},{key:"componentDidMount",value:function(){this.pieRef&&this.attachKeyboardHandlers(this.pieRef)}},{key:"render",value:function(){var a=this,i=this.props,s=i.hide,c=i.sectors,l=i.className,d=i.label,u=i.cx,f=i.cy,v=i.innerRadius,h=i.outerRadius,p=i.isAnimationActive,g=this.state.isAnimationFinished;if(s||!c||!c.length||!fe(u)||!fe(f)||!fe(v)||!fe(h))return null;var y=me("recharts-pie",l);return N.createElement(V,{tabIndex:this.props.rootTabIndex,className:y,ref:function(I){a.pieRef=I}},this.renderSectors(),d&&this.renderLabels(c),Qt.renderCallByParent(this.props,null,!1),(!p||g)&&Ln.renderCallByParent(this.props,c,!1))}}],[{key:"getDerivedStateFromProps",value:function(a,i){return i.prevIsAnimationActive!==a.isAnimationActive?{prevIsAnimationActive:a.isAnimationActive,prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:[],isAnimationFinished:!0}:a.isAnimationActive&&a.animationId!==i.prevAnimationId?{prevAnimationId:a.animationId,curSectors:a.sectors,prevSectors:i.curSectors,isAnimationFinished:!0}:a.sectors!==i.curSectors?{curSectors:a.sectors,isAnimationFinished:!0}:null}},{key:"getTextAnchor",value:function(a,i){return a>i?"start":a<i?"end":"middle"}},{key:"renderLabelLineItem",value:function(a,i){return N.isValidElement(a)?N.cloneElement(a,i):se(a)?a(i):N.createElement(En,ce({},i,{type:"linear",className:"recharts-pie-label-line"}))}},{key:"renderLabelItem",value:function(a,i,s){if(N.isValidElement(a))return N.cloneElement(a,i);var c=s;return se(a)&&(c=a(i),N.isValidElement(c))?c:N.createElement(ot,ce({},i,{alignmentBaseline:"middle",className:"recharts-pie-label-text"}),c)}},{key:"renderSectorItem",value:function(a,i){return N.isValidElement(a)?N.cloneElement(a,i):se(a)?a(i):Ci(a)?N.createElement(pt,ce({tabIndex:-1},i,a)):N.createElement(pt,ce({tabIndex:-1},i))}}]),n}(P.PureComponent);z(H,"displayName","Pie");z(H,"defaultProps",{stroke:"#fff",fill:"#808080",legendType:"rect",cx:"50%",cy:"50%",startAngle:0,endAngle:360,innerRadius:0,outerRadius:"80%",paddingAngle:0,labelLine:!0,hide:!1,minAngle:0,isAnimationActive:!Nn.isSsr,animationBegin:400,animationDuration:1500,animationEasing:"ease",nameKey:"name",blendStroke:!1,rootTabIndex:0});z(H,"parseDeltaAngle",function(e,t){var n=Ne(t-e),r=Math.min(Math.abs(t-e),360);return n*r});z(H,"getRealPieData",function(e){var t=e.props,n=t.data,r=t.children,a=$(e.props),i=Fn(r,Gt);return n&&n.length?n.map(function(s,c){return L(L(L({payload:s},a),s),i&&i[c]&&i[c].props)}):i&&i.length?i.map(function(s){return L(L({},a),s.props)}):[]});z(H,"parseCoordinateOfPie",function(e,t){var n=t.top,r=t.left,a=t.width,i=t.height,s=jn(a,i),c=r+Ce(e.props.cx,a,a/2),l=n+Ce(e.props.cy,i,i/2),d=Ce(e.props.innerRadius,s,0),u=Ce(e.props.outerRadius,s,s*.8),f=e.props.maxRadius||Math.sqrt(a*a+i*i)/2;return{cx:c,cy:l,innerRadius:d,outerRadius:u,maxRadius:f}});z(H,"getComposedData",function(e){var t=e.item,n=e.offset,r=H.getRealPieData(t);if(!r||!r.length)return null;var a=t.props,i=a.cornerRadius,s=a.startAngle,c=a.endAngle,l=a.paddingAngle,d=a.dataKey,u=a.nameKey,f=a.valueKey,v=a.tooltipType,h=Math.abs(t.props.minAngle),p=H.parseCoordinateOfPie(t,n),g=H.parseDeltaAngle(s,c),y=Math.abs(g),_=d;pe(d)&&pe(f)?(gt(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),_="value"):pe(d)&&(gt(!1,`Use "dataKey" to specify the value of pie,
      the props "valueKey" will be deprecated in 1.1.0`),_=f);var I=r.filter(function(O){return ue(O,_,0)!==0}).length,C=(y>=360?I:I-1)*l,b=y-I*h-C,w=r.reduce(function(O,S){var T=ue(S,_,0);return O+(fe(T)?T:0)},0),k;if(w>0){var x;k=r.map(function(O,S){var T=ue(O,_,0),W=ue(O,u,S),K=(fe(T)?T:0)/w,M;S?M=x.endAngle+Ne(g)*l*(T!==0?1:0):M=s;var U=M+Ne(g)*((T!==0?h:0)+K*b),Y=(M+U)/2,ee=(p.innerRadius+p.outerRadius)/2,A=[{name:W,value:T,payload:O,dataKey:_,type:v}],E=Z(p.cx,p.cy,ee,Y);return x=L(L(L({percent:K,cornerRadius:i,name:W,tooltipPayload:A,midAngle:Y,middleRadius:ee,tooltipPosition:E},O),p),{},{value:ue(O,_),startAngle:M,endAngle:U,payload:O,paddingAngle:Ne(g)*l}),x})}return L(L({},p),{},{sectors:k,data:r})});var Li=$n({chartName:"PieChart",GraphicalChild:H,validateTooltipEventTypes:["item"],defaultTooltipEventType:"item",legendContent:"children",axisComponents:[{axisType:"angleAxis",AxisComp:ze},{axisType:"radiusAxis",AxisComp:Ge}],formatAxisMap:Mn,defaultProps:{layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"}});const Fi=({intakes:e,remainingCalories:t})=>{const n=[...e.map(r=>({name:r.items.reduce((a,i,s,c)=>c.length===1?i.name:s===0?a+`${i.name}, `:s===c.length-1?a+`and ${i.name}`:a+` ${i.name}, `,""),value:r.items.reduce((a,i)=>a+i.calories,0)})),{name:"remaining",value:t}];return t<=0&&n.pop(),m(Li,{width:250,height:250,children:[o(H,{dataKey:"value",isAnimationActive:!1,data:n,cx:125,cy:125,innerRadius:80,outerRadius:110,children:n.map((r,a)=>{const i=r.name==="remaining"?"#a7a7a7":ht[a%ht.length];return o(Gt,{fill:i},`cell-${a}`)})}),o(Bn,{})]})},ji=()=>{const{dailyData:e,recordedIntakes:t,calConsumedPct:n,calRemainingPct:r,remainingCalories:a,consumedCalories:i,estimatedKGChange:s}=Q();if(!e)return null;const{date:c}=e,l=new Intl.DateTimeFormat("en-GB",{weekday:"long",month:"numeric",day:"numeric",year:"numeric"}).format(new Date(c)),d=a>0?"remaining":"over your limit";return m("header",{className:"day-edit__header","data-testid":"day-edit-header",children:[o("div",{className:"day-edit__header__date-container",children:o("h2",{className:"day-edit__header__date","data-testid":"day-edit-header-date",children:l})}),o(Fi,{intakes:t,remainingCalories:a}),m("div",{className:"day-edit__header__titles",children:[m("p",{className:"day-edit__header__titles__title","data-testid":"day-edit-header-remaining-calories",children:[m("strong",{children:[Math.abs(a)," "]}),"calories ",d]}),o("hr",{}),i>0&&m(ke,{children:[m("p",{className:"day-edit__header__titles__title","data-testid":"day-edit-header-consumed-calories",children:[o("strong",{children:Math.round(i)})," calories consumed"]}),o("hr",{})]}),m("div",{className:"day-edit__header__percentages-container",children:[m("div",{className:"day-edit__header__percentage","data-testid":"day-edit-header-consumed-percentage",children:[o("p",{className:"day-edit__header__percentage__title",children:"consumed:"}),m("p",{className:"day-edit__header__percentage__value",children:[n,"%"]})]}),m("div",{className:"day-edit__header__percentage","data-testid":"day-edit-header-remaining-percentage",children:[o("p",{className:"day-edit__header__percentage__title",children:"remaining:"}),m("p",{className:"day-edit__header__percentage__value",children:[r,"%"]})]})]}),o("hr",{}),m("p",{className:"day-edit__header__titles__title","data-testid":"day-edit-header-estimated-kg-change",children:["estimated to ",s>0?"gain":"lose",m("strong",{children:[" ",Math.abs(s)]})," kg"]}),o("hr",{})]})]})};const $i=({mode:e,zIndex:t})=>o("div",{className:`main-screen ${e||""}`,style:{zIndex:t},"data-testid":"main-screen"});const Mi=({isModalAbove:e,isFullScreen:t=!1})=>{const n="tippy"+(e?" down":" up")+(t?" full-screen":"");return o("div",{className:n,"data-testid":"tippy"})};function on(e,t){var c;const n=(c=e.current)==null?void 0:c.getBoundingClientRect();if(!n)return;const a=window.innerHeight-n.top<t,i={top:n.bottom+n.height/2+window.scrollY},s={bottom:window.innerHeight-n.top+n.height/2};return{isModalAbove:a,position:{...a?s:i,left:n.left+n.width/2+window.scrollX},rect:n}}const Se=P.createContext(void 0),q=({children:e,externalStateControl:t,onClose:n,onOpen:r,onAfterClose:a})=>{const[i,s]=P.useState(""),[c,l]=P.useState(null),[d,u]=P.useState(null),[f,v]=P.useState(!1),h=()=>{if(n==null||n(),t){t.setOpenedModalName(""),a==null||a();return}s(""),a==null||a()},p=I=>{if(r==null||r(),t){t.setOpenedModalName(I);return}s(I)},{debouncedFunc:g,cancel:y}=it(()=>{h()},500),_={openedModalName:(t==null?void 0:t.openedModalName)||i,close:h,open:p,position:c,setPosition:l,isModalAbove:f,setIsModalAbove:v,modalHoverGuardZone:d,setModalHoverGuardZone:u,debouncedClose:g,cancelDebouncedClose:y};return o(Se.Provider,{value:_,children:e})},Bi=({children:e,modalName:t,setPositionByRef:n=!1,modalHeight:r=0,externalControlFunc:a})=>{const{open:i,setPosition:s,setIsModalAbove:c}=P.useContext(Se),l=P.useRef(null),d=P.useCallback(()=>{const f=on(l,r),{isModalAbove:v,position:h}=f;c(v),s(h)},[r,c,s]),u=()=>{if(n&&d(),a)return a();i(t)};return P.useEffect(()=>{if(!n)return;const f=["wheel","scroll","resize"];return f.forEach(v=>{window.addEventListener(v,d)}),()=>{f.forEach(v=>{window.removeEventListener(v,d)})}},[n,d]),P.cloneElement(e,{onClick:u,ref:l})},Wi=({children:e,onClickFn:t})=>{const{close:n}=P.useContext(Se);return P.cloneElement(e,{onClick:()=>{t==null||t(),n()}})},Ui=({children:e,modalName:t,modalHeight:n=0})=>{const{open:r,setPosition:a,setIsModalAbove:i,setModalHoverGuardZone:s,debouncedClose:c,cancelDebouncedClose:l}=P.useContext(Se),d=P.useRef(null),{debouncedFunc:u,cancel:f}=it(v,500);function v(){const g=on(d,n);g&&(a(g.position),i(g.isModalAbove),s({height:g.rect.height,width:g.rect.width}),r(t))}function h(){l(),u()}function p(){f(),c()}return o("div",{className:"modal-hover-open",ref:d,onMouseEnter:h,onMouseLeave:p,children:e})},qi=({children:e,name:t,className:n,mainScreenMode:r="transparent",mainScreenZIndex:a=1e3,elementId:i="app",includeTippy:s=!1,style:c={},hoverControl:l=!1})=>{const{openedModalName:d,open:u,close:f,position:v,isModalAbove:h,modalHoverGuardZone:p,debouncedClose:g,cancelDebouncedClose:y}=P.useContext(Se),{outsideClickRef:_}=Wn(f);function I(){y(),u(t)}function C(){g()}return t!==d?null:pn.createPortal(m(ke,{children:[!l&&o($i,{mode:r,zIndex:a}),m("section",{className:`modal ${n||t}`,style:{...c,zIndex:a+1,...v},ref:l?void 0:_,onMouseEnter:()=>l&&I(),onMouseLeave:()=>l&&C(),"data-testid":"modal-window",children:[s&&o(Mi,{isModalAbove:!!h}),e,l&&p&&o("div",{className:"modal-hover-guard-zone",style:{top:h?"100%":`-${p.height/2}px`,height:`${p.height/2}px`||"10%",width:`${p.width}px`||"10%"}})]})]}),document.getElementById(i))};q.OpenBtn=Bi;q.Window=qi;q.CloseBtn=Wi;q.ModalHoverOpen=Ui;function Qi(){const e=$e(),{mutate:t,isLoading:n}=Me({mutationFn:async r=>qe.removeUserFavoriteIntake(r),onSuccess:()=>{e.invalidateQueries(["favoriteIntakes"])}});return{removeFavoriteIntake:t,isLoading:n}}const cn=({intake:e})=>{const{dailyData:t,openedTab:n,setOpenedTab:r,setIntake:a,updateDailyData:i,setCurrIntakeItemId:s}=Q(),{addFavoriteIntake:c,isLoading:l}=en(),{removeFavoriteIntake:d}=Qi(),u=n===j.IntakeList,f=n===j.FavoriteIntake,v=!u||f,h=we.getTotalCalories(e),p=f?e.name||e.items.map(b=>b.name).join(", "):null;function g(b){if(f)return d(b);if(!t)return;const w={...t};w.intakes=t.intakes.filter(k=>k.id!==b),i(w)}function y(b){if(!t)return;const w={...b};a(w),r(j.IntakeEdit),s(b.items[0].id)}function _(b){if(!t)return;const w={...b};w.id=Ee(),w.recordedAt=new Date,i({...t,intakes:[...t.intakes,w]})}function I(b){if(!t)return;const w={...t};f?w.intakes=[...t.intakes,{...e,id:Ee(),isRecorded:!0,recordedAt:new Date}]:w.intakes=t.intakes.map(k=>(k.id!==b||(k.isRecorded=!0,k.recordedAt=new Date),k)),i(w)}function C(b){c(b)}return l?o(J,{withContainer:!0,containerSize:{height:"50px"}}):m("section",{className:"intake-preview","data-testid":"intake-preview",children:[p&&o("h2",{className:"intake-preview__title","data-testid":"intake-title",children:p}),o(Be,{items:e.items,className:"intake-preview__item-list",render:b=>o("li",{className:"intake-preview__item-list__item","data-testid":"intake-preview-item",children:`${b.name} - ${b.quantity} ${b.unit} - calories: ${Math.round(b.calories)}`},b.id)}),m("p",{className:"intake-preview__total-calories",children:["total calories: ",h]}),m("div",{id:"intake-preview-btns-container",className:"intake-preview__btns-container",children:[m(q,{children:[o(q.OpenBtn,{modalName:"delete-intake",children:o("button",{className:"btn",children:"Delete"})}),m(q.Window,{name:"delete-intake",elementId:"intake-preview-btns-container",className:"delete-intake-modal",children:[o("h2",{children:"Are you sure you want to delete this intake?"}),o(q.CloseBtn,{onClickFn:()=>g(e.id),children:o("button",{className:"btn delete-btn",children:"Delete"})}),o(q.CloseBtn,{children:o("button",{className:"btn",children:"Cancel"})})]})]}),(f||u)&&o(D,{className:"btn",onClickFn:()=>y(e),children:"Edit"}),u&&o(D,{className:"btn",onClickFn:()=>_(e),children:"duplicate"}),v&&o(D,{className:"btn",onClickFn:()=>I(e.id),children:"Save"}),!f&&o(D,{className:"btn",onClickFn:()=>C(e),children:"add to fav"})]})]})};const Gi=()=>{const{dailyData:e,unrecordedIntakes:t,recordedIntakes:n,openedTab:r,isLoadingUpdate:a}=Q();if(!e)return null;const i=r===j.IntakeList,c=(i?n:t).sort((d,u)=>!d.recordedAt||!u.recordedAt?0:new Date(d.recordedAt).getTime()-new Date(u.recordedAt).getTime()),l=we.getTotalCaloriesFromDailyData({dailyData:e,isRecorded:i});return m(ke,{children:[m("header",{className:"intake-list__header","data-testid":"intake-list-header",children:[m("h3",{className:"intake-list__header__title",children:[i?"Recorded":"Unrecorded"," Intakes"]}),m("h4",{className:"intake-list__header__total-calories",children:["total calories: ",l]})]}),a&&o(J,{}),!a&&o(Be,{className:"intake-list",items:c,render:(d,u)=>{const f=d.recordedAt?`- ${mn(d.recordedAt)}`:"";return m("li",{className:"intake-list-item",children:[m("h5",{className:"intake-list-item__title",children:["Intake ",u+1,"# ",f]}),o(cn,{intake:d})]},d.id)}})]})};const Ki=()=>{const{dailyData:e,isLoading:t,updateDailyData:n,setOpenedTab:r}=Q(),{loggedInUser:a}=je(),{userDailyStats:i}=gn(),{control:s,handleSubmit:c}=Kt({defaultValues:{weight:"",waist:""}}),[l,d]=P.useState(!1);function u(){e&&(n({...e,isWeightWaistIgnored:!0}),r(j.IntakeEdit))}function f(h){if(!e||!a)return;const{weightGoal:p}=a.weightLossGoal;if(Number(h.weight)<=p)return alert("Weight can't be greater than your goal");n({...e,weight:Number(h.weight),waist:Number(h.waist)})}if(P.useEffect(()=>{!a||!i||d(vn.isReachedGoalWeight({loggedInUser:a,userDailyStats:i}))},[a,i]),!e)return null;const v=!e.weight&&!e.waist&&!t;return t?o(J,{withContainer:!0,containerSize:{height:"75px"}}):v?m("form",{className:"weight-waist-form","data-testid":"weight-waist-form",onSubmit:c(f),children:[o(Ie,{control:s,name:"weight",render:({field:h})=>o("input",{...h,type:"number",className:"weight-waist-form__input",placeholder:"Enter your weight",required:!0})}),o(Ie,{control:s,name:"waist",render:({field:h})=>o("input",{...h,type:"number",className:"weight-waist-form__input",placeholder:"Enter your waist size",required:!0})}),m("div",{className:"weight-waist-form__btns-container",children:[o(D,{className:"btn",type:"submit",children:"update"}),!e.isWeightWaistIgnored&&o(D,{className:"btn",onClickFn:u,children:"dissmis"})]})]}):m(ke,{children:[m("div",{className:"weight-waist-details","data-testid":"weight-waist-details",children:[o("p",{className:"weight-waist-details__title",children:"weight:"}),m("p",{className:"weight-waist-details__text",children:[e.weight," kg"]}),o("p",{className:"weight-waist-details__title",children:"waist:"}),m("p",{className:"weight-waist-details__text",children:[e.waist," cm"]})]}),l&&o(yn,{})]})},dt="nutrition";async function zi(e){const t=await te.get(`${dt}/chatGPT?prompt=${e}`);return le(t)}async function Vi(e){const t=await te.get(`${dt}/ninja?query=${e}`);return le(t)}async function Hi(e){const t=await te.get(`${dt}/usda?query=${e}`);return le(t)}const Ye={queryChatGPT:zi,queryNinja:Vi,queryUSDA:Hi};const Yi=()=>o("div",{className:"dot-loader","data-testid":"dot-loader"}),Xe=({queryState:{type:e,status:t,error:n,response:r}})=>t==="loading"?o(Yi,{}):t==="error"&&n?o(lt,{msg:n}):t==="success"?m("section",{"data-testid":"nutrition-query-response-handler",children:[e==="chatGPT"&&o("p",{children:r}),e==="ninjaAPI"&&o("ul",{className:"nutrition-query__results__item__list","data-testid":"nutrition-query-response-ninja-api-response",children:r.map((a,i)=>o("li",{children:Object.entries(a).map(([s,c])=>s==="name"?o("strong",{children:a.name},s):m("div",{children:[m("span",{children:[s,":"]}),o("span",{children:c})]},s))},i))}),e==="usdaAPI"&&o("ul",{className:"nutrition-query__results__item__list","data-testid":"nutrition-query-response-usda-api-response",children:r.map((a,i)=>{const s=Object.entries(a);return o("li",{children:s.map(([c,l])=>c==="description"?o("strong",{children:a.description},c):m("div",{children:[m("span",{children:[c,":"]}),o("span",{children:l})]},c))},i)})})]}):null;const Xi=()=>{const{chatGPTQuery:e,setChatGPTQuery:t,ninjaAPIQuery:n,setNinjaAPIQuery:r,USDAAPIQuery:a,setUSDAAPIQuery:i}=Q(),{control:s,handleSubmit:c}=Kt({defaultValues:{chatGPTQuery:"",ninjaAPIQuery:"",USDAAPIQuery:""}});async function l(d){if(d.chatGPTQuery)try{t({...e,status:"loading"});const u=await Ye.queryChatGPT(d.chatGPTQuery);t({...e,status:"success",response:u})}catch(u){t({...e,status:"error",error:u instanceof Error?u.message:"An unknown error occurred."})}if(d.ninjaAPIQuery)try{r({...n,status:"loading"});const u=await Ye.queryNinja(d.ninjaAPIQuery);r({...n,status:"success",response:u})}catch(u){r({...n,status:"error",error:u instanceof Error?u.message:"An unknown error occurred."})}if(d.USDAAPIQuery)try{i({...a,status:"loading"});const u=await Ye.queryUSDA(d.USDAAPIQuery);i({...a,status:"success",response:u})}catch(u){i({...a,status:"error",error:u instanceof Error?u.message:"An unknown error occurred."})}}return m("section",{className:"nutrition-query","data-testid":"nutrition-query",children:[m("section",{className:"nutrition-query__desc",children:[o("p",{children:"This tab let's you query the APIs used by the app."}),m("ul",{children:[o("li",{children:"The first one is a chatbot that generates a response based on the input"}),o("li",{children:"The second one is a food database."}),o("li",{children:"The third one is a nutrition database."})]})]}),m("form",{className:"nutrition-query__form",autoComplete:"off","data-testid":"nutrition-query-form",children:[m("label",{htmlFor:"chatGPTQuery",children:[o("span",{children:"Chat GPT"}),o(qn,{})]}),o(Ie,{name:"chatGPTQuery",control:s,render:({field:d})=>o("textarea",{id:"chatGPTQuery",...d})}),m("label",{htmlFor:"ninjaAPIQuery",children:[o("span",{children:"Ninja API"}),o(kn,{})]}),o(Ie,{name:"ninjaAPIQuery",control:s,render:({field:d})=>o("input",{id:"ninjaAPIQuery",...d})}),m("label",{htmlFor:"USDAAPIQuery",children:[o("span",{children:"USDA API"}),o(Qn,{})]}),o(Ie,{name:"USDAAPIQuery",control:s,render:({field:d})=>o("input",{id:"USDAAPIQuery",...d})}),o(D,{onClickFn:c(l),children:"query"})]}),m("div",{className:"nutrition-query__results",children:[e.status!=="idle"&&m("div",{className:"nutrition-query__results__item",children:[o("h1",{children:"Chat GPT Response:"}),o(Xe,{queryState:e})]}),n.status!=="idle"&&m("div",{className:"nutrition-query__results__item",children:[o("h1",{children:"Ninja API Response:"}),o(Xe,{queryState:n})]}),a.status!=="idle"&&m("div",{className:"nutrition-query__results__item",children:[o("h1",{children:"USDA API Response:"}),o(Xe,{queryState:a})]})]})]})};const jt=[{name:"cup (250ml)",value:250},{name:"bottle (750ml)",value:750},{name:"1.5 Liter",value:1500}],Zi=()=>{const{dailyData:e,updateDailyData:t,recommendedWaterIntake:n}=Q(),[r,a]=P.useState("");function i(c){a(c.name)}function s(){if(!e)return;const c=jt.find(u=>u.name===r);if(!c)return Ze.error("Please select a value");const l=G.getDefaultIntake();l.type="drink",l.items[0].quantity=c.value,l.items[0].unit=We.MILLILITER,l.items[0].name="water";const d=[...e.intakes,l];t({...e,intakes:d})}return m("section",{className:"water-edit","data-testid":"water-edit",children:[o("h2",{className:"water-edit__title",children:`Recommended water intake: ${n} ml`}),o("div",{className:"water-edit__btns-values-container",children:jt.map(c=>o(D,{className:me("btn",{"btn-selected":r===c.name}),onClickFn:()=>i(c),children:c.name},c.value))}),o(D,{className:"water-edit__btn-save",onClickFn:s,children:"Save"})]})};const Ji=()=>{const{favoriteIntakes:e,isErrorFavoriteIntakes:t,isLoadingFavoriteIntakes:n,isSuccessFavoriteIntakes:r,isEmptyFavoriteIntakes:a}=Q(),{updateFavoriteIntake:i}=tn(),[s,c]=P.useState($t(e));function l(f,v){return{background:f?"var(--color-warning)":"",transform:f?"rotate(7deg)":"",...v}}function d(f){if(!f.destination||!s)return;const h=((g,y,_)=>{const I=Array.from(g),[C]=I.splice(y,1);return I.splice(_,0,C),I})(s,f.source.index,f.destination.index);c(h);const p={...h[f.destination.index]};p.sortOrder=f.destination.index,i(p)}function u(f){const{value:v}=f.target;if(!e)return c($t(e));const h=e==null?void 0:e.filter(p=>p.name.toLowerCase().includes(v.toLowerCase())||p.items.some(g=>g.name.toLowerCase().includes(v.toLowerCase())));c(h)}return m("section",{className:"day-edit__favorite-intakes","data-testid":"day-edit-favorite-intakes",children:[o("input",{type:"text",className:"day-edit__favorite-intakes__input",autoComplete:"off",placeholder:"Search...",onChange:u}),n&&o(J,{}),r&&!a&&o(Kn,{onDragEnd:d,children:o(zn,{droppableId:"droppable",children:f=>m("ul",{className:"list day-edit__favorite-intakes__list",...f.droppableProps,ref:f.innerRef,children:[s.map((v,h)=>o(Vn,{draggableId:v.id,index:h,children:(p,g)=>o("li",{ref:p.innerRef,...p.draggableProps,...p.dragHandleProps,style:l(g.isDragging,p.draggableProps.style),className:"day-edit__favorite-intakes__list__item",children:o(cn,{intake:v})})},v.id)),f.placeholder]})})}),r&&a&&o(Hn,{entityName:"favorite intake"}),t&&o(lt,{msg:"Couldn't get favorite intake. Please try again later."})]})};function $t(e){return e?e==null?void 0:e.sort((t,n)=>t.sortOrder-n.sortOrder):[]}const es=()=>{const{loggedInUser:e}=je(),{dailyData:t}=Q(),{updateDailyData:n,isLoading:r}=Bt(),[a,i]=P.useState(null);function s(){const h=bn.getDefaultWorkout();i(h)}function c(h){if(!a)return;const p={...a,type:h};i(p)}function l(h){if(!a)return;const p=Number(h.target.value),g={...a,durationInMin:p};i(g)}function d(h){if(!a)return;const p=h.target.value,g={...a,description:p};i(g)}function u(h){if(!a)return;const p={...a,split:h};i(p)}function f(){i(null)}function v(){if(!a||!t||!e)return;const{id:h,...p}=a,g={...p,userId:e.id},y=[...t.workouts,g],_={...t,workouts:y};n(_),i(null)}return t?r?o(J,{}):m("section",{className:"day-edit__day-workouts",children:[o(D,{className:"day-edit__day-workouts__btn",onClickFn:s,children:"add quick workout"}),a&&m("form",{className:"day-edit__day-workouts__quick-workout-form",children:[o(Un,{workout:a,handleTypeSelectChange:c,handleDurationInputChange:l,handleDescInputChange:d,handleSplitSelectChange:u}),m("div",{className:"day-edit__day-workouts__quick-workout-form__btns-container",children:[o(D,{onClickFn:f,children:"cancel"}),o(D,{onClickFn:v,children:"save"})]})]}),o(Be,{className:"day-edit__day-workouts__workouts-list",items:t.workouts,render:h=>o(Gn,{workout:h,isDayEdit:!0},h.id)})]}):null},ts=()=>{const{dailyData:e,isLoading:t,isSuccess:n,isError:r,isLoadingUpdate:a,openedTab:i}=Q(),{backgroundColor:s}=st(),c=n&&e&&!a&&!t,l=t||a,d=i===j.IntakeList||i===j.UnRecordedIntakeList;return m("section",{className:"day-edit",style:{backgroundColor:s,border:`5px solid ${s}`},"data-testid":"day-edit",children:[l&&o(J,{}),r&&o(lt,{}),c&&m(ke,{children:[o(ji,{}),o(Pa,{}),i===j.WeightWaistInput&&o(Ki,{}),i===j.IntakeEdit&&o(Aa,{}),i===j.Workouts&&o(es,{}),i===j.FavoriteIntake&&o(Ji,{}),d&&o(Gi,{}),i===j.Query&&o(Xi,{}),i===j.Water&&o(Zi,{})]})]})};const ns=()=>{const e=_n();return m("div",{className:"login-signup-msg","data-testid":"login-signup-msg",children:[o("div",{className:"login-signup-msg-text-container",children:o("h1",{children:"Start Your Journey Now!"})}),o("div",{className:"login-signup-msg-btn-container",children:[{title:"Log in",className:"btn-login",path:"/login"},{title:"Sign up",className:"btn-signup",path:"/signup"}].map(n=>o("button",{className:n.className,onClick:()=>{e(n.path)},children:n.title},n.title))})]})};function rs(){const e=$e(),{mutate:t,isLoading:n}=Me({mutationFn:wn.create,onSuccess:()=>{e.invalidateQueries(["today"])}});return{createDay:t,isLoading:n}}const hs=()=>{const{loggedInUser:e}=je(),{dailyData:t}=Mt(),{createDay:n,isLoading:r}=rs(),{backgroundColor:a}=st(),i=e&&!r,s=e&&t&&!as(t);Xn({title:"Home / Kceli"});function c(){const l=new Date().toDateString();n({date:l})}return m("main",{className:"home","data-testid":"home-page",children:[!e&&o(ns,{}),i&&o(la,{children:o(ts,{})}),r&&o(J,{}),s&&m(q,{children:[o(q.OpenBtn,{modalName:"create-day",children:o("button",{className:"home__btn","data-testid":"create-day-open-modal-btn",style:{backgroundColor:a},children:"start a new day"})}),m(q.Window,{name:"create-day",className:"create-day-modal",children:[m("h2",{className:"create-day-modal__title",children:["Are you sure you want to start a new day? ",o("br",{})]}),o(q.CloseBtn,{onClickFn:c,children:o("button",{className:"btn create-day-modal__btn","data-testid":"create-day-modal-btn",children:"start a new day"})}),o(q.CloseBtn,{children:o("button",{className:"btn create-day-modal__btn",children:"cancel"})})]})]})]})};function as(e){const t=new Date().toDateString(),n=new Date(e.date).toDateString();return t===n}export{hs as default};
