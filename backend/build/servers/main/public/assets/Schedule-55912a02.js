import{z as N,o as I,a as k,r as E,A as v,e as S,j as n,S as x,F as A,L,B as O}from"./index-a52bb271.js";import{c as f}from"./calorieUtilService-841f57aa.js";import{E as T}from"./ErrorMsg-cecaeed6.js";function b({startDate:r,endDate:a}){const{data:l,error:h,isLoading:y,isSuccess:m,isError:g}=N({queryKey:["days"],queryFn:()=>{const p={"date[gte]":r.toISOString(),"date[lte]":a.toISOString()};return I.query(p)}}),D=!!l&&l.length===0;return{days:l,error:h,isLoading:y,isSuccess:m,isError:g,isEmpty:D}}const j=()=>{const{loggedInUser:r}=k(t=>t.auth),[a,l]=E.useState(new Date),{allDays:h,startDate:y,endDate:m}=w(),{days:g,isLoading:D,isSuccess:p,isError:C}=b({startDate:y,endDate:m}),M=g?h.map(t=>{const e=g.find(d=>{const o=new Date(d.date);return o.getDate()===t.getDate()&&o.getMonth()===t.getMonth()}),s=f.getTotalCalories(e),i=e&&r?f.getBcgByCosumedCalories({consumedCalories:s,targetCalorie:r==null?void 0:r.targetCaloricIntakePerDay}):"";return{id:e==null?void 0:e.id,backgroundColor:i,date:t.toISOString().split("T")[0],day:t.getDate(),consumedCalories:s}}):[];function w(){const t=v(a.getMonth()+1,a.getFullYear()),e=Array.from({length:t-1},(_,u)=>new Date(a.getFullYear(),a.getMonth(),u+1)),s=e[0].getDay(),i=e[e.length-1].getDay(),d=Array.from({length:s},(_,u)=>new Date(a.getFullYear(),a.getMonth(),u-s+1)),o=Array.from({length:6-i},(_,u)=>new Date(a.getFullYear(),a.getMonth()+1,u+1)),c=[...d,...e,...o];return{allDays:c,startDate:c[0],endDate:c[c.length-1]}}function F(t){const{value:e}=t.target,s=new Date(e);l(s)}return S("section",{className:"schedule-grid-wrapper",children:[D&&n(x,{}),C&&n(T,{}),p&&S(A,{children:[n("input",{type:"date",className:"schedule-grid__date-input",name:"date",value:a.toISOString().split("T")[0],onChange:F}),n("ul",{className:"schedule-grid",children:M.map((t,e)=>{const{id:s,backgroundColor:i,date:d}=t,o=t.backgroundColor?"white":"",c=e<7;return n("li",{className:"schedule-grid__item",style:{backgroundColor:i,color:o},children:S(L,{to:`/day/${s}`,className:"schedule-grid__item__link",children:[c&&n("h3",{className:"schedule-grid__item__title",children:O[e].short}),n("h3",{className:"schedule-grid__item__title",children:t.day})]})},d)})})]})]})};const B=()=>n("main",{className:"schedule-page",children:n(j,{})});export{B as default};
