import{j as e,k as w,X as S,S as _,E as $,B as L,z as C,Y as P}from"./index-c64035b7.js";import{S as I,P as N,D as x}from"./StrictModeDroppable-f280bda9.js";import{W as U}from"./WorkoutPreview-dcf20535.js";import{E as y}from"./Empty-ac286b7c.js";import{E as R}from"./ErrorMsg-f30ad68c.js";const T=({workoutDay:r})=>e(I,{droppableId:r.name,direction:"vertical",children:(s,t)=>w("section",{className:"workout-day",style:{backgroundColor:t.draggingOverWith?"var(--color-success)":""},children:[e("h2",{className:"workout-day__name",children:r.name}),e("ul",{...s.droppableProps,ref:s.innerRef,className:"workout-day__list",children:r.workouts.map((c,i)=>{const u=`workday-${r.name}-workout-${c.id}`;return e(N,{draggableId:u,index:i,children:n=>e("li",{...n.draggableProps,...n.dragHandleProps,ref:n.innerRef,style:{...n.draggableProps.style},className:"workout-day__list__item",children:e("span",{children:c.description})})},c.id+i)})}),s.placeholder]})});const j=()=>{const{workoutSchedule:r}=S();return r?e("ul",{className:"workout-schedule","data-testid":"workout-schedule",children:r.map(s=>e("li",{children:e(T,{workoutDay:s})},s.name))}):null};const B=()=>{const{workouts:r,isLoading:s,isSuccess:t,isError:c,isEmpty:i}=S();return w("div",{className:"workout-list-container","data-testid":"workout-list",children:[s&&e(_,{}),t&&!i&&e(I,{droppableId:"workout-list",direction:"horizontal",children:u=>w("ul",{...u.droppableProps,ref:u.innerRef,className:"workout-list",children:[r.map((n,p)=>{const f=`workout-list-workout-${n.id}-index-${p}`;return e(N,{draggableId:f,index:p,children:d=>e("li",{...d.draggableProps,...d.dragHandleProps,ref:d.innerRef,style:{...d.draggableProps.style},className:"workout-list__item",children:e(U,{workout:n})})},n.id+p)}),u.placeholder]})}),t&&i&&e(y,{entityName:"workouts"}),c&&e(R,{msg:"Couldn't get workouts. Please try again later"})]})},O=()=>{const{createWorkout:r,isLoadingCreateWorkout:s,loggedInUser:t,workouts:c,setWorkoutSchedule:i}=S(),u=$();function n(){r(C.getDefaultWorkout())}function p(a){if(!a.destination)return;const{source:l}=a;switch(l.droppableId){case"workout-list":f(a);break;case"sun":case"mon":case"tue":case"wed":case"thu":case"fri":case"sat":d(a);break}}function f(a){if(!a.destination||!t||!c)return;const{source:l,destination:W}=a,{workoutSchedule:h}=t,m=h.map(o=>{if(o.name!==W.droppableId)return o;const k={...c[l.index]},g=[...o.workouts,k];return{...o,workouts:g}});i(m),u(P({...t,workoutSchedule:m}))}function d(a){if(!a.destination||!t||!c)return;const{source:l,destination:W}=a,{workoutSchedule:h}=t,m=h.map(o=>{if(o.name===W.droppableId){const k=h.find(E=>E.name===l.droppableId);if(!k)return o;const g={...k.workouts[l.index]},b=[...o.workouts,g];return{...o,workouts:b}}if(o.name===l.droppableId){const k=o.workouts.filter((g,b)=>b!==l.index);return{...o,workouts:k}}return o});i(m),u(P({...t,workoutSchedule:m}))}return e("main",{className:"page workout-page",children:w(x,{onDragEnd:p,children:[e(j,{}),e(L,{className:"btn workout-page__btn",onClickFn:n,children:"add new workout"}),s?e(_,{}):e(B,{})]})})};export{O as default};
