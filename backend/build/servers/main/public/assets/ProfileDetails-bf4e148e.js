import{h,i as u,v as b,o as E,p as N,w as I,r as $,j as e,S as f,f as r,O as F}from"./index-544b77a7.js";import{E as q}from"./ErrorMsg-9ff6c420.js";import{B as _}from"./Button-24c91202.js";const A="user";async function O(){const n=await h.get("user");return u(n)}async function P(n){const o=await h.get(`user/${n}`);return u(o)}async function Q(n){const o=await h.get(`user/username/${n}`);return u(o)}async function j(n){const o=await h.patch(`${A}/loggedInUser`,n);return u(o)}const w={query:O,getById:P,getByUsername:Q,update:j};function K(n){const{data:o,error:t,isLoading:s,isSuccess:l,isError:m}=b({queryKey:[`user/${n}`],queryFn:async()=>{if(!n)throw new Error("Username is required");return w.getByUsername(n)}});return{user:o,error:t,isLoading:s,isSuccess:l,isError:m}}function k(){const n=E(),{mutate:o,isLoading:t}=N({mutationFn:s=>w.update(s),onSuccess:s=>{n.setQueryData([`user/${s.id}`],s),n.invalidateQueries([`user/${s.username}`])}});return{updateUser:o,isLoading:t}}const J=()=>{const n=I(),{username:o}=n,{user:t,isLoading:s,isSuccess:l,isError:m}=K(o),[g,W]=$.useState(0),{updateUser:L,isLoading:G}=k();function M(i){const D=18.5*Math.pow(i,2),B=24.9*Math.pow(i,2);return{minRecommendedWeight:Number(D.toFixed(2)),maxRecommendedWeight:Number(B.toFixed(2))}}function x(){if(!t)return;const i=.075,a=(t==null?void 0:t.weight)-p;return Math.round(a/i)}function S(){if(!t)return;const i=.075;return Math.round(t.currentWeightLossGoal/i)}if(s)return e(f,{withContainer:!0,containerSize:{width:"100%"}});if(m)return e(q,{msg:"Something went wrong"});if(!l||!t)return null;function R(i){const{value:a}=i.target;W(Number(a))}function T(i){if(i.preventDefault(),!t||!g)return;const a={...t,currentWeightLossGoal:g};L(a)}const{minRecommendedWeight:v,maxRecommendedWeight:p}=M(t.height/100),C=7700,y=Math.round((t.weight-p)*C),c=x(),d=S();return r("main",{className:"profile-details",children:[r("div",{style:{alignSelf:"flex-start"},children:[e("p",{children:t.fullname}),e("p",{children:t.username}),e("p",{children:new Date(t.birthdate).toLocaleDateString()}),e("p",{children:t.weight}),e("p",{children:t.height}),e("p",{children:t.gender}),e("p",{children:t.currentWeightLossGoal})]}),r("div",{children:[e("h5",{children:"recommended weight"}),r("div",{children:[r("p",{children:["minRecommendedWeight: ",v]}),r("p",{children:["maxRecommendedWeight: ",p]})]})]}),r("div",{children:[e("h3",{children:"calories to lose"}),r("h4",{children:[y.toLocaleString()," Kcal"]})]}),r("div",{children:[e("h3",{children:"calories to lose as days"}),r("h4",{children:[(y/7700).toLocaleString()," "]}),e("h4",{children:"days you can maintain energy on body fat"})]}),c&&r("div",{children:[e("h3",{children:"days to get to max recommended weight"}),e("h4",{children:c}),e("h3",{children:"weeks to get to max recommended weight"}),e("h4",{children:Math.round(c/7)}),e("h3",{children:"months to get to max recommended weight"}),e("h4",{children:Math.round(c/30)})]}),d&&r("div",{children:[e("h3",{children:"days to get to Current Weight Loss Goal"}),e("h4",{children:d}),e("h3",{children:"weeks to get to Current Weight Loss Goal"}),e("h4",{children:Math.round(d/7)}),e("h3",{children:"months to get to Current Weight Loss Goal"}),e("h4",{children:Math.round(d/30)})]}),r("form",{onSubmit:T,children:[r("label",{htmlFor:"curr-goal",children:[e("h3",{children:"current weight loss goal"}),e("input",{type:"number",name:"curr-goal",id:"curr-goal",value:g,onChange:R})]}),e(_,{type:"submit",children:"Save"}),G&&e(f,{})]}),e(F,{})]})};export{J as default};
