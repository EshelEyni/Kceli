import{v as N,q as I,a as k,r as v,e as f,y as E,f as p,j as n,S as q,F as x,L,z as O}from"./index-544b77a7.js";import{E as T}from"./ErrorMsg-9ff6c420.js";function b({startDate:r,endDate:a}){const{data:l,error:h,isLoading:y,isSuccess:m,isError:g}=N({queryKey:["days"],queryFn:()=>{const S={"date[gte]":r.toISOString(),"date[lte]":a.toISOString()};return I.query(S)}}),D=!!l&&l.length===0;return{days:l,error:h,isLoading:y,isSuccess:m,isError:g,isEmpty:D}}const j=()=>{const{loggedInUser:r}=k(t=>t.auth),[a,l]=v.useState(new Date),{allDays:h,startDate:y,endDate:m}=w(),{days:g,isLoading:D,isSuccess:S,isError:C}=b({startDate:y,endDate:m}),M=g?h.map(t=>{const e=g.find(i=>{const o=new Date(i.date);return o.getDate()===t.getDate()&&o.getMonth()===t.getMonth()}),s=f.getTotalCalories(e),d=e&&r?f.getBcgByCosumedCalories({consumedCalories:s,targetCalorie:r==null?void 0:r.targetCaloricIntakePerDay}):"";return{id:e==null?void 0:e.id,backgroundColor:d,date:t.toISOString().split("T")[0],day:t.getDate(),consumedCalories:s}}):[];function w(){const t=E(a.getMonth()+1,a.getFullYear()),e=Array.from({length:t-1},(_,u)=>new Date(a.getFullYear(),a.getMonth(),u+1)),s=e[0].getDay(),d=e[e.length-1].getDay(),i=Array.from({length:s},(_,u)=>new Date(a.getFullYear(),a.getMonth(),u-s+1)),o=Array.from({length:6-d},(_,u)=>new Date(a.getFullYear(),a.getMonth()+1,u+1)),c=[...i,...e,...o];return{allDays:c,startDate:c[0],endDate:c[c.length-1]}}function F(t){const{value:e}=t.target,s=new Date(e);l(s)}return p("section",{className:"schedule-grid-wrapper",children:[D&&n(q,{}),C&&n(T,{}),S&&p(x,{children:[n("input",{type:"date",className:"schedule-grid__date-input",name:"date",value:a.toISOString().split("T")[0],onChange:F}),n("ul",{className:"schedule-grid",children:M.map((t,e)=>{const{id:s,backgroundColor:d,date:i}=t,o=t.backgroundColor?"white":"",c=e<7;return n("li",{className:"schedule-grid__item",style:{backgroundColor:d,color:o},children:p(L,{to:`/day/${s}`,className:"schedule-grid__item__link",children:[c&&n("h3",{className:"schedule-grid__item__title",children:O[e].short}),n("h3",{className:"schedule-grid__item__title",children:t.day})]})},i)})})]})]})};const Y=()=>n("main",{className:"schedule-page",children:n(j,{})});export{Y as default};
