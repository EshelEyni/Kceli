import{d as N,r as I,t as k,h as S,j as n,i as v,F as E,L as x,v as L}from"./index-92c92b48.js";import{a as O,d as T,c as C,E as b}from"./calorieUtilService-c1f04f09.js";function j({startDate:r,endDate:a}){const{data:l,error:h,isLoading:y,isSuccess:m,isError:g}=O({queryKey:["days"],queryFn:()=>{const p={"date[gte]":r.toISOString(),"date[lte]":a.toISOString()};return T.query(p)}}),D=!!l&&l.length===0;return{days:l,error:h,isLoading:y,isSuccess:m,isError:g,isEmpty:D}}const q=()=>{const{loggedInUser:r}=N(t=>t.auth),[a,l]=I.useState(new Date),{allDays:h,startDate:y,endDate:m}=w(),{days:g,isLoading:D,isSuccess:p,isError:M}=j({startDate:y,endDate:m}),f=g?h.map(t=>{const e=g.find(i=>{const o=new Date(i.date);return o.getDate()===t.getDate()&&o.getMonth()===t.getMonth()}),s=C.getTotalCalories(e),d=e&&r?C.getBcgByCosumedCalories({consumedCalories:s,targetCalorie:r==null?void 0:r.targetCaloricIntakePerDay}):"";return{id:e==null?void 0:e.id,backgroundColor:d,date:t.toISOString().split("T")[0],day:t.getDate(),consumedCalories:s}}):[];function w(){const t=k(a.getMonth()+1,a.getFullYear()),e=Array.from({length:t-1},(_,u)=>new Date(a.getFullYear(),a.getMonth(),u+1)),s=e[0].getDay(),d=e[e.length-1].getDay(),i=Array.from({length:s},(_,u)=>new Date(a.getFullYear(),a.getMonth(),u-s+1)),o=Array.from({length:6-d},(_,u)=>new Date(a.getFullYear(),a.getMonth()+1,u+1)),c=[...i,...e,...o];return{allDays:c,startDate:c[0],endDate:c[c.length-1]}}function F(t){const{value:e}=t.target,s=new Date(e);l(s)}return S("section",{className:"schedule-grid-wrapper",children:[D&&n(v,{}),M&&n(b,{}),p&&S(E,{children:[n("input",{type:"date",className:"schedule-grid__date-input",name:"date",value:a.toISOString().split("T")[0],onChange:F}),n("ul",{className:"schedule-grid",children:f.map((t,e)=>{const{id:s,backgroundColor:d,date:i}=t,o=t.backgroundColor?"white":"",c=e<7;return n("li",{className:"schedule-grid__item",style:{backgroundColor:d,color:o},children:S(x,{to:`/day/${s}`,className:"schedule-grid__item__link",children:[c&&n("h3",{className:"schedule-grid__item__title",children:L[e].short}),n("h3",{className:"schedule-grid__item__title",children:t.day})]})},i)})})]})]})};const Y=()=>n("main",{className:"schedule-page",children:n(q,{})});export{Y as default};
