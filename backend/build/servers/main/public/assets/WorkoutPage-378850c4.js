import{j as e,k as w,X as S,S as _,E as $,B as L,z as C,Y as P}from"./index-e343533d.js";import{S as I,P as N,E as x,D as U}from"./Empty-377cd65e.js";import{W as y}from"./WorkoutPreview-83a262b5.js";import{E as R}from"./ErrorMsg-f69fa615.js";const T=({workoutDay:r})=>e(I,{droppableId:r.name,direction:"vertical",children:(s,t)=>w("section",{className:"workout-day",style:{backgroundColor:t.draggingOverWith?"var(--color-success)":""},children:[e("h2",{className:"workout-day__name",children:r.name}),e("ul",{...s.droppableProps,ref:s.innerRef,className:"workout-day__list",children:r.workouts.map((c,u)=>{const i=`workday-${r.name}-workout-${c.id}`;return e(N,{draggableId:i,index:u,children:n=>e("li",{...n.draggableProps,...n.dragHandleProps,ref:n.innerRef,style:{...n.draggableProps.style},className:"workout-day__list__item",children:e("span",{children:c.description})})},c.id+u)})}),s.placeholder]})});const j=()=>{const{workoutSchedule:r}=S();return r?e("ul",{className:"workout-schedule","data-testid":"workout-schedule",children:r.map(s=>e("li",{children:e(T,{workoutDay:s})},s.name))}):null};const B=()=>{const{workouts:r,isLoading:s,isSuccess:t,isError:c,isEmpty:u}=S();return w("div",{className:"workout-list-container","data-testid":"workout-list",children:[s&&e(_,{}),t&&!u&&e(I,{droppableId:"workout-list",direction:"horizontal",children:i=>w("ul",{...i.droppableProps,ref:i.innerRef,className:"workout-list",children:[r.map((n,p)=>{const f=`workout-list-workout-${n.id}-index-${p}`;return e(N,{draggableId:f,index:p,children:d=>e("li",{...d.draggableProps,...d.dragHandleProps,ref:d.innerRef,style:{...d.draggableProps.style},className:"workout-list__item",children:e(y,{workout:n})})},n.id+p)}),i.placeholder]})}),t&&u&&e(x,{entityName:"workouts"}),c&&e(R,{msg:"Couldn't get workouts. Please try again later"})]})},M=()=>{const{createWorkout:r,isLoadingCreateWorkout:s,loggedInUser:t,workouts:c,setWorkoutSchedule:u}=S(),i=$();function n(){r(C.getDefaultWorkout())}function p(a){if(!a.destination)return;const{source:l}=a;switch(l.droppableId){case"workout-list":f(a);break;case"sun":case"mon":case"tue":case"wed":case"thu":case"fri":case"sat":d(a);break}}function f(a){if(!a.destination||!t||!c)return;const{source:l,destination:W}=a,{workoutSchedule:m}=t,h=m.map(o=>{if(o.name!==W.droppableId)return o;const k={...c[l.index]},g=[...o.workouts,k];return{...o,workouts:g}});u(h),i(P({...t,workoutSchedule:h}))}function d(a){if(!a.destination||!t||!c)return;const{source:l,destination:W}=a,{workoutSchedule:m}=t,h=m.map(o=>{if(o.name===W.droppableId){const k=m.find(E=>E.name===l.droppableId);if(!k)return o;const g={...k.workouts[l.index]},b=[...o.workouts,g];return{...o,workouts:b}}if(o.name===l.droppableId){const k=o.workouts.filter((g,b)=>b!==l.index);return{...o,workouts:k}}return o});u(h),i(P({...t,workoutSchedule:h}))}return e("main",{className:"page workout-page",children:w(U,{onDragEnd:p,children:[e(j,{}),e(L,{className:"btn workout-page__btn",onClickFn:n,children:"add new workout"}),s?e(_,{}):e(B,{})]})})};export{M as default};
