import{Q as w,u as _,j as e,m as f,R as P,F as x,S as C,B as R,T as U,c as I}from"./index-6361fabc.js";import{S as N,P as E,E as F,D as T}from"./Empty-84c08648.js";import{b as B,W as $}from"./index.esm-3b1dee0e.js";import{E as j}from"./ErrorMsg-756bffa0.js";const z=({workoutDay:a})=>{const{loggedInUser:c,workouts:n}=w(),p=_();function k(t){if(!c||!n)return;const{workoutSchedule:i}=c,d=i.map(o=>{if(o.name!==o.name)return o;const l=o.workouts.filter(s=>s.id!==t);return{...o,workouts:l}});p(P({...c,workoutSchedule:d}))}return e(N,{droppableId:a.name,direction:"vertical",children:(t,i)=>f("section",{className:"workout-day",style:{backgroundColor:i.draggingOverWith?"var(--color-success)":""},children:[e("h2",{className:"workout-day__name",children:a.name}),e("ul",{...t.droppableProps,ref:t.innerRef,className:"workout-day__list",children:a.workouts.map((d,o)=>e(E,{draggableId:d.id,index:o,children:l=>f("li",{...l.draggableProps,...l.dragHandleProps,ref:l.innerRef,style:{...l.draggableProps.style},className:"workout-day__list__item",children:[e("span",{children:d.description}),e(B,{size:18,onClick:()=>k(d.id)})]})},d.id))}),t.placeholder]})})};const A=()=>{const{workoutSchedule:a}=w();return a?e("ul",{className:"workout-schedule",children:a.map(c=>e("li",{children:e(z,{workoutDay:c})},c.name))}):null};const H=()=>{const{workouts:a,isLoading:c,isSuccess:n,isError:p,isEmpty:k}=w();return f(x,{children:[c&&e(C,{}),n&&!k&&e(N,{droppableId:"workout-list",direction:"horizontal",children:t=>f("ul",{...t.droppableProps,ref:t.innerRef,className:"workout-list",children:[a.map((i,d)=>e(E,{draggableId:i.id,index:d,children:o=>e("li",{...o.draggableProps,...o.dragHandleProps,ref:o.innerRef,style:{...o.draggableProps.style},className:"workout-list__item",children:e($,{workout:i},i.id)})},i.id)),t.placeholder]})}),n&&k&&e(F,{entityName:"workouts"}),p&&e(j,{msg:"Couldn't get workouts. Please try again later"})]})},y=()=>{const{createWorkout:a,isLoadingCreateWorkout:c,loggedInUser:n,workouts:p,setWorkoutSchedule:k}=w(),t=_();function i(){a(U.getDefaultWorkout())}function d(s){if(!s.destination)return;const{source:u}=s;switch(u.droppableId){case"workout-list":o(s);break;case"sun":case"mon":case"tue":case"wed":case"thu":case"fri":case"sat":l(s);break}}function o(s){if(!s.destination||!n||!p)return;const{source:u,destination:b}=s,{workoutSchedule:W}=n,m=W.map(r=>{if(r.name!==b.droppableId)return r;const h={...p[u.index]};h.id=I();const g=[...r.workouts,h];return{...r,workouts:g}});k(m),t(P({...n,workoutSchedule:m}))}function l(s){if(!s.destination||!n||!p)return;const{source:u,destination:b}=s,{workoutSchedule:W}=n,m=W.map(r=>{if(r.name===b.droppableId){const h=W.find(L=>L.name===u.droppableId);if(!h)return r;const g={...h.workouts[u.index]};g.id=I();const S=[...r.workouts,g];return{...r,workouts:S}}if(r.name===u.droppableId){const h=r.workouts.filter((g,S)=>S!==u.index);return{...r,workouts:h}}return r});k(m),t(P({...n,workoutSchedule:m}))}return e("main",{className:"page workout-page",children:f(T,{onDragEnd:d,children:[e(A,{}),e(R,{className:"btn workout-page__btn",onClickFn:i,children:"add new workout"}),c?e(C,{}):e(H,{})]})})};export{y as default};
