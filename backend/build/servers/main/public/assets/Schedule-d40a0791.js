import{j as e,k as a,C as P,z as I,K as b,r as D,L as R,f as g,M as $,N as U,b as Y,G as z,P as E,Q as f,B as M,T as V,U as S,S as q,F as Q}from"./index-e343533d.js";import{E as J}from"./ErrorMsg-f69fa615.js";import{X as A,Y as L,R as K,C as H,W as Z}from"./WeightWaistChart-1ae5e60a.js";import{B as ee,H as F,I as te,F as O,v as re,c as X}from"./generateCategoricalChart-0c0af967.js";import{L as B}from"./List-824e66f2.js";import{i as ae,u as ne}from"./intakeUtilService-43f48868.js";import{F as se,a as ie}from"./index.esm-149ccb6c.js";var j=ee({chartName:"BarChart",GraphicalChild:F,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:A},{axisType:"yAxis",AxisComp:L}],formatAxisMap:te});const oe=({data:n})=>{const o=n.reduce((l,i)=>i.calories>l?i.calories:l,-1/0),t=[0,Math.round(o*1.1)];return e("div",{style:{width:"100%",maxWidth:1200,height:300},children:e(K,{children:a(j,{data:n,children:[e(H,{strokeDasharray:"3 3"}),e(A,{dataKey:"name"}),e(L,{domain:t}),e(O,{}),e(F,{dataKey:"calories",barSize:25,children:n.map((l,i)=>e(re,{fill:P[i%P.length]},`cell-${i}`))})]})})})};function le(n){if(!n||n.intakes.length===0)return"No data";let o=0,t=0,l;for(const c of n.intakes){if(!c.recordedAt||c.type!=="food")continue;const s=new Date(c.recordedAt).getTime();l!==void 0&&(o+=s-l,t++),l=s}if(t===0)return"No data";const r=o/t/1e3/60/60;return r>=1?`${Math.round(r)} hours`:`${Math.round(r*60)} minutes`}const ce={calcAverageTimeBetweenMeals:le};const de=({workout:n,isTableShown:o=!0})=>{const{description:t,type:l,items:i}=n,r=I.calcWorkoutDuration({workout:n})+" min",c=Math.round(i.filter(s=>s.isCompleted).length/i.length*100);return a("article",{className:"day-report__workout-preview",children:[e(b,{className:"day-report__workout-preview__header",children:a("h3",{children:[t," - ",l," - ",r," - ",c,"% completed"]})}),o&&a("table",{className:"day-report__workout-preview__table",children:[e("thead",{className:"day-report__workout-preview__table__header",children:a("tr",{children:[e("th",{children:"Exercise"}),e("th",{children:"Duration"}),e("th",{children:"Reps"}),e("th",{children:"Sets"}),e("th",{children:"Weight"}),e("th",{className:"day-report__workout-preview__table__header__completed",children:"Completed"})]})}),e("tbody",{className:"day-report__workout-preview__table__body",children:i.map((s,h)=>{const d=I.calcItemDuration(s)+" min";return s.type==="superset"?a(D.Fragment,{children:[a("tr",{children:[e("td",{children:s.name}),e("td",{children:d}),e("td",{}),e("td",{children:s.sets}),e("td",{}),e("td",{className:"completed",children:s.isCompleted?e(R,{}):""})]}),s.items.map((m,y)=>a("tr",{children:[e("td",{children:m.name}),e("td",{}),e("td",{children:m.reps}),e("td",{}),a("td",{children:[m.weight," ",m.weightUnit]}),e("td",{className:"completed"})]},`superset-${h}-subitem-${y}`))]},`superset-${h}`):s.type==="anaerobic"?a("tr",{children:[e("td",{children:s.name}),e("td",{children:d}),e("td",{children:s.reps}),e("td",{children:s.sets}),a("td",{children:[s.weight," ",s.weightUnit]}),e("td",{className:"completed",children:s.isCompleted?e(R,{}):""})]},h):a("tr",{children:[e("td",{children:s.name}),e("td",{children:d}),e("td",{}),e("td",{}),e("td",{}),e("td",{className:"completed",children:s.isCompleted?e(R,{}):""})]},h)})})]})]})};const G=({intake:n})=>{const[o,t]=D.useState(!1),l=n.name||n.items.map(s=>s.name).join(", "),i=g.getTotalCalories(n),r=n.recordedAt?new Date(n.recordedAt).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"}):"";function c(){t(!o)}return a("article",{className:"day-report__intake-preview",children:[a(b,{className:"day-report__intake-preview__header",onClickFn:c,children:[a("h3",{className:"day-report__intake-preview__header__title",children:[l," - ",i," kcal - ",r]}),e("div",{children:o?e($,{}):e(U,{})})]}),o&&a("table",{className:"day-report__intake-preview__table",children:[e("thead",{className:"day-report__intake-preview__table__head",children:a("tr",{children:[e("th",{children:"Item"}),e("th",{children:"Calories"}),e("th",{children:"Weight"})]})}),e("tbody",{className:"day-report__intake-preview__table__body",children:n.items.map(s=>a("tr",{children:[e("td",{children:s.name}),e("td",{children:s.calories}),a("td",{children:[s.quantity," ",s.unit]})]},s.id))})]})]})},he=({day:n})=>{const{loggedInUser:o}=Y(),{data:t,backgroundColor:l}=n;if(!t)return e("section",{className:"report day-report empty",children:e("p",{children:"No data for this day"})});const i=g.getTotalCalories(t),r=g.calcRemainingCalories(o,t),s=` calories ${r>0?"remaining":"over your limit"}`,h=new Intl.DateTimeFormat("en-US",{dateStyle:"full"}).format(n.date),d=ce.calcAverageTimeBetweenMeals(t),m=ue(t);return a("section",{className:"report day-report",children:[a(b,{className:"day-report__header",children:[e("h1",{children:h}),e("div",{className:"day-report__header__color-circle",style:{backgroundColor:l}})]}),a("div",{className:"day-report__weight",children:[t.weight&&a("p",{children:[e("strong",{children:"Weight: "}),t.weight]}),t.waist&&a("p",{children:[e("strong",{children:"Waist: "}),t.waist]})]}),a("div",{className:"day-report__calories",children:[e("h3",{className:"day-report__calories__title",children:"calories"}),a("p",{children:[e("strong",{children:"consumed Calories: "}),i]}),a("p",{children:[a("strong",{children:[s,": "]}),Math.abs(r)]}),a("p",{children:[e("strong",{children:"target caloric intake: "}),n.targetCalorie]})]}),t.intakes.length>0&&a("div",{className:"day-report__intakes",children:[e("h2",{className:"day-report__intakes__title",children:"Intakes"}),a("h4",{children:["Number of Intakes: ",t.intakes.length]}),a("h4",{children:["Average time between meals: ",d]}),e(B,{className:"day-report__intakes__list",items:t.intakes,render:y=>e(G,{intake:y},y.id)}),e(oe,{data:m})]}),t.workouts.length>0&&a("div",{className:"day-report__workouts",children:[e("h1",{className:"day-report__workouts__title",children:"Workouts"}),e("ul",{children:t.workouts.map((y,C)=>e("li",{children:e(de,{workout:y})},C))})]})]})};function ue(n){return ae.sortIntakesByRecordedAt(n.intakes).map(l=>({name:l.items.reduce((i,r,c,s)=>s.length===1?r.name:c===0?i+`${r.name}, `:c===s.length-1?i+`and ${r.name}`:i+` ${r.name}, `,""),calories:l.items.reduce((i,r)=>i+r.calories,0)}))}function me(n){return z({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.13 48 48 141.13 48 256s93.13 208 208 208 208-93.13 208-208S370.87 48 256 48zm62.63 304L296 374.63 177.37 256 296 137.37 318.63 160l-96 96z"}}]})(n)}function pe(n){return z({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 48C141.13 48 48 141.13 48 256s93.13 208 208 208 208-93.13 208-208S370.87 48 256 48zm-40 326.63L193.37 352l96-96-96-96L216 137.37 334.63 256z"}}]})(n)}const ye=({days:n})=>e("section",{className:"days-report",children:n.map(o=>e("div",{className:"day-report",children:e("h3",{className:"day-report__date",children:o.date.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})})},o.date.toISOString()))});const ke=()=>{const{isSuccess:n,filterBy:o,setFilterBy:t,currDay:l,setCurrDays:i,getWeekDays:r,getMonthDays:c}=E();function s(h){if(n){switch(h){case f.Day:i([]);break;case f.Week:{if(!l)return;const d=r(l);if(!d)return;i(d);break}case f.Month:{if(!l)return;const d=c(l);if(!d)return;i(d);break}}t(h)}}return e("section",{className:"schedule-filter",children:Object.values(f).map(h=>e(M,{onClickFn:()=>s(h),className:X("schedule-filter__btn",{active:o===h}),children:e("span",{children:h})},h))})};const ge=()=>{const{currDate:n,currDay:o,setCurrDay:t,currDays:l,setCurrDays:i,filterBy:r,calenderDays:c,isSuccess:s,moveToMonth:h,getWeekDays:d,getMonthDays:m}=E(),[y,C]=D.useState(!1),k=D.useRef(null),w=D.useRef(0);function T(u){switch(r){case f.Day:{if(!y){t(u),i([]);return}if(!o)return;const p=[],_=c.findIndex(v=>S(v.date,o==null?void 0:o.date)),W=c.findIndex(v=>S(v.date,u.date)),x=Math.min(_,W),N=Math.max(_,W);for(let v=x;v<=N;v++)p.push(c[v]);i(p),t(u);break}case f.Week:{const p=d(u);if(!p)return;i(p),t(u);break}case f.Month:{const p=m(u);if(!p)return;i(p),t(u);break}}}return D.useEffect(()=>{const u=W=>{const x=W.touches[0];w.current=x.clientX},p=W=>{const N=W.changedTouches[0].clientX,v=50;N-w.current>v&&h(-1),w.current-N>v&&h(1)},_=k.current;if(_)return _.addEventListener("touchstart",u,!1),_.addEventListener("touchend",p,!1),()=>{_&&(_.removeEventListener("touchstart",u),_.removeEventListener("touchend",p))}},[n,s,h]),D.useEffect(()=>{const u=_=>{_.key==="Shift"&&C(!0)},p=_=>{_.key==="Shift"&&C(!1)};return window.addEventListener("keydown",u),window.addEventListener("keyup",p),()=>{window.removeEventListener("keydown",u),window.removeEventListener("keyup",p)}},[]),a("ul",{className:"calender",ref:k,children:[V.map(u=>e("li",{className:"calender__item weekday-item",children:e("h3",{className:"calender__item__title",children:u.short})},u.short)),c.map(u=>{const{backgroundColor:p,date:_}=u,W=u.backgroundColor?"white":"",x=u.isBorder?"4px solid var(--color-success)":"none";return e("li",{className:X("calender__item",{active:o&&S(u.date,o.date)||l.some(N=>S(u.date,N.date))}),onClick:()=>T(u),style:{backgroundColor:p,color:W},children:e("div",{className:"calender__item__wrapper",style:{border:x},children:e("h3",{children:u.day})})},_.toISOString())})]})};const _e=({currWeekData:n,prevWeekData:o})=>{const t=l();function l(){const r={documentedDay:{currWeek:0,prevWeek:0,trend:0},totalCalories:{currWeek:0,prevWeek:0,trend:0},averageCaloriesPerDay:{currWeek:0,prevWeek:0,trend:0},totalWorkouts:{currWeek:0,prevWeek:0,trend:0},excessCalories:{currWeek:0,prevWeek:0,trend:0},exceededDays:{currWeek:0,prevWeek:0,trend:0}};if(!(!n.length||!(o!=null&&o.length)))return r.documentedDay.currWeek=n.length,r.documentedDay.prevWeek=o.length,r.documentedDay.trend=r.documentedDay.currWeek-r.documentedDay.prevWeek,r.totalCalories.currWeek=g.getTotalCalories(n),r.totalCalories.prevWeek=g.getTotalCalories(o),r.totalCalories.trend=r.totalCalories.currWeek-r.totalCalories.prevWeek,r.averageCaloriesPerDay.currWeek=Math.round(r.totalCalories.currWeek/n.length),r.averageCaloriesPerDay.prevWeek=Math.round(r.totalCalories.prevWeek/o.length),r.averageCaloriesPerDay.trend=r.averageCaloriesPerDay.currWeek-r.averageCaloriesPerDay.prevWeek,r.totalWorkouts.currWeek=I.getTotalWorkouts(n),r.totalWorkouts.prevWeek=I.getTotalWorkouts(o),r.totalWorkouts.trend=r.totalWorkouts.currWeek-r.totalWorkouts.prevWeek,r.excessCalories.currWeek=g.getWeeklyExcessRateCalories(n),r.excessCalories.prevWeek=g.getWeeklyExcessRateCalories(o),r.excessCalories.trend=r.excessCalories.currWeek-r.excessCalories.prevWeek,r.exceededDays.currWeek=n.filter(c=>{const s=g.getDayCaloriesIntake({currDayData:c,data:n}),h=g.getTotalCaloriesFromDailyData({dailyData:c});return s-h<0}).length,r.exceededDays.prevWeek=o.filter(c=>{const s=g.getDayCaloriesIntake({currDayData:c,data:o}),h=g.getTotalCaloriesFromDailyData({dailyData:c});return s-h<0}).length,r.exceededDays.trend=r.exceededDays.currWeek-r.exceededDays.prevWeek,r}function i({trend:r,positive:c}){if(!r)return;const s=20;return r>0?e(se,{size:s,color:c==="up"?"green":"red"}):e(ie,{size:s,color:c==="down"?"green":"red"})}return t?e("div",{className:"week-report-table",children:a("table",{children:[e("thead",{children:a("tr",{children:[e("th",{children:"value"}),e("th",{children:"current week"}),e("th",{children:"previous week"}),e("th",{children:"trend"})]})}),a("tbody",{children:[a("tr",{children:[e("td",{children:"documented days"}),e("td",{children:t.documentedDay.currWeek}),e("td",{children:t.documentedDay.prevWeek}),e("td",{children:i({trend:t.documentedDay.trend,positive:"up"})})]}),a("tr",{children:[e("td",{children:"total calories"}),e("td",{children:t.totalCalories.currWeek}),e("td",{children:t.totalCalories.prevWeek}),e("td",{children:i({trend:t.totalCalories.trend,positive:"down"})})]}),a("tr",{children:[e("td",{children:"average calories per day"}),e("td",{children:t.averageCaloriesPerDay.currWeek}),e("td",{children:t.averageCaloriesPerDay.prevWeek}),e("td",{children:i({trend:t.averageCaloriesPerDay.trend,positive:"down"})})]}),a("tr",{children:[e("td",{children:"total workouts"}),e("td",{children:t.totalWorkouts.currWeek}),e("td",{children:t.totalWorkouts.prevWeek}),e("td",{children:i({trend:t.totalWorkouts.trend,positive:"up"})})]}),a("tr",{children:[e("td",{children:"excess calories"}),e("td",{children:t.excessCalories.currWeek}),e("td",{children:t.excessCalories.prevWeek}),e("td",{children:i({trend:t.excessCalories.trend,positive:"down"})})]}),a("tr",{children:[e("td",{children:"exceeded days"}),e("td",{children:t.exceededDays.currWeek}),e("td",{children:t.exceededDays.prevWeek}),e("td",{children:i({trend:t.exceededDays.trend,positive:"down"})})]})]})]})}):null};const Ce=({calenderDay:n})=>{const{backgroundColor:o,data:t,date:l}=n,[i,r]=D.useState(!1);if(!t)return null;const c=new Date(l).toLocaleDateString("en-US",{weekday:"short"}),s=g.getTotalCalories(t),h=g.calcRemainingCaloriesFromDayData(t),d=h>0?"remaining":"over your limit",m=g.getDailyExcessRate({remainingCalories:h,targetCaloricIntake:t.targetCaloricIntake}),y=` calories ${d}`,C=t.intakes.length;return a("article",{className:"week-report-day-display",children:[e(b,{className:"week-report-day-display__header",style:{backgroundColor:o},children:e("h3",{children:c})}),a("div",{className:"week-report-day-display__wrapper",children:[e("div",{className:"week-report-day-display__calories",children:e("table",{children:a("tbody",{children:[a("tr",{children:[e("th",{children:"Consumed Calories"}),e("td",{children:s})]}),a("tr",{children:[e("th",{children:y}),e("td",{children:Math.abs(h)})]}),a("tr",{children:[e("th",{children:"Target Caloric Intake"}),e("td",{children:t.targetCaloricIntake})]}),a("tr",{children:[e("th",{children:"Exceeded By"}),a("td",{children:[m,"%"]})]}),a("tr",{children:[e("th",{children:"workouts"}),e("td",{children:t.workouts.length})]})]})})}),a(M,{className:"week-report-day-display__show-intakes-btn",onClickFn:()=>r(!i),children:[a("span",{children:[C," Intakes"]}),i?e($,{}):e(U,{})]}),i&&e(B,{className:"week-report-day-display__intakes-list",items:t.intakes,render:k=>e(G,{intake:k},k.id)}),t.workouts.length>0&&a("div",{className:"week-report-day-display__workouts",children:[e("h3",{children:"Workouts:"}),e(B,{className:"week-report-day-display__workouts__list",items:t.workouts,render:k=>{const{items:w,description:T}=k,u=Math.round(w.filter(p=>p.isCompleted).length/w.length*100);return a("p",{children:[e("strong",{children:T})," (",u,"% completed)"]})}})]})]})]})};const we=({data:n})=>{const o=n.reduce((l,i)=>i.calories>l?i.calories:l,-1/0),t=[0,Math.round(o*1.1)];return e("div",{style:{width:"100%",maxWidth:1200,height:300},children:e(K,{width:"100%",height:"100%",children:a(j,{data:n,children:[e(H,{strokeDasharray:"3 3"}),e(A,{dataKey:"name"}),e(L,{domain:t}),e(O,{}),e(F,{dataKey:"caloriesWithoutExcess",stackId:"a",fill:"#005FB3",barSize:50}),e(F,{dataKey:"excessCalories",stackId:"a",fill:"#FF0000",barSize:50})]})})})},ve=()=>{const{currDays:n,data:o}=E();if(!n.length||!o)return e("section",{className:"report week-report",children:e("p",{children:"No data for this week"})});const t=n.map(d=>d.data).filter(d=>!!d),l=h(),i=c(),r=s();function c(){return t?t.map(m=>({date:m.date,weight:m.weight,waist:m.waist})):null}function s(){return t?t.map(m=>{const y=g.calcRemainingCaloriesFromDayData(m),C=y<0?Math.abs(y):0,k=g.getTotalCalories(m),w=k-C;return{name:new Intl.DateTimeFormat("en-US",{weekday:"short"}).format(new Date(m.date)),calories:k,excessCalories:C,caloriesWithoutExcess:w}}):null}function h(){if(!n.length||!o)return[];const d=n[0],m=new Date(d.date);return m.setDate(m.getDate()-7),m.setHours(0,0,0,0),o.filter(C=>{const k=new Date(C.date);return k>=m&&k<d.date})}return a("div",{className:"report week-report",children:[e("div",{className:"week-report-day-display-container",children:n.map(d=>e(Ce,{calenderDay:d},d.id))}),i&&e(Z,{data:i}),r&&e(we,{data:r}),e(_e,{currWeekData:t,prevWeekData:l})]})},Te=()=>{ne({title:"Schedule / Kceli"});const{currDate:n,currDay:o,setCurrDay:t,currDays:l,filterBy:i,calenderDays:r,isLoading:c,isSuccess:s,isError:h,moveToMonth:d}=E(),m=!!o&&i===f.Day,y=l.length>0&&i===f.Day;return D.useEffect(()=>{if(!s||o)return;const C=new Date,k=r.find(w=>S(w.date,C));k&&t(k)},[r,s,o,l,t]),a("main",{className:"page schedule-page",children:[c&&e(q,{}),h&&e(J,{}),s&&a(Q,{children:[a(b,{className:"schedule-page__header",children:[a("h2",{className:"schedule-page__header__title",children:[n.toLocaleString("en-US",{month:"long"})," ",n.getFullYear()]}),a("div",{className:"schedule-page__header__btns-container",children:[e(M,{onClickFn:()=>d(-1),children:e(me,{className:"schedule-page__header__btns-container__btn__icon"})}),e(M,{onClickFn:()=>d(1),children:e(pe,{className:"schedule-page__header__btns-container__btn__icon"})})]})]}),e(ge,{}),e(ke,{}),m&&e(he,{day:o}),y&&e(ye,{days:l}),i===f.Week&&e(ve,{})]})]})};export{Te as default};
